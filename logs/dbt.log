[0m20:13:32.834492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f16fd7b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f16e20a470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f16e20a440>]}


============================== 20:13:32.837383 | 403d09e4-9085-41ae-b501-e7784c89d6b7 ==============================
[0m20:13:32.837383 [info ] [MainThread]: Running with dbt=1.7.10
[0m20:13:32.837848 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'True'}
[0m20:13:32.838246 [info ] [MainThread]: dbt version: 1.7.10
[0m20:13:32.838518 [info ] [MainThread]: python version: 3.10.12
[0m20:13:32.838796 [info ] [MainThread]: python path: /home/kishanmahajan/Desktop/course/venv/bin/python
[0m20:13:32.839048 [info ] [MainThread]: os info: Linux-6.5.0-25-generic-x86_64-with-glibc2.35
[0m20:13:33.093776 [info ] [MainThread]: Using profiles dir at /home/kishanmahajan/.dbt
[0m20:13:33.094273 [info ] [MainThread]: Using profiles.yml file at /home/kishanmahajan/.dbt/profiles.yml
[0m20:13:33.094633 [info ] [MainThread]: Using dbt_project.yml file at /home/kishanmahajan/Desktop/course/dbtlearnnew/dbt_project.yml
[0m20:13:33.095195 [info ] [MainThread]: adapter type: snowflake
[0m20:13:33.095518 [info ] [MainThread]: adapter version: 1.7.1
[0m20:13:33.162124 [info ] [MainThread]: Configuration:
[0m20:13:33.162635 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m20:13:33.163023 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m20:13:33.163349 [info ] [MainThread]: Required dependencies:
[0m20:13:33.163670 [debug] [MainThread]: Executing "git --help"
[0m20:13:33.191662 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m20:13:33.192410 [debug] [MainThread]: STDERR: "b''"
[0m20:13:33.193017 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m20:13:33.193349 [info ] [MainThread]: Connection:
[0m20:13:33.193694 [info ] [MainThread]:   account: opofypc-ca62067
[0m20:13:33.193972 [info ] [MainThread]:   user: dbt
[0m20:13:33.194234 [info ] [MainThread]:   database: AIRBNB
[0m20:13:33.194490 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m20:13:33.194741 [info ] [MainThread]:   role: transform
[0m20:13:33.194989 [info ] [MainThread]:   schema: DEV
[0m20:13:33.195234 [info ] [MainThread]:   authenticator: None
[0m20:13:33.195492 [info ] [MainThread]:   private_key_path: None
[0m20:13:33.195743 [info ] [MainThread]:   token: None
[0m20:13:33.196020 [info ] [MainThread]:   oauth_client_id: None
[0m20:13:33.197001 [info ] [MainThread]:   query_tag: None
[0m20:13:33.197377 [info ] [MainThread]:   client_session_keep_alive: False
[0m20:13:33.197668 [info ] [MainThread]:   host: None
[0m20:13:33.197929 [info ] [MainThread]:   port: None
[0m20:13:33.198177 [info ] [MainThread]:   proxy_host: None
[0m20:13:33.198421 [info ] [MainThread]:   proxy_port: None
[0m20:13:33.198665 [info ] [MainThread]:   protocol: None
[0m20:13:33.198908 [info ] [MainThread]:   connect_retries: 1
[0m20:13:33.199150 [info ] [MainThread]:   connect_timeout: None
[0m20:13:33.199399 [info ] [MainThread]:   retry_on_database_errors: False
[0m20:13:33.199883 [info ] [MainThread]:   retry_all: False
[0m20:13:33.200143 [info ] [MainThread]:   insecure_mode: False
[0m20:13:33.200390 [info ] [MainThread]:   reuse_connections: None
[0m20:13:33.200714 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m20:13:33.201212 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m20:13:33.201798 [debug] [MainThread]: Using snowflake connection "debug"
[0m20:13:33.202081 [debug] [MainThread]: On debug: select 1 as id
[0m20:13:33.202332 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:13:37.746563 [debug] [MainThread]: SQL status: SUCCESS 1 in 5.0 seconds
[0m20:13:37.750651 [debug] [MainThread]: On debug: Close
[0m20:13:37.939256 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m20:13:37.941408 [info ] [MainThread]: [32mAll checks passed![0m
[0m20:13:37.944673 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 5.1495333, "process_user_time": 1.991614, "process_kernel_time": 0.09978, "process_mem_max_rss": "110596", "process_in_blocks": "8", "process_out_blocks": "848"}
[0m20:13:37.946562 [debug] [MainThread]: Command `dbt debug` succeeded at 20:13:37.946052 after 5.15 seconds
[0m20:13:37.948644 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m20:13:37.950023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f16fd7b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f16d1d7220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79f16d74bee0>]}
[0m20:13:37.951184 [debug] [MainThread]: Flushing usage events
[0m21:43:08.357038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0fe2fc84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0fe1142710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0fe11426b0>]}


============================== 21:43:08.359692 | 9fec35a4-1d73-47d5-bd16-8d5636669479 ==============================
[0m21:43:08.359692 [info ] [MainThread]: Running with dbt=1.7.10
[0m21:43:08.360263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:43:08.360728 [info ] [MainThread]: dbt version: 1.7.10
[0m21:43:08.361085 [info ] [MainThread]: python version: 3.10.12
[0m21:43:08.361440 [info ] [MainThread]: python path: /home/kishanmahajan/Desktop/course/venv/bin/python
[0m21:43:08.361855 [info ] [MainThread]: os info: Linux-6.5.0-25-generic-x86_64-with-glibc2.35
[0m21:43:08.564030 [info ] [MainThread]: Using profiles dir at /home/kishanmahajan/.dbt
[0m21:43:08.564568 [info ] [MainThread]: Using profiles.yml file at /home/kishanmahajan/.dbt/profiles.yml
[0m21:43:08.564985 [info ] [MainThread]: Using dbt_project.yml file at /home/kishanmahajan/Desktop/course/dbtlearnnew/dbt_project.yml
[0m21:43:08.568109 [info ] [MainThread]: adapter type: snowflake
[0m21:43:08.568683 [info ] [MainThread]: adapter version: 1.7.1
[0m21:43:08.640926 [info ] [MainThread]: Configuration:
[0m21:43:08.641664 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m21:43:08.642229 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m21:43:08.642665 [info ] [MainThread]: Required dependencies:
[0m21:43:08.643133 [debug] [MainThread]: Executing "git --help"
[0m21:43:08.645386 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m21:43:08.645914 [debug] [MainThread]: STDERR: "b''"
[0m21:43:08.646349 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m21:43:08.646845 [info ] [MainThread]: Connection:
[0m21:43:08.647290 [info ] [MainThread]:   account: opofypc-ca62067
[0m21:43:08.647738 [info ] [MainThread]:   user: dbt
[0m21:43:08.648122 [info ] [MainThread]:   database: AIRBNB
[0m21:43:08.648478 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m21:43:08.648835 [info ] [MainThread]:   role: transform
[0m21:43:08.649193 [info ] [MainThread]:   schema: DEV
[0m21:43:08.649645 [info ] [MainThread]:   authenticator: None
[0m21:43:08.650121 [info ] [MainThread]:   private_key_path: None
[0m21:43:08.650589 [info ] [MainThread]:   token: None
[0m21:43:08.651036 [info ] [MainThread]:   oauth_client_id: None
[0m21:43:08.651545 [info ] [MainThread]:   query_tag: None
[0m21:43:08.652010 [info ] [MainThread]:   client_session_keep_alive: False
[0m21:43:08.652536 [info ] [MainThread]:   host: None
[0m21:43:08.653084 [info ] [MainThread]:   port: None
[0m21:43:08.653598 [info ] [MainThread]:   proxy_host: None
[0m21:43:08.654022 [info ] [MainThread]:   proxy_port: None
[0m21:43:08.654453 [info ] [MainThread]:   protocol: None
[0m21:43:08.654800 [info ] [MainThread]:   connect_retries: 1
[0m21:43:08.655135 [info ] [MainThread]:   connect_timeout: None
[0m21:43:08.655471 [info ] [MainThread]:   retry_on_database_errors: False
[0m21:43:08.655803 [info ] [MainThread]:   retry_all: False
[0m21:43:08.656129 [info ] [MainThread]:   insecure_mode: False
[0m21:43:08.656450 [info ] [MainThread]:   reuse_connections: None
[0m21:43:08.656885 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m21:43:08.657765 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m21:43:08.658732 [debug] [MainThread]: Using snowflake connection "debug"
[0m21:43:08.659140 [debug] [MainThread]: On debug: select 1 as id
[0m21:43:08.659471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:43:14.564303 [debug] [MainThread]: SQL status: SUCCESS 1 in 6.0 seconds
[0m21:43:14.567691 [debug] [MainThread]: On debug: Close
[0m21:43:14.778996 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m21:43:14.780660 [info ] [MainThread]: [32mAll checks passed![0m
[0m21:43:14.789305 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 6.4717083, "process_user_time": 1.840056, "process_kernel_time": 0.154993, "process_mem_max_rss": "110092", "process_out_blocks": "40", "process_in_blocks": "0"}
[0m21:43:14.791600 [debug] [MainThread]: Command `dbt debug` succeeded at 21:43:14.791114 after 6.47 seconds
[0m21:43:14.792638 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m21:43:14.793974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0fe2fc84f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0fe1142650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7d0fe0185660>]}
[0m21:43:14.794972 [debug] [MainThread]: Flushing usage events
[0m22:23:21.494423 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324a797850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773248cee590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773248cee530>]}


============================== 22:23:21.497562 | 7e300416-d02c-40dd-9ca9-4d52a49d250c ==============================
[0m22:23:21.497562 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:23:21.498085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:23:21.759954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773248cee680>]}
[0m22:23:21.835965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773248caee30>]}
[0m22:23:21.836768 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:23:21.843916 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:23:21.873473 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:23:21.874035 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:23:21.879481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247a50df0>]}
[0m22:23:21.890031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247aeb010>]}
[0m22:23:21.890910 [info ] [MainThread]: Found 1 model, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:23:21.891562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247aeb040>]}
[0m22:23:21.894003 [info ] [MainThread]: 
[0m22:23:21.895357 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:23:21.897071 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m22:23:21.959443 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m22:23:21.960871 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m22:23:21.961614 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:23:30.829109 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 9.0 seconds
[0m22:23:30.832047 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m22:23:31.001475 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now create_AIRBNB_DEV)
[0m22:23:31.003608 [debug] [ThreadPool]: Creating schema "database: "AIRBNB"
schema: "DEV"
"
[0m22:23:31.014467 [debug] [ThreadPool]: Using snowflake connection "create_AIRBNB_DEV"
[0m22:23:31.015072 [debug] [ThreadPool]: On create_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "create_AIRBNB_DEV"} */
create schema if not exists AIRBNB.DEV
[0m22:23:31.015519 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:32.015153 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:23:32.017856 [debug] [ThreadPool]: On create_AIRBNB_DEV: Close
[0m22:23:32.221176 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_AIRBNB_DEV, now list_AIRBNB_DEV)
[0m22:23:32.233740 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m22:23:32.234193 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m22:23:32.234513 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:23:33.088919 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 1.0 seconds
[0m22:23:33.094689 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m22:23:33.286670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247887580>]}
[0m22:23:33.288285 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:23:33.288979 [info ] [MainThread]: 
[0m22:23:33.306948 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m22:23:33.308539 [info ] [Thread-1 (]: 1 of 1 START sql view model DEV.src_listing .................................... [RUN]
[0m22:23:33.309714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.src_listing)
[0m22:23:33.310344 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m22:23:33.316826 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m22:23:33.317984 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 22:23:33.310632 => 22:23:33.317675
[0m22:23:33.318514 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m22:23:33.343646 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m22:23:33.344832 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m22:23:33.345293 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m22:23:33.345679 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:23:34.080758 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:23:34.103088 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 22:23:33.318892 => 22:23:34.102886
[0m22:23:34.103533 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m22:23:34.268562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7e300416-d02c-40dd-9ca9-4d52a49d250c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773246fa99c0>]}
[0m22:23:34.269787 [info ] [Thread-1 (]: 1 of 1 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.96s]
[0m22:23:34.270825 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m22:23:34.273250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:34.274263 [debug] [MainThread]: Connection 'model.dbtlearnnew.src_listing' was properly closed.
[0m22:23:34.275072 [info ] [MainThread]: 
[0m22:23:34.276067 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 12.38 seconds (12.38s).
[0m22:23:34.277323 [debug] [MainThread]: Command end result
[0m22:23:34.284668 [info ] [MainThread]: 
[0m22:23:34.285498 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:34.286014 [info ] [MainThread]: 
[0m22:23:34.286471 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m22:23:34.287695 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.833004, "process_user_time": 2.356161, "process_kernel_time": 0.120893, "process_mem_max_rss": "118100", "process_out_blocks": "1736", "process_in_blocks": "0"}
[0m22:23:34.288239 [debug] [MainThread]: Command `dbt run` succeeded at 22:23:34.288115 after 12.83 seconds
[0m22:23:34.288582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77324a797850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773248caee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x773247b8a800>]}
[0m22:23:34.288927 [debug] [MainThread]: Flushing usage events
[0m22:25:47.663828 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b113f7b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b11240a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b11240a560>]}


============================== 22:25:47.666272 | 17c1ab93-be21-4342-b8c5-c7bd6cf90e97 ==============================
[0m22:25:47.666272 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:25:47.666811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m22:25:47.918547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b11240a6b0>]}
[0m22:25:47.993596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b1123c1ba0>]}
[0m22:25:47.994671 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:25:48.000902 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:25:48.028611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:25:48.029120 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:25:48.033588 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b111149720>]}
[0m22:25:48.043611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b11110c520>]}
[0m22:25:48.044511 [info ] [MainThread]: Found 3 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m22:25:48.045283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b11110fb50>]}
[0m22:25:48.048001 [info ] [MainThread]: 
[0m22:25:48.049295 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:25:48.050719 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m22:25:48.114549 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m22:25:48.115005 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m22:25:48.115314 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:25:53.365829 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 5.0 seconds
[0m22:25:53.368987 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m22:25:53.548299 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m22:25:53.557542 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m22:25:53.558174 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m22:25:53.558526 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:25:54.379922 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:25:54.381441 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m22:25:54.550489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b110f8af80>]}
[0m22:25:54.553144 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:25:54.554351 [info ] [MainThread]: 
[0m22:25:54.559284 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m22:25:54.561359 [info ] [Thread-1 (]: 1 of 3 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m22:25:54.563589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m22:25:54.564828 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m22:25:54.583589 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m22:25:54.585928 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 22:25:54.565529 => 22:25:54.585035
[0m22:25:54.587612 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m22:25:54.635872 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m22:25:54.637048 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m22:25:54.637589 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m22:25:54.638053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:55.387590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:25:55.414342 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 22:25:54.588630 => 22:25:55.414138
[0m22:25:55.414814 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m22:25:55.583707 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b111040940>]}
[0m22:25:55.585383 [info ] [Thread-1 (]: 1 of 3 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 1.02s]
[0m22:25:55.587061 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m22:25:55.588089 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m22:25:55.589153 [info ] [Thread-1 (]: 2 of 3 START sql view model DEV.src_listing .................................... [RUN]
[0m22:25:55.590268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m22:25:55.591018 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m22:25:55.594228 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m22:25:55.595420 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 22:25:55.591403 => 22:25:55.595001
[0m22:25:55.596122 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m22:25:55.600177 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m22:25:55.601337 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m22:25:55.601773 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m22:25:55.602117 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:56.419046 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:25:56.429475 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 22:25:55.596506 => 22:25:56.429086
[0m22:25:56.430238 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m22:25:56.636349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b1110410c0>]}
[0m22:25:56.638189 [info ] [Thread-1 (]: 2 of 3 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.05s]
[0m22:25:56.639610 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m22:25:56.640592 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m22:25:56.642036 [info ] [Thread-1 (]: 3 of 3 START sql view model DEV.src_reviews .................................... [RUN]
[0m22:25:56.644057 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m22:25:56.644796 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m22:25:56.647437 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m22:25:56.648479 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 22:25:56.645167 => 22:25:56.648096
[0m22:25:56.649163 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m22:25:56.652962 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m22:25:56.654078 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m22:25:56.654571 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m22:25:56.655058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:25:57.459642 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m22:25:57.467785 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 22:25:56.649545 => 22:25:57.467189
[0m22:25:57.468930 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m22:25:57.670084 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c1ab93-be21-4342-b8c5-c7bd6cf90e97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b1105c7fd0>]}
[0m22:25:57.671224 [info ] [Thread-1 (]: 3 of 3 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.03s]
[0m22:25:57.672344 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m22:25:57.673997 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:25:57.674454 [debug] [MainThread]: Connection 'model.dbtlearnnew.src_reviews' was properly closed.
[0m22:25:57.675058 [info ] [MainThread]: 
[0m22:25:57.675663 [info ] [MainThread]: Finished running 3 view models in 0 hours 0 minutes and 9.63 seconds (9.63s).
[0m22:25:57.676696 [debug] [MainThread]: Command end result
[0m22:25:57.683482 [info ] [MainThread]: 
[0m22:25:57.684200 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:25:57.684675 [info ] [MainThread]: 
[0m22:25:57.685001 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:25:57.685763 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.057843, "process_user_time": 2.592304, "process_kernel_time": 0.147335, "process_mem_max_rss": "118600", "process_out_blocks": "1776", "process_in_blocks": "0"}
[0m22:25:57.686242 [debug] [MainThread]: Command `dbt run` succeeded at 22:25:57.686128 after 10.06 seconds
[0m22:25:57.686566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b113f7b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b1123c1ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b1105e0ac0>]}
[0m22:25:57.686997 [debug] [MainThread]: Flushing usage events
[0m09:58:15.665053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b42cbaf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b42b0464d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b42b046470>]}


============================== 09:58:15.667388 | 2b0a8a8b-b174-4f85-8f5b-f77a9431a613 ==============================
[0m09:58:15.667388 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:58:15.667925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:15.668337 [info ] [MainThread]: dbt version: 1.7.10
[0m09:58:15.668646 [info ] [MainThread]: python version: 3.10.12
[0m09:58:15.668953 [info ] [MainThread]: python path: /home/kishanmahajan/Desktop/course/dbtlearnnew/venv/bin/python
[0m09:58:15.669248 [info ] [MainThread]: os info: Linux-6.5.0-25-generic-x86_64-with-glibc2.35
[0m09:58:15.866925 [info ] [MainThread]: Using profiles dir at /home/kishanmahajan/.dbt
[0m09:58:15.867397 [info ] [MainThread]: Using profiles.yml file at /home/kishanmahajan/.dbt/profiles.yml
[0m09:58:15.867738 [info ] [MainThread]: Using dbt_project.yml file at /home/kishanmahajan/Desktop/course/dbtlearnnew/dbt_project.yml
[0m09:58:15.868218 [info ] [MainThread]: adapter type: snowflake
[0m09:58:15.868532 [info ] [MainThread]: adapter version: 1.7.1
[0m09:58:15.927331 [info ] [MainThread]: Configuration:
[0m09:58:15.927771 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m09:58:15.928109 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m09:58:15.928397 [info ] [MainThread]: Required dependencies:
[0m09:58:15.928684 [debug] [MainThread]: Executing "git --help"
[0m09:58:15.930750 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m09:58:15.931132 [debug] [MainThread]: STDERR: "b''"
[0m09:58:15.931402 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m09:58:15.931678 [info ] [MainThread]: Connection:
[0m09:58:15.931949 [info ] [MainThread]:   account: opofypc-ca62067
[0m09:58:15.932197 [info ] [MainThread]:   user: dbt
[0m09:58:15.932438 [info ] [MainThread]:   database: AIRBNB
[0m09:58:15.932674 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m09:58:15.932922 [info ] [MainThread]:   role: transform
[0m09:58:15.933157 [info ] [MainThread]:   schema: DEV
[0m09:58:15.933393 [info ] [MainThread]:   authenticator: None
[0m09:58:15.933629 [info ] [MainThread]:   private_key_path: None
[0m09:58:15.933863 [info ] [MainThread]:   token: None
[0m09:58:15.934098 [info ] [MainThread]:   oauth_client_id: None
[0m09:58:15.934331 [info ] [MainThread]:   query_tag: None
[0m09:58:15.934566 [info ] [MainThread]:   client_session_keep_alive: False
[0m09:58:15.934809 [info ] [MainThread]:   host: None
[0m09:58:15.935048 [info ] [MainThread]:   port: None
[0m09:58:15.935283 [info ] [MainThread]:   proxy_host: None
[0m09:58:15.935518 [info ] [MainThread]:   proxy_port: None
[0m09:58:15.935751 [info ] [MainThread]:   protocol: None
[0m09:58:15.935986 [info ] [MainThread]:   connect_retries: 1
[0m09:58:15.936232 [info ] [MainThread]:   connect_timeout: None
[0m09:58:15.936467 [info ] [MainThread]:   retry_on_database_errors: False
[0m09:58:15.936701 [info ] [MainThread]:   retry_all: False
[0m09:58:15.936944 [info ] [MainThread]:   insecure_mode: False
[0m09:58:15.937179 [info ] [MainThread]:   reuse_connections: None
[0m09:58:15.937477 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:58:15.937953 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m09:58:15.938605 [debug] [MainThread]: Using snowflake connection "debug"
[0m09:58:15.939011 [debug] [MainThread]: On debug: select 1 as id
[0m09:58:15.939291 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:58:17.576977 [debug] [MainThread]: SQL status: SUCCESS 1 in 2.0 seconds
[0m09:58:17.579774 [debug] [MainThread]: On debug: Close
[0m09:58:17.797041 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m09:58:17.798373 [info ] [MainThread]: [32mAll checks passed![0m
[0m09:58:17.814658 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.195641, "process_user_time": 1.850156, "process_kernel_time": 0.087346, "process_mem_max_rss": "110440", "process_in_blocks": "8", "process_out_blocks": "848"}
[0m09:58:17.815272 [debug] [MainThread]: Command `dbt debug` succeeded at 09:58:17.815135 after 2.20 seconds
[0m09:58:17.816145 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m09:58:17.817152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b42cbaf7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b42a013910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70b42a57ff40>]}
[0m09:58:17.818201 [debug] [MainThread]: Flushing usage events
[0m09:58:28.974886 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc5793850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc3c2a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc3c2a530>]}


============================== 09:58:28.977096 | b6a58280-2b7d-445d-9e96-9d940fdc7ad9 ==============================
[0m09:58:28.977096 [info ] [MainThread]: Running with dbt=1.7.10
[0m09:58:28.977607 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:58:29.201131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc3c2a680>]}
[0m09:58:29.271725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc3bdee30>]}
[0m09:58:29.272677 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m09:58:29.279381 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m09:58:29.306694 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:58:29.307169 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:58:29.311499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc2969c30>]}
[0m09:58:29.328893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc29309d0>]}
[0m09:58:29.329461 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m09:58:29.329901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc2933f70>]}
[0m09:58:29.371373 [info ] [MainThread]: 
[0m09:58:29.372277 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:58:29.373326 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m09:58:29.383353 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m09:58:29.383759 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m09:58:29.384069 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:32.445352 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m09:58:32.449277 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m09:58:32.627035 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m09:58:32.643875 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m09:58:32.644447 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m09:58:32.644927 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:33.149696 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 1.0 seconds
[0m09:58:33.153702 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m09:58:33.334543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc27a75e0>]}
[0m09:58:33.336687 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m09:58:33.337487 [info ] [MainThread]: 
[0m09:58:33.355651 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m09:58:33.357142 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m09:58:33.358656 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m09:58:33.359459 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m09:58:33.367506 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m09:58:33.369746 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 09:58:33.359919 => 09:58:33.369439
[0m09:58:33.370176 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m09:58:33.391494 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m09:58:33.394336 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m09:58:33.394799 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m09:58:33.395150 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:34.286673 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:58:34.304941 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 09:58:33.370402 => 09:58:34.304730
[0m09:58:34.305371 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m09:58:34.841586 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc29328f0>]}
[0m09:58:34.843537 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 1.48s]
[0m09:58:34.845368 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m09:58:34.846659 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m09:58:34.848126 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listing .................................... [RUN]
[0m09:58:34.850550 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m09:58:34.851385 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m09:58:34.854493 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m09:58:34.866064 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 09:58:34.851871 => 09:58:34.865333
[0m09:58:34.867014 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m09:58:34.870828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m09:58:34.874165 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m09:58:34.874649 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m09:58:34.875013 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:35.636397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:58:35.643960 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 09:58:34.867580 => 09:58:35.643379
[0m09:58:35.645128 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m09:58:35.824938 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc05c4100>]}
[0m09:58:35.826920 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.97s]
[0m09:58:35.828870 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m09:58:35.830201 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m09:58:35.831627 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m09:58:35.833889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m09:58:35.834989 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m09:58:35.839270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m09:58:35.843253 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 09:58:35.835645 => 09:58:35.842759
[0m09:58:35.843864 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m09:58:35.846914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m09:58:35.849203 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m09:58:35.849625 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m09:58:35.849958 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:36.534568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:58:36.541917 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 09:58:35.844257 => 09:58:36.541340
[0m09:58:36.543103 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m09:58:36.758464 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc05ecf10>]}
[0m09:58:36.759119 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.93s]
[0m09:58:36.759647 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m09:58:36.760020 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m09:58:36.760433 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_listing .................................... [RUN]
[0m09:58:36.760978 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_listing)
[0m09:58:36.761300 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m09:58:36.763626 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m09:58:36.764378 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 09:58:36.761497 => 09:58:36.764117
[0m09:58:36.764899 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m09:58:36.767900 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m09:58:36.769105 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m09:58:36.769624 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace   view AIRBNB.DEV.dim_listing
  
   as (
    with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
 WHEN minimum_nights = 0 THEN 1
 ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(
 price_str,
 '$'
 ) :: NUMBER(
 10,
 2
 ) AS price,
 created_at,
 updated_at
FROM
 src_listings
  );
[0m09:58:36.770141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:37.481395 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m09:58:37.485898 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 09:58:36.765186 => 09:58:37.485711
[0m09:58:37.486329 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m09:58:37.671609 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b6a58280-2b7d-445d-9e96-9d940fdc7ad9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc27a0970>]}
[0m09:58:37.673610 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_listing ............................... [[32mSUCCESS 1[0m in 0.91s]
[0m09:58:37.675521 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m09:58:37.679137 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:37.680199 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listing' was properly closed.
[0m09:58:37.681304 [info ] [MainThread]: 
[0m09:58:37.681864 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 8.31 seconds (8.31s).
[0m09:58:37.682691 [debug] [MainThread]: Command end result
[0m09:58:37.704925 [info ] [MainThread]: 
[0m09:58:37.706201 [info ] [MainThread]: [32mCompleted successfully[0m
[0m09:58:37.706868 [info ] [MainThread]: 
[0m09:58:37.707490 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m09:58:37.708841 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 8.767503, "process_user_time": 2.288381, "process_kernel_time": 0.156315, "process_mem_max_rss": "118540", "process_in_blocks": "16", "process_out_blocks": "1816"}
[0m09:58:37.709622 [debug] [MainThread]: Command `dbt run` succeeded at 09:58:37.709455 after 8.77 seconds
[0m09:58:37.710093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc5793850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc057f430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75ccc3c2a4d0>]}
[0m09:58:37.710562 [debug] [MainThread]: Flushing usage events
[0m13:25:34.744799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717d582a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717ba16620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717ba165c0>]}


============================== 13:25:34.752946 | 9955430b-542e-4fe9-a2e9-c599a657a03f ==============================
[0m13:25:34.752946 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:25:34.753413 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:25:35.682708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717ba16710>]}
[0m13:25:35.768377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a94bd30>]}
[0m13:25:35.771081 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:25:35.780549 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:25:36.464367 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:25:36.465011 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:25:36.471455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a755cc0>]}
[0m13:25:36.603369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a71ca60>]}
[0m13:25:36.604138 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:25:36.604617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a728190>]}
[0m13:25:36.710262 [info ] [MainThread]: 
[0m13:25:36.711402 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:25:36.713205 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:25:36.730985 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:25:36.731625 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:25:36.732087 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:25:38.004024 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:25:38.008123 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:25:38.178770 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:25:38.191768 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:25:38.192573 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:25:38.193572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:25:38.695793 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:25:38.698757 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:25:38.863611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a5a3e50>]}
[0m13:25:38.864869 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:25:38.865640 [info ] [MainThread]: 
[0m13:25:38.872931 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:25:38.874005 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:25:38.875335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:25:38.876267 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:25:38.886016 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:25:38.890684 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:25:38.877132 => 13:25:38.890200
[0m13:25:38.891543 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:25:38.950241 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:25:38.957895 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:25:38.958748 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:25:38.959603 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:39.669017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:25:39.766871 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:25:38.893174 => 13:25:39.765926
[0m13:25:39.767580 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:25:39.932012 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a71eaa0>]}
[0m13:25:39.934102 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 1.06s]
[0m13:25:39.936662 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:25:39.937429 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:25:39.938095 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listing .................................... [RUN]
[0m13:25:39.939128 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:25:39.940291 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:25:39.943556 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:25:39.953557 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:25:39.940625 => 13:25:39.952980
[0m13:25:39.954265 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:25:39.966107 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:25:39.973529 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:25:39.977016 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:25:39.977924 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:42.527886 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:25:42.533228 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:25:39.954614 => 13:25:42.532865
[0m13:25:42.534345 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:25:42.695289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767179beb070>]}
[0m13:25:42.695988 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 2.76s]
[0m13:25:42.696562 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:25:42.696982 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:25:42.697568 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:25:42.698238 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:25:42.698643 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:25:42.700354 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:25:42.703499 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:25:42.698858 => 13:25:42.703207
[0m13:25:42.703896 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:25:42.708080 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:25:42.711181 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:25:42.711965 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:25:42.712715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:43.437099 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:25:43.443848 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:25:42.704117 => 13:25:43.443294
[0m13:25:43.444942 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:25:43.620960 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767179b50a60>]}
[0m13:25:43.622762 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m13:25:43.624378 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:25:43.625685 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:25:43.626989 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_listing .................................... [RUN]
[0m13:25:43.628531 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_listing)
[0m13:25:43.629387 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:25:43.633516 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:25:43.644728 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:25:43.629828 => 13:25:43.644206
[0m13:25:43.645459 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:25:43.650842 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:25:43.654020 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:25:43.654541 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace   view AIRBNB.DEV.dim_listing
  
   as (
    with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
 WHEN minimum_nights = 0 THEN 1
 ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(
 price_str,
 '$'
 ) :: NUMBER(
 10,
 2
 ) AS price,
 created_at,
 updated_at
FROM
 src_listings
  );
[0m13:25:43.654914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:25:44.345124 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:25:44.348569 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:25:43.645878 => 13:25:44.348336
[0m13:25:44.349400 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:25:44.548626 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9955430b-542e-4fe9-a2e9-c599a657a03f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767179abb1f0>]}
[0m13:25:44.550894 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_listing ............................... [[32mSUCCESS 1[0m in 0.92s]
[0m13:25:44.552654 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:25:44.555948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:25:44.556936 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listing' was properly closed.
[0m13:25:44.557726 [info ] [MainThread]: 
[0m13:25:44.558496 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 7.85 seconds (7.85s).
[0m13:25:44.560014 [debug] [MainThread]: Command end result
[0m13:25:44.577012 [info ] [MainThread]: 
[0m13:25:44.577642 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:25:44.578083 [info ] [MainThread]: 
[0m13:25:44.578520 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:25:44.582093 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.887924, "process_user_time": 2.767259, "process_kernel_time": 0.178114, "process_mem_max_rss": "120660", "process_in_blocks": "18336", "process_out_blocks": "2624"}
[0m13:25:44.582715 [debug] [MainThread]: Command `dbt run` succeeded at 13:25:44.582578 after 9.89 seconds
[0m13:25:44.583075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717d582a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x767179b50a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76717a94bd30>]}
[0m13:25:44.583506 [debug] [MainThread]: Flushing usage events
[0m12:36:29.160031 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495ee197850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495ec62a440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495ec62a3e0>]}


============================== 12:36:29.162259 | 18545ce1-8ab8-4b01-9f0d-82f10bb35cfb ==============================
[0m12:36:29.162259 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:36:29.162707 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:36:29.163076 [info ] [MainThread]: dbt version: 1.7.10
[0m12:36:29.163346 [info ] [MainThread]: python version: 3.10.12
[0m12:36:29.163591 [info ] [MainThread]: python path: /home/kishanmahajan/Desktop/course/venv/bin/python
[0m12:36:29.163831 [info ] [MainThread]: os info: Linux-6.5.0-26-generic-x86_64-with-glibc2.35
[0m12:36:29.324655 [info ] [MainThread]: Using profiles dir at /home/kishanmahajan/.dbt
[0m12:36:29.325104 [info ] [MainThread]: Using profiles.yml file at /home/kishanmahajan/.dbt/profiles.yml
[0m12:36:29.325418 [info ] [MainThread]: Using dbt_project.yml file at /home/kishanmahajan/Desktop/course/dbtlearnnew/dbt_project.yml
[0m12:36:29.325999 [info ] [MainThread]: adapter type: snowflake
[0m12:36:29.326306 [info ] [MainThread]: adapter version: 1.7.1
[0m12:36:29.385388 [info ] [MainThread]: Configuration:
[0m12:36:29.385850 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m12:36:29.386177 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m12:36:29.386459 [info ] [MainThread]: Required dependencies:
[0m12:36:29.386752 [debug] [MainThread]: Executing "git --help"
[0m12:36:29.388542 [debug] [MainThread]: STDOUT: "b"usage: git [--version] [--help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:36:29.388924 [debug] [MainThread]: STDERR: "b''"
[0m12:36:29.389222 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:36:29.389520 [info ] [MainThread]: Connection:
[0m12:36:29.389799 [info ] [MainThread]:   account: opofypc-ca62067
[0m12:36:29.390055 [info ] [MainThread]:   user: dbt
[0m12:36:29.390302 [info ] [MainThread]:   database: AIRBNB
[0m12:36:29.390543 [info ] [MainThread]:   warehouse: COMPUTE_WH
[0m12:36:29.390783 [info ] [MainThread]:   role: transform
[0m12:36:29.391025 [info ] [MainThread]:   schema: DEV
[0m12:36:29.391268 [info ] [MainThread]:   authenticator: None
[0m12:36:29.391508 [info ] [MainThread]:   private_key_path: None
[0m12:36:29.391749 [info ] [MainThread]:   token: None
[0m12:36:29.391990 [info ] [MainThread]:   oauth_client_id: None
[0m12:36:29.392231 [info ] [MainThread]:   query_tag: None
[0m12:36:29.392471 [info ] [MainThread]:   client_session_keep_alive: False
[0m12:36:29.392712 [info ] [MainThread]:   host: None
[0m12:36:29.392953 [info ] [MainThread]:   port: None
[0m12:36:29.393213 [info ] [MainThread]:   proxy_host: None
[0m12:36:29.393466 [info ] [MainThread]:   proxy_port: None
[0m12:36:29.393711 [info ] [MainThread]:   protocol: None
[0m12:36:29.393955 [info ] [MainThread]:   connect_retries: 1
[0m12:36:29.394197 [info ] [MainThread]:   connect_timeout: None
[0m12:36:29.394439 [info ] [MainThread]:   retry_on_database_errors: False
[0m12:36:29.394682 [info ] [MainThread]:   retry_all: False
[0m12:36:29.394922 [info ] [MainThread]:   insecure_mode: False
[0m12:36:29.395163 [info ] [MainThread]:   reuse_connections: None
[0m12:36:29.395478 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:36:29.395936 [debug] [MainThread]: Acquiring new snowflake connection 'debug'
[0m12:36:29.396502 [debug] [MainThread]: Using snowflake connection "debug"
[0m12:36:29.396815 [debug] [MainThread]: On debug: select 1 as id
[0m12:36:29.397216 [debug] [MainThread]: Opening a new connection, currently in state init
[0m12:36:30.009844 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:36:30.012499 [debug] [MainThread]: On debug: Close
[0m12:36:30.196049 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m12:36:30.197475 [info ] [MainThread]: [32mAll checks passed![0m
[0m12:36:30.199876 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.0857596, "process_user_time": 1.688158, "process_kernel_time": 0.084609, "process_mem_max_rss": "110492", "process_out_blocks": "32", "process_in_blocks": "0"}
[0m12:36:30.201584 [debug] [MainThread]: Command `dbt debug` succeeded at 12:36:30.201163 after 1.09 seconds
[0m12:36:30.202660 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m12:36:30.203740 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495ee197850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495eb7fee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7495eda97520>]}
[0m12:36:30.204836 [debug] [MainThread]: Flushing usage events
[0m12:52:14.273793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a066bc0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a06502ad40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a06502ace0>]}


============================== 12:52:14.276293 | fae2c0cd-7645-41c6-b903-48a6e588ea91 ==============================
[0m12:52:14.276293 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:52:14.276922 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt ', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m12:52:14.594268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fae2c0cd-7645-41c6-b903-48a6e588ea91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a06502ae90>]}
[0m12:52:14.679432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fae2c0cd-7645-41c6-b903-48a6e588ea91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a063f59480>]}
[0m12:52:14.680254 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:52:14.689381 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:52:14.725657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:52:14.726182 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:52:14.730672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fae2c0cd-7645-41c6-b903-48a6e588ea91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a063d763e0>]}
[0m12:52:14.762021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fae2c0cd-7645-41c6-b903-48a6e588ea91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a063d44550>]}
[0m12:52:14.762627 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m12:52:14.763118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fae2c0cd-7645-41c6-b903-48a6e588ea91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a063d44580>]}
[0m12:52:14.822747 [info ] [MainThread]: 
[0m12:52:14.823606 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m12:52:14.824531 [debug] [MainThread]: Command end result
[0m12:52:14.895441 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.66520244, "process_user_time": 2.343665, "process_kernel_time": 0.135058, "process_mem_max_rss": "110208", "process_out_blocks": "1704", "process_in_blocks": "0"}
[0m12:52:14.896630 [debug] [MainThread]: Command `cli test` succeeded at 12:52:14.896354 after 0.67 seconds
[0m12:52:14.897372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a066bc0940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a063e98580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x76a06502ada0>]}
[0m12:52:14.898037 [debug] [MainThread]: Flushing usage events
[0m13:00:17.456035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c91377850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8f806590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8f806530>]}


============================== 13:00:17.464936 | c8cdc7ac-4344-4eaf-976d-f6b92faade9b ==============================
[0m13:00:17.464936 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:00:17.465485 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:00:18.794945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8f806680>]}
[0m13:00:18.871916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8f7c6e30>]}
[0m13:00:18.875542 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:00:18.884683 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:00:19.443126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:00:19.443921 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:00:19.449025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8e545c30>]}
[0m13:00:19.518944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8e5d49d0>]}
[0m13:00:19.519690 [info ] [MainThread]: Found 4 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:00:19.520155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8e5d7f70>]}
[0m13:00:19.579929 [info ] [MainThread]: 
[0m13:00:19.589086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:00:19.597967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:00:19.643527 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:00:19.644368 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:00:19.645018 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:00:20.938126 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:00:20.945425 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:00:21.154173 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:00:21.168383 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:00:21.168820 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:00:21.169136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:00:31.962811 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 11.0 seconds
[0m13:00:31.968221 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:00:32.169445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8e38f820>]}
[0m13:00:32.171797 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:00:32.172927 [info ] [MainThread]: 
[0m13:00:32.191399 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:00:32.193218 [info ] [Thread-1 (]: 1 of 4 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:00:32.195837 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:00:32.197373 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:00:32.212750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:00:32.216773 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:00:32.198107 => 13:00:32.216369
[0m13:00:32.217344 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:00:32.240327 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:00:32.243160 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:00:32.243693 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:00:32.244089 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:33.220672 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:00:33.248891 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:00:32.217677 => 13:00:33.248688
[0m13:00:33.249348 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:00:33.444686 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8daa2aa0>]}
[0m13:00:33.446526 [info ] [Thread-1 (]: 1 of 4 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 1.25s]
[0m13:00:33.448423 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:00:33.449743 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:00:33.451210 [info ] [Thread-1 (]: 2 of 4 START sql view model DEV.src_listing .................................... [RUN]
[0m13:00:33.453099 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:00:33.454211 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:00:33.458792 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:00:33.472606 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:00:33.454885 => 13:00:33.471708
[0m13:00:33.473874 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:00:33.481822 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:00:33.485562 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:00:33.486188 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:00:33.486697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:34.147103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:00:34.154568 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:00:33.474522 => 13:00:34.154052
[0m13:00:34.155817 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:00:34.350180 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8c1a4100>]}
[0m13:00:34.352048 [info ] [Thread-1 (]: 2 of 4 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.90s]
[0m13:00:34.353901 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:00:34.355121 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:00:34.356467 [info ] [Thread-1 (]: 3 of 4 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:00:34.357848 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:00:34.358504 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:00:34.361165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:00:34.372754 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:00:34.358902 => 13:00:34.372018
[0m13:00:34.373943 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:00:34.378345 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:00:34.381615 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:00:34.382107 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:00:34.382531 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:35.111724 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:00:35.118968 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:00:34.374570 => 13:00:35.118439
[0m13:00:35.119964 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:00:35.286786 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8c18c4c0>]}
[0m13:00:35.288028 [info ] [Thread-1 (]: 3 of 4 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.93s]
[0m13:00:35.289150 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:00:35.289894 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:00:35.290712 [info ] [Thread-1 (]: 4 of 4 START sql view model DEV.dim_listing .................................... [RUN]
[0m13:00:35.291913 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_listing)
[0m13:00:35.292480 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:00:35.297281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:00:35.299876 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:00:35.292876 => 13:00:35.299515
[0m13:00:35.300341 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:00:35.303038 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:00:35.305809 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:00:35.306540 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace   view AIRBNB.DEV.dim_listing
  
   as (
    with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
  );
[0m13:00:35.307075 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:00:35.984966 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:00:35.987996 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:00:35.300557 => 13:00:35.987779
[0m13:00:35.988568 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:00:36.182822 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8cdc7ac-4344-4eaf-976d-f6b92faade9b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8db4f880>]}
[0m13:00:36.184711 [info ] [Thread-1 (]: 4 of 4 OK created sql view model DEV.dim_listing ............................... [[32mSUCCESS 1[0m in 0.89s]
[0m13:00:36.186295 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:00:36.189439 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:00:36.190357 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listing' was properly closed.
[0m13:00:36.191432 [info ] [MainThread]: 
[0m13:00:36.192361 [info ] [MainThread]: Finished running 4 view models in 0 hours 0 minutes and 16.61 seconds (16.61s).
[0m13:00:36.194167 [debug] [MainThread]: Command end result
[0m13:00:36.203899 [info ] [MainThread]: 
[0m13:00:36.204384 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:00:36.204710 [info ] [MainThread]: 
[0m13:00:36.205127 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:00:36.208706 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.804708, "process_user_time": 2.833378, "process_kernel_time": 0.176351, "process_mem_max_rss": "118816", "process_in_blocks": "216", "process_out_blocks": "1816"}
[0m13:00:36.209369 [debug] [MainThread]: Command `dbt run` succeeded at 13:00:36.209229 after 18.81 seconds
[0m13:00:36.209717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c91377850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8f7c6e30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x728c8db67a00>]}
[0m13:00:36.210066 [debug] [MainThread]: Flushing usage events
[0m13:12:31.620449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d75b97820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d740ee5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d740ee560>]}


============================== 13:12:31.622634 | 02daffba-188f-4646-86da-ac81ae3b5dbb ==============================
[0m13:12:31.622634 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:12:31.623151 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:12:31.846528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d740ee6b0>]}
[0m13:12:31.914640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d740adba0>]}
[0m13:12:31.915396 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:12:31.921060 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:12:31.946334 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:12:31.946815 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:12:31.951599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d72e5e140>]}
[0m13:12:31.963805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d72e2c370>]}
[0m13:12:31.964345 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:12:31.964778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d72e2c310>]}
[0m13:12:32.006330 [info ] [MainThread]: 
[0m13:12:32.007229 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:12:32.008374 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:12:32.018802 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:12:32.019237 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:12:32.019550 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:12:42.445796 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 10.0 seconds
[0m13:12:42.449467 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:12:42.645150 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:12:42.663433 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:12:42.664052 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:12:42.664658 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:12:43.464500 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:12:43.468707 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:12:43.705414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d72caed10>]}
[0m13:12:43.706636 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:12:43.707217 [info ] [MainThread]: 
[0m13:12:43.727707 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:12:43.728546 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:12:43.729407 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:12:43.729882 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:12:43.738757 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:12:43.740245 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:12:43.730148 => 13:12:43.739809
[0m13:12:43.741208 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:12:43.763984 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:12:43.764973 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:12:43.765379 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:12:43.765715 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:44.387130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:12:44.416927 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:12:43.741734 => 13:12:44.416730
[0m13:12:44.417384 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:12:44.605973 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d72e54460>]}
[0m13:12:44.607884 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 0.88s]
[0m13:12:44.609803 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:12:44.611055 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:12:44.612421 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m13:12:44.614029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:12:44.615169 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:12:44.618026 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:12:44.620872 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:12:44.615587 => 13:12:44.620457
[0m13:12:44.621446 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:12:44.624278 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:12:44.626815 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:12:44.627295 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:12:44.627700 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:45.546322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:12:45.553402 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:12:44.621704 => 13:12:45.552777
[0m13:12:45.554588 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:12:45.755991 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d70ab0130>]}
[0m13:12:45.758009 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.14s]
[0m13:12:45.759946 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:12:45.761308 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:12:45.762874 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:12:45.764911 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:12:45.766122 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:12:45.769864 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:12:45.771109 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:12:45.766719 => 13:12:45.770678
[0m13:12:45.771983 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:12:45.775402 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:12:45.776342 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:12:45.776722 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:12:45.777086 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:46.560389 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:12:46.567767 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:12:45.772377 => 13:12:46.567192
[0m13:12:46.568915 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:12:46.751130 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d70aa26e0>]}
[0m13:12:46.752875 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.99s]
[0m13:12:46.754565 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:12:46.755820 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:12:46.757154 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts ...................................... [RUN]
[0m13:12:46.758834 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:12:46.759847 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:12:46.765407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:12:46.766985 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:12:46.760462 => 13:12:46.766514
[0m13:12:46.767583 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:12:46.771653 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:12:46.772857 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:12:46.773472 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace   view AIRBNB.DEV.dim_hosts
  
   as (
    with src_host as (

    select * from AIRBNB.DEV.scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous')
is_superhost,
created_at,
updated_at
from src_host
  );
[0m13:12:46.773989 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:47.485065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:12:47.491624 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:12:46.767930 => 13:12:47.491043
[0m13:12:47.492842 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:12:47.668897 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d70aa1ae0>]}
[0m13:12:47.670898 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts ................................. [[32mSUCCESS 1[0m in 0.91s]
[0m13:12:47.672828 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:12:47.674220 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:12:47.675613 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listing .................................... [RUN]
[0m13:12:47.677832 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:12:47.679038 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:12:47.685251 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:12:47.688365 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:12:47.679723 => 13:12:47.688025
[0m13:12:47.688861 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:12:47.691993 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:12:47.692991 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:12:47.693372 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace   view AIRBNB.DEV.dim_listing
  
   as (
    with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
  );
[0m13:12:47.693702 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:12:48.618689 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:12:48.626427 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:12:47.689146 => 13:12:48.625833
[0m13:12:48.627624 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:12:48.816794 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '02daffba-188f-4646-86da-ac81ae3b5dbb', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d70aa10f0>]}
[0m13:12:48.818813 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listing ............................... [[32mSUCCESS 1[0m in 1.14s]
[0m13:12:48.820671 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:12:48.824520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:12:48.825599 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listing' was properly closed.
[0m13:12:48.826660 [info ] [MainThread]: 
[0m13:12:48.827697 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 16.82 seconds (16.82s).
[0m13:12:48.830406 [debug] [MainThread]: Command end result
[0m13:12:48.844363 [info ] [MainThread]: 
[0m13:12:48.844837 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:12:48.845199 [info ] [MainThread]: 
[0m13:12:48.845524 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:12:48.846438 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.258698, "process_user_time": 2.442169, "process_kernel_time": 0.107077, "process_mem_max_rss": "118916", "process_out_blocks": "1848", "process_in_blocks": "0"}
[0m13:12:48.847141 [debug] [MainThread]: Command `dbt run` succeeded at 13:12:48.847009 after 17.26 seconds
[0m13:12:48.847509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d75b97820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d740ee6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x741d72e2c550>]}
[0m13:12:48.847920 [debug] [MainThread]: Flushing usage events
[0m13:15:07.732534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28c3937f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28a5425c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28a542560>]}


============================== 13:15:07.734770 | 1de9bdc7-4123-4846-aaab-1c9c374e82b6 ==============================
[0m13:15:07.734770 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:15:07.735327 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:15:07.969441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28a5426b0>]}
[0m13:15:08.052903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28a4f9ba0>]}
[0m13:15:08.053766 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:15:08.060371 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:15:08.089983 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:15:08.090379 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:15:08.098478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2892fa140>]}
[0m13:15:08.107169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2892c8370>]}
[0m13:15:08.107863 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:15:08.108374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2892c8310>]}
[0m13:15:08.163145 [info ] [MainThread]: 
[0m13:15:08.164418 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:15:08.165670 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:15:08.178931 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:15:08.179596 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:15:08.180053 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:15:09.152158 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:15:09.155976 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:15:09.342819 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:15:09.366380 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:15:09.367495 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:15:09.368399 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:15:10.116412 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:15:10.120427 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:15:10.322869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d289146d10>]}
[0m13:15:10.324794 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:15:10.327395 [info ] [MainThread]: 
[0m13:15:10.331098 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:15:10.331941 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:15:10.332984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:15:10.333601 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:15:10.340399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:15:10.341254 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:15:10.333955 => 13:15:10.340967
[0m13:15:10.341626 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:15:10.372400 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:15:10.375680 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:15:10.376377 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:15:10.379004 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:12.317184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:15:12.352473 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:15:10.341839 => 13:15:12.352280
[0m13:15:12.352931 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:15:12.556242 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2892eb370>]}
[0m13:15:12.558203 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 2.22s]
[0m13:15:12.561315 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:15:12.563114 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:15:12.565853 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m13:15:12.568164 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:15:12.569352 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:15:12.573772 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:15:12.576134 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:15:12.570002 => 13:15:12.575405
[0m13:15:12.577373 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:15:12.583334 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:15:12.585783 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:15:12.586979 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:15:12.588017 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:14.782529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:15:14.788450 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:15:12.578156 => 13:15:14.788093
[0m13:15:14.789227 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:15:15.056401 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2887482e0>]}
[0m13:15:15.058375 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 2.49s]
[0m13:15:15.060495 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:15:15.061896 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:15:15.063142 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:15:15.064413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:15:15.065054 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:15:15.067917 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:15:15.071211 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:15:15.065461 => 13:15:15.070627
[0m13:15:15.071886 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:15:15.075076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:15:15.078413 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:15:15.079623 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:15:15.080814 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:15.914366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:15:15.919775 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:15:15.072177 => 13:15:15.919377
[0m13:15:15.920542 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:15:16.115184 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d288784ee0>]}
[0m13:15:16.117168 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.05s]
[0m13:15:16.118548 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:15:16.119523 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:15:16.120383 [info ] [Thread-1 (]: 4 of 5 START sql view model DEV.dim_hosts ...................................... [RUN]
[0m13:15:16.121519 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:15:16.122157 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:15:16.126466 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:15:16.127552 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:15:16.122532 => 13:15:16.127270
[0m13:15:16.128014 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:15:16.131070 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:15:16.132135 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:15:16.132548 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace   view AIRBNB.DEV.dim_hosts
  
   as (
    with src_host as (

    select * from AIRBNB.DEV.scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
  );
[0m13:15:16.132899 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:16.741359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:15:16.753997 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:15:16.128257 => 13:15:16.753134
[0m13:15:16.755420 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:15:16.955410 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2892b7910>]}
[0m13:15:16.957297 [info ] [Thread-1 (]: 4 of 5 OK created sql view model DEV.dim_hosts ................................. [[32mSUCCESS 1[0m in 0.83s]
[0m13:15:16.959517 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:15:16.962345 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:15:16.963733 [info ] [Thread-1 (]: 5 of 5 START sql view model DEV.dim_listing .................................... [RUN]
[0m13:15:16.965639 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:15:16.966607 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:15:16.972423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:15:16.978072 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:15:16.967155 => 13:15:16.976731
[0m13:15:16.978890 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:15:16.982816 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:15:16.985821 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:15:16.986434 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace   view AIRBNB.DEV.dim_listing
  
   as (
    with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
  );
[0m13:15:16.986878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:15:18.038533 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:15:18.049261 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:15:16.979330 => 13:15:18.048481
[0m13:15:18.050671 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:15:18.288373 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1de9bdc7-4123-4846-aaab-1c9c374e82b6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d288785780>]}
[0m13:15:18.290042 [info ] [Thread-1 (]: 5 of 5 OK created sql view model DEV.dim_listing ............................... [[32mSUCCESS 1[0m in 1.32s]
[0m13:15:18.291577 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:15:18.295429 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:15:18.296777 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listing' was properly closed.
[0m13:15:18.297924 [info ] [MainThread]: 
[0m13:15:18.298529 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 10.13 seconds (10.13s).
[0m13:15:18.300117 [debug] [MainThread]: Command end result
[0m13:15:18.315530 [info ] [MainThread]: 
[0m13:15:18.316022 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:15:18.316412 [info ] [MainThread]: 
[0m13:15:18.316908 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:15:18.318365 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 10.618588, "process_user_time": 2.560774, "process_kernel_time": 0.170718, "process_mem_max_rss": "118836", "process_out_blocks": "1856", "process_in_blocks": "0"}
[0m13:15:18.319286 [debug] [MainThread]: Command `dbt run` succeeded at 13:15:18.319098 after 10.62 seconds
[0m13:15:18.319831 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28c3937f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d28a5426b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79d2892c8550>]}
[0m13:15:18.320219 [debug] [MainThread]: Flushing usage events
[0m13:30:44.160269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3c17b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3a60a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3a60a560>]}


============================== 13:30:44.162690 | d44d5a05-1c1b-446b-9dc8-171a32898962 ==============================
[0m13:30:44.162690 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:30:44.163184 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m13:30:44.448970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3a60a6b0>]}
[0m13:30:44.530238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3953eb00>]}
[0m13:30:44.530982 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:30:44.539065 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:30:44.568877 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:30:44.569356 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:30:44.574049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3934a140>]}
[0m13:30:44.585293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3931c370>]}
[0m13:30:44.586201 [info ] [MainThread]: Found 5 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:30:44.586943 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3931c310>]}
[0m13:30:44.642068 [info ] [MainThread]: 
[0m13:30:44.643057 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:30:44.644286 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:30:44.657260 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:30:44.657721 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:30:44.658055 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:30:46.040683 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:30:46.044534 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:30:46.528158 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:30:46.546751 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:30:46.547259 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:30:46.547643 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:30:47.763109 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:30:47.767919 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:30:48.281096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e391a2d10>]}
[0m13:30:48.284454 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:30:48.286383 [info ] [MainThread]: 
[0m13:30:48.294586 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:30:48.296218 [info ] [Thread-1 (]: 1 of 5 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:30:48.298923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:30:48.300511 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:30:48.317198 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:30:48.324800 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:30:48.301317 => 13:30:48.323931
[0m13:30:48.325774 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:30:48.359835 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:30:48.362503 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:30:48.362994 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:30:48.363373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:49.412782 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:49.432753 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:30:48.326522 => 13:30:49.432476
[0m13:30:49.433334 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:30:49.731564 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e391869e0>]}
[0m13:30:49.734751 [info ] [Thread-1 (]: 1 of 5 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 1.43s]
[0m13:30:49.737907 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:30:49.739398 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:30:49.741354 [info ] [Thread-1 (]: 2 of 5 START sql view model DEV.src_listing .................................... [RUN]
[0m13:30:49.743645 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:30:49.744772 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:30:49.751584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:30:49.759482 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:30:49.745528 => 13:30:49.758558
[0m13:30:49.760691 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:30:49.772800 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:30:49.777208 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:30:49.779043 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:30:49.780658 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:50.627017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:50.631327 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:30:49.761398 => 13:30:50.630964
[0m13:30:50.632141 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:30:50.808798 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e32f282e0>]}
[0m13:30:50.810649 [info ] [Thread-1 (]: 2 of 5 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.07s]
[0m13:30:50.812536 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:30:50.813797 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:30:50.815075 [info ] [Thread-1 (]: 3 of 5 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:30:50.818381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:30:50.819729 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:30:50.825424 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:30:50.826923 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:30:50.820519 => 13:30:50.826408
[0m13:30:50.827636 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:30:50.831662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:30:50.833225 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:30:50.834219 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:30:50.834822 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:53.046107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:30:53.055143 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:30:50.828064 => 13:30:53.054782
[0m13:30:53.056123 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:30:53.291657 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e32f686a0>]}
[0m13:30:53.293590 [info ] [Thread-1 (]: 3 of 5 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 2.47s]
[0m13:30:53.295289 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:30:53.296625 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:30:53.298196 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m13:30:53.300334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:30:53.301604 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:30:53.311283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:30:53.317166 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:30:53.302454 => 13:30:53.316211
[0m13:30:53.319524 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:30:53.340563 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_HOSTS" because it is of type view
[0m13:30:53.348703 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_HOSTS"
[0m13:30:53.356336 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:30:53.356923 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
drop view if exists "AIRBNB"."DEV"."DIM_HOSTS" cascade
[0m13:30:53.357301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:54.047760 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:54.077965 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:30:54.080532 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:30:54.080978 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with src_host as (

    select * from AIRBNB.DEV.scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m13:30:56.004464 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:30:56.014484 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:30:53.320537 => 13:30:56.013914
[0m13:30:56.015713 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:30:56.222887 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e388a7010>]}
[0m13:30:56.225784 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 2.92s]
[0m13:30:56.228171 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:30:56.229119 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:30:56.229993 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m13:30:56.231297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:30:56.232060 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:30:56.236214 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:30:56.237282 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:30:56.232378 => 13:30:56.236947
[0m13:30:56.237746 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:30:56.241843 [debug] [Thread-1 (]: Dropping relation "AIRBNB"."DEV"."DIM_LISTING" because it is of type view
[0m13:30:56.244197 [debug] [Thread-1 (]: Applying DROP to: "AIRBNB"."DEV"."DIM_LISTING"
[0m13:30:56.245191 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:30:56.245577 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
drop view if exists "AIRBNB"."DEV"."DIM_LISTING" cascade
[0m13:30:56.245914 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:30:57.354024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:30:57.362084 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:30:57.369232 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:30:57.371047 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m13:30:58.902206 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:30:58.910161 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:30:56.238003 => 13:30:58.909611
[0m13:30:58.911272 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:30:59.096761 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd44d5a05-1c1b-446b-9dc8-171a32898962', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e32ec0280>]}
[0m13:30:59.098653 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 2.87s]
[0m13:30:59.101146 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:30:59.105290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:30:59.106617 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listing' was properly closed.
[0m13:30:59.108593 [info ] [MainThread]: 
[0m13:30:59.109816 [info ] [MainThread]: Finished running 3 view models, 2 table models in 0 hours 0 minutes and 14.47 seconds (14.47s).
[0m13:30:59.113568 [debug] [MainThread]: Command end result
[0m13:30:59.140019 [info ] [MainThread]: 
[0m13:30:59.141122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:30:59.142462 [info ] [MainThread]: 
[0m13:30:59.143040 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m13:30:59.144085 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.020343, "process_user_time": 2.879657, "process_kernel_time": 0.171503, "process_mem_max_rss": "120544", "process_out_blocks": "1856", "process_in_blocks": "0"}
[0m13:30:59.144782 [debug] [MainThread]: Command `dbt run` succeeded at 13:30:59.144626 after 15.02 seconds
[0m13:30:59.145344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3c17b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3a60a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x782e3931c5e0>]}
[0m13:30:59.145750 [debug] [MainThread]: Flushing usage events
[0m13:38:57.424066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d87a6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d6c3a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d6c3a590>]}


============================== 13:38:57.426541 | 1b059b2f-c566-41e7-8407-03919b74a81b ==============================
[0m13:38:57.426541 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:38:57.427056 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:38:57.731018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d6c3a6e0>]}
[0m13:38:57.806827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d5bef550>]}
[0m13:38:57.807568 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:38:57.813119 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:38:57.845699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:38:57.846144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:38:57.851198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d59ea650>]}
[0m13:38:57.863693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d59c4880>]}
[0m13:38:57.864661 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:38:57.865361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d59c4820>]}
[0m13:38:57.918027 [info ] [MainThread]: 
[0m13:38:57.919638 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:38:57.921050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:38:57.933119 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:38:57.933826 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:38:57.934507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:39:03.647851 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 6.0 seconds
[0m13:39:03.649629 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:39:03.825809 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:39:03.832855 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:39:03.833985 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:39:03.836140 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:39:04.525164 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.0 seconds
[0m13:39:04.526661 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:39:04.699748 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d58473d0>]}
[0m13:39:04.701491 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:39:04.702741 [info ] [MainThread]: 
[0m13:39:04.705660 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:39:04.706319 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:39:04.706989 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:39:04.707425 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:39:04.712820 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:39:04.713890 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:39:04.707631 => 13:39:04.713376
[0m13:39:04.714474 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:39:04.746728 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:39:04.747757 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:39:04.748333 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:39:04.748870 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:05.726477 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:05.752023 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:39:04.714858 => 13:39:05.751702
[0m13:39:05.752854 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:39:06.131857 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d59b6e90>]}
[0m13:39:06.132887 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 1.43s]
[0m13:39:06.134731 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:39:06.135298 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:39:06.136091 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listing .................................... [RUN]
[0m13:39:06.136778 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:39:06.137164 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:39:06.138746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:39:06.140972 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:39:06.137384 => 13:39:06.140588
[0m13:39:06.141569 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:39:06.145780 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:39:06.147015 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:39:06.147643 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:39:06.148255 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:06.811402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:06.814014 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:39:06.141890 => 13:39:06.813823
[0m13:39:06.814417 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:39:06.988002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d4e44700>]}
[0m13:39:06.988727 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 0.85s]
[0m13:39:06.989365 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:39:06.989849 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:39:06.990526 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:39:06.991254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:39:06.991613 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:39:06.993296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:39:06.995490 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:39:06.991818 => 13:39:06.995141
[0m13:39:06.995931 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:39:06.999085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:39:07.003273 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:39:07.003796 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:39:07.004275 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:07.770138 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:07.773164 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:39:06.996189 => 13:39:07.772845
[0m13:39:07.773714 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:39:07.951061 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d4e80c10>]}
[0m13:39:07.954731 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 0.96s]
[0m13:39:07.955640 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:39:07.956108 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:39:07.956718 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m13:39:07.957350 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:39:07.957683 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:39:07.960159 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:39:07.962594 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:39:07.957876 => 13:39:07.962139
[0m13:39:07.963245 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:39:07.988491 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:39:07.992053 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:39:07.992800 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with src_host as (

    select * from AIRBNB.DEV.scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m13:39:07.993361 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:09.185010 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:09.189221 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:39:07.963594 => 13:39:09.188950
[0m13:39:09.189709 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:39:09.443427 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d59b5870>]}
[0m13:39:09.444229 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.49s]
[0m13:39:09.444988 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:39:09.445438 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:39:09.446035 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listing ................................... [RUN]
[0m13:39:09.446742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:39:09.447158 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:39:09.451129 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:39:09.453818 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:39:09.447390 => 13:39:09.453411
[0m13:39:09.454305 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:39:09.457537 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:39:09.458689 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:39:09.459109 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m13:39:09.459512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:10.738549 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:39:10.741040 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:39:09.454574 => 13:39:10.740845
[0m13:39:10.741503 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:39:10.924428 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d4e80040>]}
[0m13:39:10.925211 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 1.48s]
[0m13:39:10.925936 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:39:10.926392 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m13:39:10.926874 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:39:10.927497 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m13:39:10.927915 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m13:39:10.935699 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m13:39:10.936694 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 13:39:10.928164 => 13:39:10.936336
[0m13:39:10.937792 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m13:39:10.977546 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m13:39:10.979164 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:39:10.979694 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with src_review as (

    select * from AIRBNB.DEV.src_reviews
)

select * from src_review where review_text is not null

        );
[0m13:39:10.980138 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:39:15.505110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m13:39:15.515719 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:39:15.523595 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:39:15.524257 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:39:15.652771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:39:15.655621 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 13:39:10.938146 => 13:39:15.655296
[0m13:39:15.656252 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m13:39:15.837539 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b059b2f-c566-41e7-8407-03919b74a81b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d4f3b8e0>]}
[0m13:39:15.838329 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.91s]
[0m13:39:15.838969 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m13:39:15.840535 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:39:15.841006 [debug] [MainThread]: Connection 'model.dbtlearnnew.fct_reviews' was properly closed.
[0m13:39:15.841518 [info ] [MainThread]: 
[0m13:39:15.841976 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 17.92 seconds (17.92s).
[0m13:39:15.843830 [debug] [MainThread]: Command end result
[0m13:39:15.856452 [info ] [MainThread]: 
[0m13:39:15.857172 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:39:15.857718 [info ] [MainThread]: 
[0m13:39:15.858228 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:39:15.859481 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.47256, "process_user_time": 2.642265, "process_kernel_time": 0.122778, "process_mem_max_rss": "119504", "process_out_blocks": "1912", "process_in_blocks": "0"}
[0m13:39:15.860208 [debug] [MainThread]: Command `dbt run` succeeded at 13:39:15.860034 after 18.47 seconds
[0m13:39:15.860719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d87a6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d5bef550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7386d59c4a60>]}
[0m13:39:15.862301 [debug] [MainThread]: Flushing usage events
[0m13:43:13.138904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b2d7f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b120a560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b120a500>]}


============================== 13:43:13.141845 | 053b522d-536b-4fe8-bf6a-11313d25ba21 ==============================
[0m13:43:13.141845 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:43:13.142452 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m13:43:13.509566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b120a650>]}
[0m13:43:13.590719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b02740a0>]}
[0m13:43:13.591611 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:43:13.599492 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:43:13.658276 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:43:13.659128 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:43:13.665407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280aff425c0>]}
[0m13:43:13.674680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280aff207f0>]}
[0m13:43:13.675706 [info ] [MainThread]: Found 6 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:43:13.676411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280aff20790>]}
[0m13:43:13.735282 [info ] [MainThread]: 
[0m13:43:13.736329 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:43:13.737666 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:43:13.756186 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:43:13.758146 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:43:13.758574 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:43:15.690719 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 2.0 seconds
[0m13:43:15.693443 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:43:16.067351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:43:16.075652 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:43:16.076086 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:43:16.076402 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:43:16.708446 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:43:16.713553 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:43:16.914870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280afda2d10>]}
[0m13:43:16.916782 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:43:16.917863 [info ] [MainThread]: 
[0m13:43:16.921329 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:43:16.922471 [info ] [Thread-1 (]: 1 of 6 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:43:16.923995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:43:16.924883 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:43:16.936732 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:43:16.937815 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:43:16.925421 => 13:43:16.937484
[0m13:43:16.938312 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:43:16.966041 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:43:16.969197 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:43:16.969956 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:43:16.970549 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:17.573626 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:17.604263 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:43:16.938691 => 13:43:17.604065
[0m13:43:17.604730 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:43:17.814513 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280aff0f700>]}
[0m13:43:17.815945 [info ] [Thread-1 (]: 1 of 6 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 0.89s]
[0m13:43:17.817111 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:43:17.817945 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:43:17.818760 [info ] [Thread-1 (]: 2 of 6 START sql view model DEV.src_listing .................................... [RUN]
[0m13:43:17.819687 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:43:17.820220 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:43:17.822834 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:43:17.833894 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:43:17.820532 => 13:43:17.833404
[0m13:43:17.834622 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:43:17.838722 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:43:17.839984 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:43:17.840428 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:43:17.840766 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:18.735841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:18.741732 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:43:17.835048 => 13:43:18.741370
[0m13:43:18.742508 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:43:18.918216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280adba4820>]}
[0m13:43:18.920045 [info ] [Thread-1 (]: 2 of 6 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.10s]
[0m13:43:18.921937 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:43:18.923283 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:43:18.924708 [info ] [Thread-1 (]: 3 of 6 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:43:18.926484 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:43:18.927416 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:43:18.932296 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:43:18.934121 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:43:18.927921 => 13:43:18.933583
[0m13:43:18.935056 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:43:18.938249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:43:18.940946 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:43:18.941434 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:43:18.941805 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:19.959637 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:19.966281 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:43:18.935541 => 13:43:19.965923
[0m13:43:19.966977 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:43:20.143769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280adbe0df0>]}
[0m13:43:20.146243 [info ] [Thread-1 (]: 3 of 6 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.22s]
[0m13:43:20.148249 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:43:20.149596 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:43:20.150828 [info ] [Thread-1 (]: 4 of 6 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m13:43:20.151935 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:43:20.152416 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:43:20.155581 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:43:20.156982 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:43:20.152676 => 13:43:20.156573
[0m13:43:20.157480 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:43:20.176729 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:43:20.180853 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:43:20.181670 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with src_host as (

    select * from AIRBNB.DEV.scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m13:43:20.182141 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:21.538674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:21.543948 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:43:20.157811 => 13:43:21.543576
[0m13:43:21.545022 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:43:21.925458 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280adbe3640>]}
[0m13:43:21.927732 [info ] [Thread-1 (]: 4 of 6 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.77s]
[0m13:43:21.930507 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:43:21.931879 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:43:21.933167 [info ] [Thread-1 (]: 5 of 6 START sql table model DEV.dim_listing ................................... [RUN]
[0m13:43:21.934417 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:43:21.935157 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:43:21.939408 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:43:21.940950 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:43:21.935550 => 13:43:21.940510
[0m13:43:21.941686 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:43:21.947911 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:43:21.951836 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:43:21.952562 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m13:43:21.953177 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:24.464065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m13:43:24.466549 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:43:21.942045 => 13:43:24.466353
[0m13:43:24.467007 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:43:24.659792 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280af4b3700>]}
[0m13:43:24.661227 [info ] [Thread-1 (]: 5 of 6 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 2.73s]
[0m13:43:24.662996 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:43:24.664099 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m13:43:24.664852 [info ] [Thread-1 (]: 6 of 6 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:43:24.665694 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m13:43:24.666166 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m13:43:24.674283 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m13:43:24.684605 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 13:43:24.666440 => 13:43:24.684186
[0m13:43:24.685124 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m13:43:24.714035 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:24.714546 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_review as (

    select * from AIRBNB.DEV.src_reviews
)

select * from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m13:43:24.714917 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:43:25.518994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:43:25.528933 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:25.530119 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:43:25.675390 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:25.684591 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:25.685537 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m13:43:25.838602 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:25.852203 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:25.852659 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:43:26.002968 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:43:26.007374 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:26.007850 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:43:28.663284 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 3.0 seconds
[0m13:43:28.675884 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:43:28.689686 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m13:43:28.690822 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:28.691410 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:43:28.834576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:28.835585 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:28.836225 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m13:43:29.461280 [debug] [Thread-1 (]: SQL status: SUCCESS 58 in 1.0 seconds
[0m13:43:29.463370 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:29.465887 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m13:43:29.803984 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:29.828754 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:43:29.837389 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:43:29.837967 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:43:30.090180 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:43:30.095922 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 13:43:24.685386 => 13:43:30.095392
[0m13:43:30.096840 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m13:43:30.332823 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '053b522d-536b-4fe8-bf6a-11313d25ba21', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280adc471f0>]}
[0m13:43:30.334616 [info ] [Thread-1 (]: 6 of 6 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 58[0m in 5.67s]
[0m13:43:30.335878 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m13:43:30.337944 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:43:30.338489 [debug] [MainThread]: Connection 'model.dbtlearnnew.fct_reviews' was properly closed.
[0m13:43:30.338960 [info ] [MainThread]: 
[0m13:43:30.339408 [info ] [MainThread]: Finished running 3 view models, 2 table models, 1 incremental model in 0 hours 0 minutes and 16.60 seconds (16.60s).
[0m13:43:30.340844 [debug] [MainThread]: Command end result
[0m13:43:30.351845 [info ] [MainThread]: 
[0m13:43:30.352567 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:43:30.353041 [info ] [MainThread]: 
[0m13:43:30.353648 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m13:43:30.358442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 17.256445, "process_user_time": 2.936476, "process_kernel_time": 0.202735, "process_mem_max_rss": "119908", "process_in_blocks": "43416", "process_out_blocks": "1888"}
[0m13:43:30.359078 [debug] [MainThread]: Command `dbt run` succeeded at 13:43:30.358946 after 17.26 seconds
[0m13:43:30.359429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b2d7f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280b02740a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7280aff0fe20>]}
[0m13:43:30.359800 [debug] [MainThread]: Flushing usage events
[0m13:52:00.030640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a8c46f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a8a8fe560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a8a8fe500>]}


============================== 13:52:00.035974 | d026a798-0d60-406f-8e26-2859b3518b58 ==============================
[0m13:52:00.035974 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:52:00.037116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:52:00.574033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd026a798-0d60-406f-8e26-2859b3518b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a8a8fe650>]}
[0m13:52:00.672645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd026a798-0d60-406f-8e26-2859b3518b58', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a899640a0>]}
[0m13:52:00.675022 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:52:00.683155 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:52:00.726802 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m13:52:00.727481 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://models/dim/dim_listings_w_hosts.sql
[0m13:52:00.961049 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbtlearnnew.dim_listings_w_hosts' (models/dim/dim_listings_w_hosts.sql) depends on a node named 'dim_listings_cleansed' which was not found
[0m13:52:00.962060 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9817938, "process_user_time": 3.051148, "process_kernel_time": 0.186391, "process_mem_max_rss": "110296", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m13:52:00.962638 [debug] [MainThread]: Command `dbt run` failed at 13:52:00.962507 after 0.98 seconds
[0m13:52:00.963030 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a8c46f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a899647c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x734a8960cee0>]}
[0m13:52:00.963426 [debug] [MainThread]: Flushing usage events
[0m13:52:40.119778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed578b7ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed57700a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed57700a5c0>]}


============================== 13:52:40.122115 | bd57b6d7-637a-4997-9fe7-113ca9353247 ==============================
[0m13:52:40.122115 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:52:40.122710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:52:40.374379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed57700a710>]}
[0m13:52:40.449568 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575f3fd30>]}
[0m13:52:40.450727 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:52:40.457487 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:52:40.490422 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:52:40.490824 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:52:40.495282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575d580d0>]}
[0m13:52:40.507893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575d20df0>]}
[0m13:52:40.508658 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:52:40.509200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575d20fd0>]}
[0m13:52:40.561733 [info ] [MainThread]: 
[0m13:52:40.562589 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:52:40.563706 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:52:40.578013 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:52:40.578646 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:52:40.578986 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:52:41.250898 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:52:41.255324 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:52:41.445807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:52:41.459932 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:52:41.460422 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:52:41.460768 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:52:42.145501 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 1.0 seconds
[0m13:52:42.150651 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:52:42.337652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575d13730>]}
[0m13:52:42.340239 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:52:42.341402 [info ] [MainThread]: 
[0m13:52:42.345711 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:52:42.347058 [info ] [Thread-1 (]: 1 of 7 START sql view model DEV.scr_hosts ...................................... [RUN]
[0m13:52:42.349374 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:52:42.350990 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:52:42.363631 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:52:42.367435 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:52:42.352240 => 13:52:42.366863
[0m13:52:42.368506 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.scr_hosts
[0m13:52:42.393454 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.scr_hosts"
[0m13:52:42.394481 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.scr_hosts"
[0m13:52:42.394863 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.scr_hosts"} */
create or replace   view AIRBNB.DEV.scr_hosts
  
   as (
    WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
  );
[0m13:52:42.395195 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:43.009463 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:43.035999 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (execute): 13:52:42.369119 => 13:52:43.035789
[0m13:52:43.036584 [debug] [Thread-1 (]: On model.dbtlearnnew.scr_hosts: Close
[0m13:52:43.215562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575d136d0>]}
[0m13:52:43.217991 [info ] [Thread-1 (]: 1 of 7 OK created sql view model DEV.scr_hosts ................................. [[32mSUCCESS 1[0m in 0.87s]
[0m13:52:43.220063 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:52:43.221432 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:52:43.222997 [info ] [Thread-1 (]: 2 of 7 START sql view model DEV.src_listing .................................... [RUN]
[0m13:52:43.224764 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:52:43.225742 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:52:43.228782 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:52:43.230041 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:52:43.226286 => 13:52:43.229593
[0m13:52:43.230565 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_listing
[0m13:52:43.234724 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_listing"
[0m13:52:43.237463 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_listing"
[0m13:52:43.238016 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_listing"} */
create or replace   view AIRBNB.DEV.src_listing
  
   as (
    WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
  );
[0m13:52:43.238409 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:44.055866 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:44.062855 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (execute): 13:52:43.230807 => 13:52:44.062341
[0m13:52:44.063700 [debug] [Thread-1 (]: On model.dbtlearnnew.src_listing: Close
[0m13:52:44.277701 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed5741a4c40>]}
[0m13:52:44.279943 [info ] [Thread-1 (]: 2 of 7 OK created sql view model DEV.src_listing ............................... [[32mSUCCESS 1[0m in 1.05s]
[0m13:52:44.282766 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:52:44.284717 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:52:44.288024 [info ] [Thread-1 (]: 3 of 7 START sql view model DEV.src_reviews .................................... [RUN]
[0m13:52:44.290193 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:52:44.291473 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:52:44.296976 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:52:44.303562 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:52:44.292518 => 13:52:44.301923
[0m13:52:44.304989 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.src_reviews
[0m13:52:44.310515 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.src_reviews"
[0m13:52:44.311768 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.src_reviews"
[0m13:52:44.312296 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.src_reviews"} */
create or replace   view AIRBNB.DEV.src_reviews
  
   as (
    WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
  );
[0m13:52:44.312765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:45.124968 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:45.132472 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (execute): 13:52:44.305523 => 13:52:45.131551
[0m13:52:45.134600 [debug] [Thread-1 (]: On model.dbtlearnnew.src_reviews: Close
[0m13:52:45.410883 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed5741e3c10>]}
[0m13:52:45.412664 [info ] [Thread-1 (]: 3 of 7 OK created sql view model DEV.src_reviews ............................... [[32mSUCCESS 1[0m in 1.12s]
[0m13:52:45.414535 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:52:45.416051 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:52:45.418698 [info ] [Thread-1 (]: 4 of 7 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m13:52:45.421169 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:52:45.422403 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:52:45.428146 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:52:45.431756 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:52:45.422932 => 13:52:45.431306
[0m13:52:45.432669 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:52:45.453586 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:52:45.456716 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:52:45.457237 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with src_host as (

    select * from AIRBNB.DEV.scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m13:52:45.457623 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:46.522702 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:46.529841 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:52:45.433159 => 13:52:46.529217
[0m13:52:46.531161 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:52:46.705423 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed5741e1d50>]}
[0m13:52:46.707278 [info ] [Thread-1 (]: 4 of 7 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.29s]
[0m13:52:46.709198 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:52:46.710513 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:52:46.712052 [info ] [Thread-1 (]: 5 of 7 START sql table model DEV.dim_listing ................................... [RUN]
[0m13:52:46.713969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:52:46.715129 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:52:46.723393 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:52:46.725249 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:52:46.716349 => 13:52:46.724673
[0m13:52:46.725930 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:52:46.729982 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:52:46.734721 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:52:46.735924 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with src_listings as (

    select * from AIRBNB.DEV.src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m13:52:46.736534 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:47.893439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:47.920776 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:52:46.726290 => 13:52:47.920182
[0m13:52:47.925750 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:52:48.117049 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed5741e0790>]}
[0m13:52:48.119797 [info ] [Thread-1 (]: 5 of 7 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 1.40s]
[0m13:52:48.122688 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:52:48.124183 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m13:52:48.126338 [info ] [Thread-1 (]: 6 of 7 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:52:48.128435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m13:52:48.129812 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m13:52:48.161478 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m13:52:48.163977 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 13:52:48.130534 => 13:52:48.163255
[0m13:52:48.165206 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m13:52:48.202912 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:48.203535 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with src_review as (

    select * from AIRBNB.DEV.src_reviews
)

select * from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m13:52:48.203996 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:49.070461 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:49.088947 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:49.090787 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:52:49.222900 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:52:49.228809 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:49.229462 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m13:52:49.344638 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:52:49.363318 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:49.363919 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:52:49.480453 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:52:49.490226 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:49.492007 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:52:49.606685 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:52:49.628690 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:52:49.657601 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m13:52:49.660047 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:49.660918 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:52:49.789418 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:52:49.791666 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:49.793475 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m13:52:50.402827 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:52:50.405202 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:50.406560 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m13:52:50.649419 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:52:50.682087 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:52:50.693529 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:52:50.694109 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:52:50.834538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:52:50.841014 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 13:52:48.166270 => 13:52:50.840581
[0m13:52:50.841878 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m13:52:51.042158 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed5742133a0>]}
[0m13:52:51.043741 [info ] [Thread-1 (]: 6 of 7 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.91s]
[0m13:52:51.044623 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m13:52:51.046080 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m13:52:51.047152 [info ] [Thread-1 (]: 7 of 7 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m13:52:51.048804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m13:52:51.049973 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m13:52:51.055908 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m13:52:51.058835 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 13:52:51.050378 => 13:52:51.057645
[0m13:52:51.060335 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m13:52:51.065431 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m13:52:51.067181 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m13:52:51.070530 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m13:52:51.072116 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:52:52.592956 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m13:52:52.600477 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 13:52:51.061057 => 13:52:52.599761
[0m13:52:52.603004 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m13:52:52.860083 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bd57b6d7-637a-4997-9fe7-113ca9353247', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed57421f160>]}
[0m13:52:52.862710 [info ] [Thread-1 (]: 7 of 7 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.81s]
[0m13:52:52.865318 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m13:52:52.871537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:52:52.873476 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listings_w_hosts' was properly closed.
[0m13:52:52.875786 [info ] [MainThread]: 
[0m13:52:52.877296 [info ] [MainThread]: Finished running 3 view models, 3 table models, 1 incremental model in 0 hours 0 minutes and 12.31 seconds (12.31s).
[0m13:52:52.881413 [debug] [MainThread]: Command end result
[0m13:52:52.901690 [info ] [MainThread]: 
[0m13:52:52.902377 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:52:52.903324 [info ] [MainThread]: 
[0m13:52:52.904130 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m13:52:52.906094 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.8206835, "process_user_time": 3.104134, "process_kernel_time": 0.179084, "process_mem_max_rss": "120224", "process_out_blocks": "1920", "process_in_blocks": "0"}
[0m13:52:52.907152 [debug] [MainThread]: Command `dbt run` succeeded at 13:52:52.906926 after 12.82 seconds
[0m13:52:52.907604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed578b7ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575f3fd30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed575d131c0>]}
[0m13:52:52.908041 [debug] [MainThread]: Flushing usage events
[0m13:54:13.482166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d617b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d460a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d460a560>]}


============================== 13:54:13.485561 | 0b51e4d1-0d60-43af-a8a3-1de8fd60fa16 ==============================
[0m13:54:13.485561 [info ] [MainThread]: Running with dbt=1.7.10
[0m13:54:13.486637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:54:13.782187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d3587d60>]}
[0m13:54:13.868923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d45bdf30>]}
[0m13:54:13.870089 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m13:54:13.877516 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m13:54:13.915321 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:54:13.916036 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:54:13.921974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d33540d0>]}
[0m13:54:13.933346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d331cd90>]}
[0m13:54:13.935039 [info ] [MainThread]: Found 7 models, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m13:54:13.936008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d331cf70>]}
[0m13:54:14.011837 [info ] [MainThread]: 
[0m13:54:14.013052 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:54:14.014330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m13:54:14.031425 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m13:54:14.031898 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m13:54:14.032250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:54:14.753232 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m13:54:14.761396 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m13:54:14.953337 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m13:54:14.981662 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m13:54:14.983161 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m13:54:14.983902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:54:17.748066 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 3.0 seconds
[0m13:54:17.753681 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m13:54:17.937591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d3313520>]}
[0m13:54:17.940493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m13:54:17.941683 [info ] [MainThread]: 
[0m13:54:17.947119 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m13:54:17.948857 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m13:54:17.949975 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m13:54:17.971175 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m13:54:17.974979 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 13:54:17.950754 => 13:54:17.974071
[0m13:54:17.977908 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m13:54:17.979804 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m13:54:17.982479 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m13:54:17.984456 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m13:54:17.987603 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m13:54:17.988812 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 13:54:17.985057 => 13:54:17.988357
[0m13:54:17.989967 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m13:54:17.990488 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m13:54:17.991402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m13:54:17.992290 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m13:54:17.995414 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m13:54:17.996496 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 13:54:17.992597 => 13:54:17.996151
[0m13:54:17.997663 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m13:54:17.998051 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m13:54:17.998556 [info ] [Thread-1 (]: 1 of 4 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m13:54:17.999125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m13:54:17.999437 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m13:54:18.005293 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m13:54:18.008348 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 13:54:17.999691 => 13:54:18.007647
[0m13:54:18.009106 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m13:54:18.040914 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m13:54:18.043375 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m13:54:18.044830 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m13:54:18.045877 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:19.199670 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:54:19.255849 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 13:54:18.009487 => 13:54:19.255604
[0m13:54:19.256470 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m13:54:19.475819 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d3348760>]}
[0m13:54:19.480144 [info ] [Thread-1 (]: 1 of 4 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.48s]
[0m13:54:19.483207 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m13:54:19.485526 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m13:54:19.488109 [info ] [Thread-1 (]: 2 of 4 START sql table model DEV.dim_listing ................................... [RUN]
[0m13:54:19.493415 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m13:54:19.496340 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m13:54:19.508869 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m13:54:19.513842 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 13:54:19.497420 => 13:54:19.512534
[0m13:54:19.514904 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m13:54:19.519697 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m13:54:19.521261 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m13:54:19.521820 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m13:54:19.522301 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:20.723363 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:54:20.735618 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 13:54:19.515512 => 13:54:20.733025
[0m13:54:20.737730 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m13:54:20.950506 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d0fdb820>]}
[0m13:54:20.954157 [info ] [Thread-1 (]: 2 of 4 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 1.46s]
[0m13:54:20.956326 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m13:54:20.957852 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m13:54:20.960015 [info ] [Thread-1 (]: 3 of 4 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m13:54:20.962629 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m13:54:20.963781 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m13:54:20.983162 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m13:54:20.987669 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 13:54:20.964733 => 13:54:20.986936
[0m13:54:20.988349 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m13:54:21.026831 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:21.027560 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m13:54:21.028053 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:21.945718 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:54:21.976367 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:21.978379 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:54:22.116285 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:54:22.127900 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:22.128875 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m13:54:22.250059 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:54:22.290794 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:22.292279 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:54:22.408002 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:54:22.422598 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:22.425717 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m13:54:22.540848 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m13:54:22.580014 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m13:54:22.598145 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m13:54:22.599910 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:22.600923 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m13:54:22.730388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:54:22.732725 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:22.735022 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m13:54:23.243009 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:54:23.245125 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:23.247042 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m13:54:23.498348 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:54:23.522699 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m13:54:23.533670 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m13:54:23.534830 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m13:54:23.663476 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m13:54:23.673931 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 13:54:20.988667 => 13:54:23.673036
[0m13:54:23.675874 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m13:54:23.860976 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d0fdb9d0>]}
[0m13:54:23.863628 [info ] [Thread-1 (]: 3 of 4 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.90s]
[0m13:54:23.865360 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m13:54:23.866523 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m13:54:23.869049 [info ] [Thread-1 (]: 4 of 4 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m13:54:23.872472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m13:54:23.875062 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m13:54:23.886388 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m13:54:23.888967 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 13:54:23.876332 => 13:54:23.888300
[0m13:54:23.890680 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m13:54:23.897590 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m13:54:23.900460 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m13:54:23.901330 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m13:54:23.902128 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:54:25.210912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m13:54:25.222514 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 13:54:23.891495 => 13:54:25.221594
[0m13:54:25.224402 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m13:54:25.405020 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0b51e4d1-0d60-43af-a8a3-1de8fd60fa16', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d0fdbca0>]}
[0m13:54:25.406324 [info ] [Thread-1 (]: 4 of 4 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.53s]
[0m13:54:25.407692 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m13:54:25.411098 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:54:25.411778 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listings_w_hosts' was properly closed.
[0m13:54:25.412388 [info ] [MainThread]: 
[0m13:54:25.413007 [info ] [MainThread]: Finished running 3 table models, 1 incremental model in 0 hours 0 minutes and 11.40 seconds (11.40s).
[0m13:54:25.414460 [debug] [MainThread]: Command end result
[0m13:54:25.428890 [info ] [MainThread]: 
[0m13:54:25.430019 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:54:25.430521 [info ] [MainThread]: 
[0m13:54:25.431923 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m13:54:25.433502 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.995631, "process_user_time": 3.442758, "process_kernel_time": 0.181066, "process_mem_max_rss": "119880", "process_out_blocks": "1904", "process_in_blocks": "0"}
[0m13:54:25.434271 [debug] [MainThread]: Command `dbt run` succeeded at 13:54:25.434088 after 12.00 seconds
[0m13:54:25.434781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d617b820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d45bdf30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7409d331c3a0>]}
[0m13:54:25.435496 [debug] [MainThread]: Flushing usage events
[0m14:27:15.305518 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e931a7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e9163e590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e9163e530>]}


============================== 14:27:15.308183 | f436b121-f76f-4571-915e-5437aff619ed ==============================
[0m14:27:15.308183 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:27:15.308751 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:27:15.567876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e9063bd30>]}
[0m14:27:15.641617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e905240d0>]}
[0m14:27:15.642464 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:27:15.648394 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:27:15.677010 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m14:27:15.677632 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://seeds/seed_full_moon_dates.csv
[0m14:27:15.824383 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e902d00d0>]}
[0m14:27:15.837271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e903bbf10>]}
[0m14:27:15.838059 [info ] [MainThread]: Found 7 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:27:15.838699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e906ef970>]}
[0m14:27:15.840660 [info ] [MainThread]: 
[0m14:27:15.841739 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:15.843001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:27:15.854201 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:27:15.854625 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:27:15.854919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:16.499892 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:27:16.503696 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:27:16.677095 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m14:27:16.689280 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:27:16.689789 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:27:16.690113 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:27:17.511396 [debug] [ThreadPool]: SQL status: SUCCESS 7 in 1.0 seconds
[0m14:27:17.515695 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:27:17.998537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e90102d40>]}
[0m14:27:18.001394 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:27:18.003028 [info ] [MainThread]: 
[0m14:27:18.005892 [debug] [Thread-1 (]: Began running node seed.dbtlearnnew.seed_full_moon_dates
[0m14:27:18.006714 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m14:27:18.008163 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now seed.dbtlearnnew.seed_full_moon_dates)
[0m14:27:18.008802 [debug] [Thread-1 (]: Began compiling node seed.dbtlearnnew.seed_full_moon_dates
[0m14:27:18.009378 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (compile): 14:27:18.009160 => 14:27:18.009163
[0m14:27:18.009704 [debug] [Thread-1 (]: Began executing node seed.dbtlearnnew.seed_full_moon_dates
[0m14:27:18.041293 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:27:18.041856 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
create table AIRBNB.DEV.seed_full_moon_dates (full_moon_date date)
[0m14:27:18.042249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:27:18.827253 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:27:18.849666 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:27:18.850203 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
BEGIN
[0m14:27:18.976216 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:27:18.981878 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:27:18.982952 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(...
[0m14:27:19.698010 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.0 seconds
[0m14:27:19.699723 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:27:19.701556 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
COMMIT
[0m14:27:20.010100 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:27:20.021437 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:27:20.049505 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (execute): 14:27:18.009896 => 14:27:20.049277
[0m14:27:20.049968 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: Close
[0m14:27:20.343725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f436b121-f76f-4571-915e-5437aff619ed', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e90088700>]}
[0m14:27:20.345507 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 2.34s]
[0m14:27:20.347352 [debug] [Thread-1 (]: Finished running node seed.dbtlearnnew.seed_full_moon_dates
[0m14:27:20.350357 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:20.351120 [debug] [MainThread]: Connection 'seed.dbtlearnnew.seed_full_moon_dates' was properly closed.
[0m14:27:20.351838 [info ] [MainThread]: 
[0m14:27:20.352596 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.51 seconds (4.51s).
[0m14:27:20.354036 [debug] [MainThread]: Command end result
[0m14:27:20.365254 [info ] [MainThread]: 
[0m14:27:20.366006 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:27:20.366554 [info ] [MainThread]: 
[0m14:27:20.367014 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:27:20.367723 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.0970726, "process_user_time": 2.330835, "process_kernel_time": 0.146286, "process_mem_max_rss": "120468", "process_in_blocks": "24", "process_out_blocks": "2640"}
[0m14:27:20.368258 [debug] [MainThread]: Command `dbt seed` succeeded at 14:27:20.368136 after 5.10 seconds
[0m14:27:20.368610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e931a7850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e9163e710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x718e906edd50>]}
[0m14:27:20.368960 [debug] [MainThread]: Flushing usage events
[0m14:30:34.094293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d3f877f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d241e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d241e590>]}


============================== 14:30:34.096557 | 0c7002cf-ecd9-42d6-85b1-c19384bbd081 ==============================
[0m14:30:34.096557 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:30:34.097086 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt seed', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:30:34.322205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d139bd60>]}
[0m14:30:34.391036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d23d5f60>]}
[0m14:30:34.391783 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:30:34.397752 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:30:34.425133 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:34.425538 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:34.429895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d11700d0>]}
[0m14:30:34.478500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d1370160>]}
[0m14:30:34.479050 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:30:34.479425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d1370340>]}
[0m14:30:34.480695 [info ] [MainThread]: 
[0m14:30:34.481398 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:30:34.482259 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:30:34.493860 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:30:34.494313 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:30:34.494636 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:35.301876 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:30:35.305770 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:30:35.484812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m14:30:35.502860 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:30:35.503442 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:30:35.503906 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:36.126500 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:30:36.130928 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:30:36.344609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d112beb0>]}
[0m14:30:36.346707 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:36.347754 [info ] [MainThread]: 
[0m14:30:36.352219 [debug] [Thread-1 (]: Began running node seed.dbtlearnnew.seed_full_moon_dates
[0m14:30:36.353612 [info ] [Thread-1 (]: 1 of 1 START seed file DEV.seed_full_moon_dates ................................ [RUN]
[0m14:30:36.355254 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now seed.dbtlearnnew.seed_full_moon_dates)
[0m14:30:36.356253 [debug] [Thread-1 (]: Began compiling node seed.dbtlearnnew.seed_full_moon_dates
[0m14:30:36.357153 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (compile): 14:30:36.356734 => 14:30:36.356738
[0m14:30:36.357850 [debug] [Thread-1 (]: Began executing node seed.dbtlearnnew.seed_full_moon_dates
[0m14:30:36.392594 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:36.393095 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
BEGIN
[0m14:30:36.393461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:37.234575 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:37.236056 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:37.237469 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
truncate table "AIRBNB"."DEV"."SEED_FULL_MOON_DATES"
  ;
[0m14:30:37.583190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:37.583848 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:37.584191 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
COMMIT
[0m14:30:37.919523 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:37.943973 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:37.944433 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
BEGIN
[0m14:30:38.073912 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:38.079623 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:38.080888 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
insert into AIRBNB.DEV.seed_full_moon_dates (full_moon_date) values
            (%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(%s),(...
[0m14:30:38.679224 [debug] [Thread-1 (]: SQL status: SUCCESS 272 in 1.0 seconds
[0m14:30:38.680832 [debug] [Thread-1 (]: Using snowflake connection "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:38.682068 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "seed.dbtlearnnew.seed_full_moon_dates"} */
COMMIT
[0m14:30:38.913027 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:38.927354 [debug] [Thread-1 (]: Writing runtime SQL for node "seed.dbtlearnnew.seed_full_moon_dates"
[0m14:30:38.943564 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (execute): 14:30:36.358340 => 14:30:38.943367
[0m14:30:38.944005 [debug] [Thread-1 (]: On seed.dbtlearnnew.seed_full_moon_dates: Close
[0m14:30:39.131772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0c7002cf-ecd9-42d6-85b1-c19384bbd081', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d05bc0d0>]}
[0m14:30:39.133424 [info ] [Thread-1 (]: 1 of 1 OK loaded seed file DEV.seed_full_moon_dates ............................ [[32mINSERT 272[0m in 2.78s]
[0m14:30:39.135122 [debug] [Thread-1 (]: Finished running node seed.dbtlearnnew.seed_full_moon_dates
[0m14:30:39.138660 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:30:39.139599 [debug] [MainThread]: Connection 'seed.dbtlearnnew.seed_full_moon_dates' was properly closed.
[0m14:30:39.140588 [info ] [MainThread]: 
[0m14:30:39.141412 [info ] [MainThread]: Finished running 1 seed in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m14:30:39.142740 [debug] [MainThread]: Command end result
[0m14:30:39.151857 [info ] [MainThread]: 
[0m14:30:39.152647 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:30:39.153226 [info ] [MainThread]: 
[0m14:30:39.153724 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m14:30:39.154615 [debug] [MainThread]: Resource report: {"command_name": "seed", "command_success": true, "command_wall_clock_time": 5.092779, "process_user_time": 2.130266, "process_kernel_time": 0.126943, "process_mem_max_rss": "118872", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m14:30:39.155219 [debug] [MainThread]: Command `dbt seed` succeeded at 14:30:39.155050 after 5.09 seconds
[0m14:30:39.155600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d3f877f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d15eee30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7007d23d5f60>]}
[0m14:30:39.155973 [debug] [MainThread]: Flushing usage events
[0m14:30:45.066345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb3f9b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb242a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb242a590>]}


============================== 14:30:45.072539 | 2307b074-c7b0-4be7-96c4-946a075e091f ==============================
[0m14:30:45.072539 [info ] [MainThread]: Running with dbt=1.7.10
[0m14:30:45.073232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:30:45.403695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb142fd60>]}
[0m14:30:45.484584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb23e9f60>]}
[0m14:30:45.485595 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m14:30:45.493842 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m14:30:45.525472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:30:45.526209 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:30:45.532869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb11f80d0>]}
[0m14:30:45.601978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb120c160>]}
[0m14:30:45.602683 [info ] [MainThread]: Found 8 models, 1 seed, 0 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m14:30:45.603194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb120c340>]}
[0m14:30:45.606264 [info ] [MainThread]: 
[0m14:30:45.607726 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:30:45.609797 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m14:30:45.626536 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m14:30:45.627465 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m14:30:45.628020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:30:46.229592 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m14:30:46.235083 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m14:30:49.922077 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m14:30:49.931686 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m14:30:49.932174 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m14:30:49.932598 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:30:50.551449 [debug] [ThreadPool]: SQL status: SUCCESS 8 in 1.0 seconds
[0m14:30:50.555476 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m14:30:50.743494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb11b2aa0>]}
[0m14:30:50.744662 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m14:30:50.745273 [info ] [MainThread]: 
[0m14:30:50.747320 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m14:30:50.748058 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m14:30:50.748464 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m14:30:50.754564 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m14:30:50.755416 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 14:30:50.748696 => 14:30:50.755174
[0m14:30:50.756308 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m14:30:50.756767 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m14:30:50.757554 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m14:30:50.758365 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m14:30:50.760102 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m14:30:50.763869 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 14:30:50.758687 => 14:30:50.762550
[0m14:30:50.764781 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m14:30:50.765232 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m14:30:50.765926 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m14:30:50.766427 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m14:30:50.767940 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m14:30:50.770165 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 14:30:50.766677 => 14:30:50.769848
[0m14:30:50.771063 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m14:30:50.771531 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m14:30:50.772167 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m14:30:50.773111 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m14:30:50.773591 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m14:30:50.778607 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m14:30:50.779495 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 14:30:50.773849 => 14:30:50.779227
[0m14:30:50.779873 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m14:30:50.809897 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m14:30:50.812948 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m14:30:50.813457 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
            AIRBNB.RAW.RAW_HOSTS
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m14:30:50.813856 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:52.532532 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:30:52.561829 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 14:30:50.780080 => 14:30:52.561620
[0m14:30:52.562470 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m14:30:52.733915 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb0756590>]}
[0m14:30:52.736045 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.96s]
[0m14:30:52.737862 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m14:30:52.739082 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m14:30:52.740482 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m14:30:52.743526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m14:30:52.744771 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m14:30:52.754977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m14:30:52.755972 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 14:30:52.745484 => 14:30:52.755621
[0m14:30:52.756597 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m14:30:52.760775 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m14:30:52.762141 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m14:30:52.762559 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_LISTINGS
)
SELECT
id AS listing_id,
name AS listing_name,
listing_url,
room_type,
minimum_nights,
host_id,
price AS price_str,
created_at,
updated_at
FROM
raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m14:30:52.762923 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:54.528734 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m14:30:54.535023 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 14:30:52.756910 => 14:30:54.534561
[0m14:30:54.535896 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m14:30:54.830199 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb061ce80>]}
[0m14:30:54.831928 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 2.09s]
[0m14:30:54.834042 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m14:30:54.835433 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m14:30:54.836767 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m14:30:54.838381 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m14:30:54.839238 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m14:30:54.850270 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m14:30:54.851224 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 14:30:54.839615 => 14:30:54.850879
[0m14:30:54.851820 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m14:30:54.884617 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:54.885106 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.RAW.RAW_REVIEWS
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m14:30:54.885457 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:55.520618 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:55.536792 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:55.537342 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m14:30:55.674589 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:30:55.684979 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:55.685926 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m14:30:55.793971 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:30:55.806708 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:55.807334 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m14:30:55.925789 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:30:55.933402 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:55.934136 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m14:30:56.037794 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m14:30:56.056897 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m14:30:56.075298 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m14:30:56.077022 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:56.077622 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m14:30:56.306210 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:56.308044 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:56.310803 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m14:30:56.734425 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:56.735927 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:56.737057 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m14:30:57.191357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:57.206867 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m14:30:57.213392 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m14:30:57.213864 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m14:30:57.459849 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m14:30:57.466749 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 14:30:54.852118 => 14:30:57.466206
[0m14:30:57.467888 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m14:30:57.654193 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb061f8b0>]}
[0m14:30:57.656037 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 2.82s]
[0m14:30:57.657835 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m14:30:57.659244 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m14:30:57.661109 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m14:30:57.662383 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m14:30:57.663148 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m14:30:57.668750 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m14:30:57.670512 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 14:30:57.663584 => 14:30:57.670059
[0m14:30:57.671099 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m14:30:57.675143 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m14:30:57.678335 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m14:30:57.678767 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m14:30:57.679100 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:30:59.006439 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m14:30:59.016318 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 14:30:57.671455 => 14:30:59.015830
[0m14:30:59.017247 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m14:30:59.246601 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb11b2a10>]}
[0m14:30:59.248230 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.58s]
[0m14:30:59.249660 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m14:30:59.250501 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m14:30:59.251455 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_full_moon ................................ [RUN]
[0m14:30:59.252551 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now model.dbtlearnnew.mart_full_moon)
[0m14:30:59.253201 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m14:30:59.257709 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m14:30:59.259649 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 14:30:59.253574 => 14:30:59.259031
[0m14:30:59.260502 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m14:30:59.264042 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.mart_full_moon"
[0m14:30:59.265893 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.mart_full_moon"
[0m14:30:59.266491 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.mart_full_moon"} */
create or replace transient table AIRBNB.DEV.mart_full_moon
         as
        (
WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)
SELECT
    r.*,CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
r
LEFT JOIN full_moon_dates
fm
ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m14:30:59.266878 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:31:03.456508 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m14:31:03.465037 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 14:30:59.261045 => 14:31:03.464508
[0m14:31:03.466243 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: Close
[0m14:31:03.652832 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2307b074-c7b0-4be7-96c4-946a075e091f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb0530340>]}
[0m14:31:03.654664 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_full_moon ........................... [[32mSUCCESS 1[0m in 4.40s]
[0m14:31:03.656538 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m14:31:03.660373 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:31:03.661442 [debug] [MainThread]: Connection 'model.dbtlearnnew.mart_full_moon' was properly closed.
[0m14:31:03.662224 [info ] [MainThread]: 
[0m14:31:03.662973 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 18.06 seconds (18.06s).
[0m14:31:03.664984 [debug] [MainThread]: Command end result
[0m14:31:03.677353 [info ] [MainThread]: 
[0m14:31:03.678021 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:31:03.678475 [info ] [MainThread]: 
[0m14:31:03.678957 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m14:31:03.679941 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 18.658571, "process_user_time": 2.730488, "process_kernel_time": 0.18096, "process_mem_max_rss": "120284", "process_out_blocks": "1928", "process_in_blocks": "0"}
[0m14:31:03.680634 [debug] [MainThread]: Command `dbt run` succeeded at 14:31:03.680467 after 18.66 seconds
[0m14:31:03.680990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb3f9b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb14e1ba0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7a1fb11b2a10>]}
[0m14:31:03.681347 [debug] [MainThread]: Flushing usage events
[0m17:19:17.329935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a557f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a3a0a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a3a0a4d0>]}


============================== 17:19:17.336624 | b635b233-c1be-46c0-9fe6-f88fc0f1b0be ==============================
[0m17:19:17.336624 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:19:17.337181 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:19:18.623328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a2989ed0>]}
[0m17:19:18.691074 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a2a76350>]}
[0m17:19:18.693033 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:19:18.698895 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:19:18.727055 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:19:18.727472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:19:18.732465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a276c0d0>]}
[0m17:19:18.791961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a29ca6e0>]}
[0m17:19:18.792554 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:19:18.792979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a296f8b0>]}
[0m17:19:18.794361 [info ] [MainThread]: 
[0m17:19:18.795096 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:19:18.796141 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m17:19:18.808244 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m17:19:18.808722 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m17:19:18.809129 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:19:19.753988 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m17:19:19.757910 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m17:19:19.936099 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m17:19:19.954059 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:19:19.954648 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:19:19.955100 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:19:20.842881 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m17:19:20.845587 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:19:21.052939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a25bffd0>]}
[0m17:19:21.055097 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:19:21.056242 [info ] [MainThread]: 
[0m17:19:21.066350 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m17:19:21.068563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m17:19:21.069565 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m17:19:21.079348 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m17:19:21.081552 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 17:19:21.070072 => 17:19:21.081236
[0m17:19:21.082473 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m17:19:21.083023 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m17:19:21.083762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m17:19:21.084095 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m17:19:21.087212 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m17:19:21.089643 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 17:19:21.084299 => 17:19:21.089288
[0m17:19:21.090540 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m17:19:21.090967 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m17:19:21.091665 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m17:19:21.092199 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m17:19:21.094754 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m17:19:21.097011 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 17:19:21.092501 => 17:19:21.096630
[0m17:19:21.098279 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m17:19:21.098803 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m17:19:21.099299 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m17:19:21.099940 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m17:19:21.100275 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m17:19:21.103876 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m17:19:21.106184 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 17:19:21.100473 => 17:19:21.105852
[0m17:19:21.106604 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m17:19:21.129478 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m17:19:21.132212 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m17:19:21.132650 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
          AIRBNB.raw.raw_hosts
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m17:19:21.132991 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:23.602111 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:19:23.630557 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 17:19:21.106827 => 17:19:23.630355
[0m17:19:23.631013 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m17:19:23.805459 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a25b0280>]}
[0m17:19:23.807307 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 2.71s]
[0m17:19:23.809207 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m17:19:23.810599 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m17:19:23.812100 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m17:19:23.814035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m17:19:23.815170 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m17:19:23.824164 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m17:19:23.826979 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 17:19:23.815891 => 17:19:23.826674
[0m17:19:23.827388 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m17:19:23.830501 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m17:19:23.833272 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m17:19:23.833757 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m17:19:23.834159 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:26.296972 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m17:19:26.301162 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 17:19:23.827636 => 17:19:26.300963
[0m17:19:26.301575 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m17:19:26.494876 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a25b0280>]}
[0m17:19:26.496865 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 2.68s]
[0m17:19:26.498736 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m17:19:26.500107 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m17:19:26.501638 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m17:19:26.503634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m17:19:26.504853 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m17:19:26.517698 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m17:19:26.520542 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 17:19:26.505644 => 17:19:26.520211
[0m17:19:26.520978 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m17:19:26.549966 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:26.550469 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m17:19:26.550844 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:27.257820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:19:27.275912 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:27.276655 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:19:27.399678 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m17:19:27.408521 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:27.409774 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m17:19:33.167425 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 6.0 seconds
[0m17:19:33.178406 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:33.178934 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:19:33.290618 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m17:19:33.299169 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:33.300486 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m17:19:33.441949 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.0 seconds
[0m17:19:33.456830 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:19:33.468530 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m17:19:33.471189 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:33.471629 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m17:19:33.609320 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:19:33.611434 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:33.613337 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m17:19:34.118312 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:19:34.119798 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:34.121018 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m17:19:34.413576 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:19:34.431718 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m17:19:34.437146 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m17:19:34.437528 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m17:19:34.572276 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m17:19:34.581721 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 17:19:26.521267 => 17:19:34.580828
[0m17:19:34.582966 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m17:19:34.789295 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a03fd4b0>]}
[0m17:19:34.791303 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 8.29s]
[0m17:19:34.793141 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m17:19:34.794521 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m17:19:34.796073 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m17:19:34.798110 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m17:19:34.799261 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m17:19:34.805243 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m17:19:34.808604 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 17:19:34.799951 => 17:19:34.808202
[0m17:19:34.809138 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m17:19:34.812105 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m17:19:34.814627 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m17:19:34.815040 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m17:19:34.815386 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:37.773187 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m17:19:37.777483 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 17:19:34.809436 => 17:19:37.777293
[0m17:19:37.777918 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m17:19:37.964544 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a26749d0>]}
[0m17:19:37.966435 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 3.17s]
[0m17:19:37.968310 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m17:19:37.969641 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m17:19:37.970904 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_full_moon ................................ [RUN]
[0m17:19:37.972888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now model.dbtlearnnew.mart_full_moon)
[0m17:19:37.974029 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m17:19:37.981182 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m17:19:37.984212 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 17:19:37.974688 => 17:19:37.983863
[0m17:19:37.984689 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m17:19:37.987238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.mart_full_moon"
[0m17:19:37.990493 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.mart_full_moon"
[0m17:19:37.991170 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.mart_full_moon"} */
create or replace transient table AIRBNB.DEV.mart_full_moon
         as
        (
WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)
SELECT
    r.*,CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
r
LEFT JOIN full_moon_dates
fm
ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m17:19:37.991589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:19:41.826599 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m17:19:41.833626 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 17:19:37.984936 => 17:19:41.832985
[0m17:19:41.834959 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: Close
[0m17:19:41.999374 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b635b233-c1be-46c0-9fe6-f88fc0f1b0be', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a02bdae0>]}
[0m17:19:42.001188 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_full_moon ........................... [[32mSUCCESS 1[0m in 4.03s]
[0m17:19:42.002964 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m17:19:42.006520 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:42.007535 [debug] [MainThread]: Connection 'model.dbtlearnnew.mart_full_moon' was properly closed.
[0m17:19:42.008591 [info ] [MainThread]: 
[0m17:19:42.009664 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 23.21 seconds (23.21s).
[0m17:19:42.012244 [debug] [MainThread]: Command end result
[0m17:19:42.025943 [info ] [MainThread]: 
[0m17:19:42.026431 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:19:42.026764 [info ] [MainThread]: 
[0m17:19:42.027090 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:19:42.030624 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.751163, "process_user_time": 2.860682, "process_kernel_time": 0.180548, "process_mem_max_rss": "120380", "process_out_blocks": "1984", "process_in_blocks": "0"}
[0m17:19:42.031291 [debug] [MainThread]: Command `dbt run` succeeded at 17:19:42.031159 after 24.75 seconds
[0m17:19:42.031642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a557f8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a296eec0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7ed6a2a76350>]}
[0m17:19:42.032019 [debug] [MainThread]: Flushing usage events
[0m17:20:03.890682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535fca6f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535faefe5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535faefe560>]}


============================== 17:20:03.892903 | 50f81196-b967-4803-b623-958037e5b4e1 ==============================
[0m17:20:03.892903 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:20:03.893487 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt compile', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m17:20:04.140498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '50f81196-b967-4803-b623-958037e5b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535fa0ffd60>]}
[0m17:20:04.222557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '50f81196-b967-4803-b623-958037e5b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535faebdf30>]}
[0m17:20:04.223337 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:20:04.230447 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:20:04.261346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:20:04.261768 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:20:04.266531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '50f81196-b967-4803-b623-958037e5b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f9c5c100>]}
[0m17:20:04.330534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '50f81196-b967-4803-b623-958037e5b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f9e5f6d0>]}
[0m17:20:04.331545 [info ] [MainThread]: Found 8 models, 1 seed, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:20:04.332197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f81196-b967-4803-b623-958037e5b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f9e5d2d0>]}
[0m17:20:04.334404 [info ] [MainThread]: 
[0m17:20:04.335472 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:20:04.336638 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:20:04.351629 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:20:04.352087 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:20:04.352553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:20:05.304396 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m17:20:05.310499 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:20:05.508049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '50f81196-b967-4803-b623-958037e5b4e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535f9cd59c0>]}
[0m17:20:05.510331 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:20:05.511460 [info ] [MainThread]: 
[0m17:20:05.516752 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m17:20:05.518745 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m17:20:05.519917 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m17:20:05.536520 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m17:20:05.537676 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 17:20:05.520608 => 17:20:05.537307
[0m17:20:05.538810 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m17:20:05.539554 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m17:20:05.540230 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m17:20:05.541144 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m17:20:05.544977 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m17:20:05.547290 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 17:20:05.541892 => 17:20:05.546947
[0m17:20:05.548238 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m17:20:05.548678 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m17:20:05.549375 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m17:20:05.549735 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m17:20:05.552221 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m17:20:05.552982 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 17:20:05.549937 => 17:20:05.552710
[0m17:20:05.553796 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m17:20:05.554273 [debug] [Thread-1 (]: Began running node seed.dbtlearnnew.seed_full_moon_dates
[0m17:20:05.554942 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now seed.dbtlearnnew.seed_full_moon_dates)
[0m17:20:05.555298 [debug] [Thread-1 (]: Began compiling node seed.dbtlearnnew.seed_full_moon_dates
[0m17:20:05.556863 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (compile): 17:20:05.555497 => 17:20:05.556667
[0m17:20:05.557258 [debug] [Thread-1 (]: Began executing node seed.dbtlearnnew.seed_full_moon_dates
[0m17:20:05.557664 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (execute): 17:20:05.557476 => 17:20:05.557486
[0m17:20:05.558370 [debug] [Thread-1 (]: Finished running node seed.dbtlearnnew.seed_full_moon_dates
[0m17:20:05.558735 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m17:20:05.559298 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearnnew.seed_full_moon_dates, now model.dbtlearnnew.dim_hosts)
[0m17:20:05.559639 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m17:20:05.564929 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m17:20:05.567348 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 17:20:05.559835 => 17:20:05.566939
[0m17:20:05.567970 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m17:20:05.568571 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 17:20:05.568322 => 17:20:05.568334
[0m17:20:05.569395 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m17:20:05.569800 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m17:20:05.570396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m17:20:05.570729 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m17:20:05.575317 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m17:20:05.577670 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 17:20:05.570916 => 17:20:05.577377
[0m17:20:05.578092 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m17:20:05.578504 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 17:20:05.578315 => 17:20:05.578327
[0m17:20:05.579253 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m17:20:05.579630 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m17:20:05.580224 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m17:20:05.580614 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m17:20:05.588674 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m17:20:05.589554 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 17:20:05.580826 => 17:20:05.589250
[0m17:20:05.589927 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m17:20:05.590341 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 17:20:05.590141 => 17:20:05.590153
[0m17:20:05.591250 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m17:20:05.591659 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m17:20:05.592437 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m17:20:05.593108 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m17:20:05.596399 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m17:20:05.597263 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 17:20:05.593442 => 17:20:05.596993
[0m17:20:05.597638 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m17:20:05.598054 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 17:20:05.597845 => 17:20:05.597853
[0m17:20:05.598759 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m17:20:05.599118 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m17:20:05.599678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now model.dbtlearnnew.mart_full_moon)
[0m17:20:05.599998 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m17:20:05.602602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m17:20:05.604707 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 17:20:05.600183 => 17:20:05.604429
[0m17:20:05.605164 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m17:20:05.605589 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 17:20:05.605392 => 17:20:05.605404
[0m17:20:05.606329 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m17:20:05.607023 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:20:05.607335 [debug] [MainThread]: Connection 'model.dbtlearnnew.mart_full_moon' was properly closed.
[0m17:20:05.608418 [debug] [MainThread]: Command end result
[0m17:20:05.620294 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 1.7623384, "process_user_time": 1.996735, "process_kernel_time": 0.106967, "process_mem_max_rss": "117916", "process_out_blocks": "1888", "process_in_blocks": "0"}
[0m17:20:05.621251 [debug] [MainThread]: Command `dbt compile` succeeded at 17:20:05.621011 after 1.76 seconds
[0m17:20:05.621772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535fca6f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535fa0fea10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7535fa0ffd60>]}
[0m17:20:05.622334 [debug] [MainThread]: Flushing usage events
[0m17:25:01.148306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367abdab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367aa23a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367aa23a5c0>]}


============================== 17:25:01.151180 | 0a618a3d-efeb-4d73-bea8-bde415b2c67a ==============================
[0m17:25:01.151180 [info ] [MainThread]: Running with dbt=1.7.10
[0m17:25:01.151809 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt source freshness', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:25:01.412472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0a618a3d-efeb-4d73-bea8-bde415b2c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367aa23a710>]}
[0m17:25:01.486992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0a618a3d-efeb-4d73-bea8-bde415b2c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a91ee3e0>]}
[0m17:25:01.487834 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m17:25:01.493709 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m17:25:01.526511 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:25:01.526995 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:25:01.532354 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0a618a3d-efeb-4d73-bea8-bde415b2c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a8e141c0>]}
[0m17:25:01.590858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0a618a3d-efeb-4d73-bea8-bde415b2c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a9154c40>]}
[0m17:25:01.591433 [info ] [MainThread]: Found 1 seed, 8 models, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m17:25:01.591813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a618a3d-efeb-4d73-bea8-bde415b2c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a92ed7b0>]}
[0m17:25:01.593072 [info ] [MainThread]: 
[0m17:25:01.593798 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:25:01.594829 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m17:25:01.609245 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m17:25:01.609648 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m17:25:01.609948 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:25:03.414871 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 2.0 seconds
[0m17:25:03.420983 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m17:25:03.710162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0a618a3d-efeb-4d73-bea8-bde415b2c67a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a8fd5c00>]}
[0m17:25:03.711651 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m17:25:03.712400 [info ] [MainThread]: 
[0m17:25:03.715231 [debug] [Thread-1 (]: Began running node source.dbtlearnnew.airbnb.reviews
[0m17:25:03.715856 [info ] [Thread-1 (]: 1 of 1 START freshness of airbnb.reviews ....................................... [RUN]
[0m17:25:03.716771 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now source.dbtlearnnew.airbnb.reviews)
[0m17:25:03.717673 [debug] [Thread-1 (]: Began compiling node source.dbtlearnnew.airbnb.reviews
[0m17:25:03.718310 [debug] [Thread-1 (]: Timing info for source.dbtlearnnew.airbnb.reviews (compile): 17:25:03.718044 => 17:25:03.718049
[0m17:25:03.718696 [debug] [Thread-1 (]: Began executing node source.dbtlearnnew.airbnb.reviews
[0m17:25:03.725486 [debug] [Thread-1 (]: Using snowflake connection "source.dbtlearnnew.airbnb.reviews"
[0m17:25:03.725941 [debug] [Thread-1 (]: On source.dbtlearnnew.airbnb.reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "source.dbtlearnnew.airbnb.reviews"} */
select
      max(date) as max_loaded_at,
      convert_timezone('UTC', current_timestamp()) as snapshotted_at
    from AIRBNB.raw.raw_reviews
[0m17:25:03.726266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:25:05.085899 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m17:25:05.090189 [debug] [Thread-1 (]: On source.dbtlearnnew.airbnb.reviews: Close
[0m17:25:05.271651 [debug] [Thread-1 (]: Timing info for source.dbtlearnnew.airbnb.reviews (execute): 17:25:03.718883 => 17:25:05.270852
[0m17:25:05.274345 [warn ] [Thread-1 (]: 1 of 1 WARN freshness of airbnb.reviews ........................................ [[33mWARN[0m in 1.56s]
[0m17:25:05.276194 [debug] [Thread-1 (]: Finished running node source.dbtlearnnew.airbnb.reviews
[0m17:25:05.277951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:25:05.278726 [debug] [MainThread]: Connection 'source.dbtlearnnew.airbnb.reviews' was properly closed.
[0m17:25:05.290740 [info ] [MainThread]: Done.
[0m17:25:05.291729 [debug] [MainThread]: Resource report: {"command_name": "freshness", "command_success": true, "command_wall_clock_time": 4.1786275, "process_user_time": 2.099572, "process_kernel_time": 0.148535, "process_mem_max_rss": "117820", "process_out_blocks": "1792", "process_in_blocks": "0"}
[0m17:25:05.292414 [debug] [MainThread]: Command `dbt source freshness` succeeded at 17:25:05.292259 after 4.18 seconds
[0m17:25:05.292789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367abdab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a9157fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7367a92ed480>]}
[0m17:25:05.293160 [debug] [MainThread]: Flushing usage events
[0m18:00:43.305294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69fba77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69e03e5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69e03e590>]}


============================== 18:00:43.307582 | 41e56f57-a3ce-42e0-95fc-bb6828536eac ==============================
[0m18:00:43.307582 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:00:43.308076 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt snapshot', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:00:43.580978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69d03bd60>]}
[0m18:00:43.656560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69dff5f60>]}
[0m18:00:43.657375 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:00:43.663401 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:00:43.694363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:00:43.694968 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://snapshots/raw_listing_snapshots.sql
[0m18:00:43.902316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69cb9df00>]}
[0m18:00:43.923961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69cdc35e0>]}
[0m18:00:43.925024 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:00:43.926063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69cdc3880>]}
[0m18:00:43.928220 [info ] [MainThread]: 
[0m18:00:43.929108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:00:43.930134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:00:43.942034 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:00:43.942665 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:00:43.943100 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:00:44.694732 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:00:44.697591 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:00:44.886852 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m18:00:44.902387 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m18:00:44.902834 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m18:00:44.903134 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:45.554268 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:00:45.558992 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:00:45.742565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m18:00:45.754772 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:00:45.755880 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:00:45.756945 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:00:46.491157 [debug] [ThreadPool]: SQL status: SUCCESS 9 in 1.0 seconds
[0m18:00:46.495989 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:00:46.681640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69cbaa4a0>]}
[0m18:00:46.685040 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:00:46.686917 [info ] [MainThread]: 
[0m18:00:46.690389 [debug] [Thread-1 (]: Began running node snapshot.dbtlearnnew.scd_raw_listings
[0m18:00:46.691163 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m18:00:46.692125 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtlearnnew.scd_raw_listings)
[0m18:00:46.692667 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearnnew.scd_raw_listings
[0m18:00:46.700685 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (compile): 18:00:46.692936 => 18:00:46.700373
[0m18:00:46.701160 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearnnew.scd_raw_listings
[0m18:00:46.747605 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:00:46.749050 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:00:46.750294 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
create or replace transient table AIRBNB.dev.scd_raw_listings
         as
        (

    select *,
        md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id,
        updated_at as dbt_updated_at,
        updated_at as dbt_valid_from,
        nullif(updated_at, updated_at) as dbt_valid_to
    from (
        



select * from AIRBNB.raw.raw_listings

    ) sbq



        );
[0m18:00:46.751087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:00:48.082107 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:00:48.111221 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (execute): 18:00:46.701391 => 18:00:48.111016
[0m18:00:48.111670 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: Close
[0m18:00:48.364928 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '41e56f57-a3ce-42e0-95fc-bb6828536eac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69c11f280>]}
[0m18:00:48.367968 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 1[0m in 1.67s]
[0m18:00:48.370558 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearnnew.scd_raw_listings
[0m18:00:48.373896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:00:48.374670 [debug] [MainThread]: Connection 'snapshot.dbtlearnnew.scd_raw_listings' was properly closed.
[0m18:00:48.375228 [info ] [MainThread]: 
[0m18:00:48.375796 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 4.45 seconds (4.45s).
[0m18:00:48.376736 [debug] [MainThread]: Command end result
[0m18:00:48.388826 [info ] [MainThread]: 
[0m18:00:48.389435 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:00:48.389944 [info ] [MainThread]: 
[0m18:00:48.390372 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:00:48.391352 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 5.1222124, "process_user_time": 2.542216, "process_kernel_time": 0.108416, "process_mem_max_rss": "121312", "process_out_blocks": "2696", "process_in_blocks": "0"}
[0m18:00:48.392045 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:00:48.391879 after 5.12 seconds
[0m18:00:48.392537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69fba77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69c1d2470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77a69c11f280>]}
[0m18:00:48.392962 [debug] [MainThread]: Flushing usage events
[0m18:02:08.259759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d36c837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d351165f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d35116590>]}


============================== 18:02:08.262199 | 3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e ==============================
[0m18:02:08.262199 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:02:08.262724 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt snapshot', 'send_anonymous_usage_stats': 'True'}
[0m18:02:08.565563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d34113d60>]}
[0m18:02:08.644446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d350d5f60>]}
[0m18:02:08.645251 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:02:08.651240 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:02:08.682742 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:02:08.683801 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:02:08.690220 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d33ef3eb0>]}
[0m18:02:08.775054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d340f1c90>]}
[0m18:02:08.776047 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:02:08.777159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d341890c0>]}
[0m18:02:08.779209 [info ] [MainThread]: 
[0m18:02:08.782686 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:02:08.790702 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m18:02:08.811105 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m18:02:08.811940 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m18:02:08.812624 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:02:09.620867 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m18:02:09.624360 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m18:02:09.999825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m18:02:10.010610 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m18:02:10.011084 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m18:02:10.011419 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:10.782682 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:02:10.787434 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:02:10.963414 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m18:02:10.973636 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:02:10.974690 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:02:10.975426 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:02:11.613912 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:02:11.620494 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:02:11.906680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d34670070>]}
[0m18:02:11.908607 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:02:11.909674 [info ] [MainThread]: 
[0m18:02:11.912617 [debug] [Thread-1 (]: Began running node snapshot.dbtlearnnew.scd_raw_listings
[0m18:02:11.913393 [info ] [Thread-1 (]: 1 of 1 START snapshot dev.scd_raw_listings ..................................... [RUN]
[0m18:02:11.914360 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now snapshot.dbtlearnnew.scd_raw_listings)
[0m18:02:11.914767 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearnnew.scd_raw_listings
[0m18:02:11.923479 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (compile): 18:02:11.915004 => 18:02:11.923201
[0m18:02:11.923912 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearnnew.scd_raw_listings
[0m18:02:11.965638 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:11.966154 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m18:02:11.967192 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:02:13.460052 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 1.0 seconds
[0m18:02:13.503097 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:13.504446 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
create or replace temporary table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
         as
        (with snapshot_query as (

        



select * from AIRBNB.raw.raw_listings


    ),

    snapshotted_data as (

        select *,
            id as dbt_unique_key

        from "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
        where dbt_valid_to is null

    ),

    insertions_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            nullif(updated_at, updated_at) as dbt_valid_to,
            md5(coalesce(cast(id as varchar ), '')
         || '|' || coalesce(cast(updated_at as varchar ), '')
        ) as dbt_scd_id

        from snapshot_query
    ),

    updates_source_data as (

        select
            *,
            id as dbt_unique_key,
            updated_at as dbt_updated_at,
            updated_at as dbt_valid_from,
            updated_at as dbt_valid_to

        from snapshot_query
    ),

    deletes_source_data as (

        select
            *,
            id as dbt_unique_key
        from snapshot_query
    ),
    

    insertions as (

        select
            'insert' as dbt_change_type,
            source_data.*

        from insertions_source_data as source_data
        left outer join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where snapshotted_data.dbt_unique_key is null
           or (
                snapshotted_data.dbt_unique_key is not null
            and (
                (snapshotted_data.dbt_valid_from < source_data.updated_at)
            )
        )

    ),

    updates as (

        select
            'update' as dbt_change_type,
            source_data.*,
            snapshotted_data.dbt_scd_id

        from updates_source_data as source_data
        join snapshotted_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where (
            (snapshotted_data.dbt_valid_from < source_data.updated_at)
        )
    ),

    deletes as (

        select
            'delete' as dbt_change_type,
            source_data.*,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_from,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_updated_at,
            to_timestamp_ntz(convert_timezone('UTC', current_timestamp())) as dbt_valid_to,
            snapshotted_data.dbt_scd_id

        from snapshotted_data
        left join deletes_source_data as source_data on snapshotted_data.dbt_unique_key = source_data.dbt_unique_key
        where source_data.dbt_unique_key is null
    )

    select * from insertions
    union all
    select * from updates
    union all
    select * from deletes

        );
[0m18:02:14.413833 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:02:14.423613 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:14.424163 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m18:02:14.721886 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m18:02:14.731244 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:14.731931 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m18:02:19.095884 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 4.0 seconds
[0m18:02:19.103768 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:19.104355 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m18:02:19.210943 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m18:02:19.214834 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:19.215364 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS"
[0m18:02:19.337878 [debug] [Thread-1 (]: SQL status: SUCCESS 13 in 0.0 seconds
[0m18:02:19.358851 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:19.359842 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
describe table "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp"
[0m18:02:19.467751 [debug] [Thread-1 (]: SQL status: SUCCESS 15 in 0.0 seconds
[0m18:02:19.491720 [debug] [Thread-1 (]: Writing runtime sql for node "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:19.495614 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:19.496613 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
BEGIN
[0m18:02:19.944309 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:02:19.945511 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:19.946558 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
merge into "AIRBNB"."DEV"."SCD_RAW_LISTINGS" as DBT_INTERNAL_DEST
    using "AIRBNB"."DEV"."SCD_RAW_LISTINGS__dbt_tmp" as DBT_INTERNAL_SOURCE
    on DBT_INTERNAL_SOURCE.dbt_scd_id = DBT_INTERNAL_DEST.dbt_scd_id

    when matched
     and DBT_INTERNAL_DEST.dbt_valid_to is null
     and DBT_INTERNAL_SOURCE.dbt_change_type in ('update', 'delete')
        then update
        set dbt_valid_to = DBT_INTERNAL_SOURCE.dbt_valid_to

    when not matched
     and DBT_INTERNAL_SOURCE.dbt_change_type = 'insert'
        then insert ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")
        values ("ID", "LISTING_URL", "NAME", "ROOM_TYPE", "MINIMUM_NIGHTS", "HOST_ID", "PRICE", "CREATED_AT", "UPDATED_AT", "DBT_UPDATED_AT", "DBT_VALID_FROM", "DBT_VALID_TO", "DBT_SCD_ID")

;
[0m18:02:20.686066 [debug] [Thread-1 (]: SQL status: SUCCESS 2 in 1.0 seconds
[0m18:02:20.688461 [debug] [Thread-1 (]: Using snowflake connection "snapshot.dbtlearnnew.scd_raw_listings"
[0m18:02:20.689846 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "snapshot.dbtlearnnew.scd_raw_listings"} */
COMMIT
[0m18:02:21.023319 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:02:21.046503 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (execute): 18:02:11.924130 => 18:02:21.046170
[0m18:02:21.047153 [debug] [Thread-1 (]: On snapshot.dbtlearnnew.scd_raw_listings: Close
[0m18:02:21.245472 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3bbef93a-5aae-4c7e-a2ad-fee4ef6b3f7e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d33310610>]}
[0m18:02:21.247678 [info ] [Thread-1 (]: 1 of 1 OK snapshotted dev.scd_raw_listings ..................................... [[32mSUCCESS 2[0m in 9.33s]
[0m18:02:21.249665 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearnnew.scd_raw_listings
[0m18:02:21.253825 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:02:21.254837 [debug] [MainThread]: Connection 'snapshot.dbtlearnnew.scd_raw_listings' was properly closed.
[0m18:02:21.255812 [info ] [MainThread]: 
[0m18:02:21.256890 [info ] [MainThread]: Finished running 1 snapshot in 0 hours 0 minutes and 12.47 seconds (12.47s).
[0m18:02:21.258238 [debug] [MainThread]: Command end result
[0m18:02:21.270471 [info ] [MainThread]: 
[0m18:02:21.271197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:02:21.271569 [info ] [MainThread]: 
[0m18:02:21.271901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m18:02:21.272676 [debug] [MainThread]: Resource report: {"command_name": "snapshot", "command_success": true, "command_wall_clock_time": 13.049193, "process_user_time": 2.694831, "process_kernel_time": 0.121754, "process_mem_max_rss": "119660", "process_out_blocks": "1824", "process_in_blocks": "0"}
[0m18:02:21.273182 [debug] [MainThread]: Command `dbt snapshot` succeeded at 18:02:21.273048 after 13.05 seconds
[0m18:02:21.273529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d36c837f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d341c33d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x713d340f2320>]}
[0m18:02:21.273883 [debug] [MainThread]: Flushing usage events
[0m18:37:28.153929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890681ab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906663a530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906663a4d0>]}


============================== 18:37:28.156131 | 9103e5f4-e1e9-40b0-a319-66fd7f61d90d ==============================
[0m18:37:28.156131 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:37:28.156647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:37:28.419158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9103e5f4-e1e9-40b0-a319-66fd7f61d90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906563ded0>]}
[0m18:37:28.494198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9103e5f4-e1e9-40b0-a319-66fd7f61d90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906552a350>]}
[0m18:37:28.495021 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:37:28.502263 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:37:28.534690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:37:28.535172 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:37:28.539916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9103e5f4-e1e9-40b0-a319-66fd7f61d90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x789065221150>]}
[0m18:37:28.602692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9103e5f4-e1e9-40b0-a319-66fd7f61d90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906541c820>]}
[0m18:37:28.603508 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:37:28.604079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9103e5f4-e1e9-40b0-a319-66fd7f61d90d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906541ec80>]}
[0m18:37:28.605786 [info ] [MainThread]: 
[0m18:37:28.606356 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m18:37:28.607031 [debug] [MainThread]: Command end result
[0m18:37:28.710033 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 0.59096473, "process_user_time": 2.01265, "process_kernel_time": 0.068423, "process_mem_max_rss": "110416", "process_out_blocks": "1808", "process_in_blocks": "0"}
[0m18:37:28.710959 [debug] [MainThread]: Command `dbt test` succeeded at 18:37:28.710740 after 0.59 seconds
[0m18:37:28.711517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7890681ab8b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906552a350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x78906541c820>]}
[0m18:37:28.712089 [debug] [MainThread]: Flushing usage events
[0m18:38:16.012021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70586497f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705862b42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705862b42530>]}


============================== 18:38:16.014268 | 41655175-82af-4889-908e-7504fe67e8c8 ==============================
[0m18:38:16.014268 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:38:16.014777 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:38:16.245106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '41655175-82af-4889-908e-7504fe67e8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705861b3fd30>]}
[0m18:38:16.314954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '41655175-82af-4889-908e-7504fe67e8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705861a2c0d0>]}
[0m18:38:16.315736 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:38:16.321579 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:38:16.350527 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:38:16.351068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:38:16.355710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '41655175-82af-4889-908e-7504fe67e8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70586172d900>]}
[0m18:38:16.406455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '41655175-82af-4889-908e-7504fe67e8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705861a656f0>]}
[0m18:38:16.406985 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 2 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:38:16.407373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41655175-82af-4889-908e-7504fe67e8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705864f03a90>]}
[0m18:38:16.408688 [info ] [MainThread]: 
[0m18:38:16.409382 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:38:16.410510 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m18:38:16.421985 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:38:16.422415 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:38:16.422730 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:38:19.242114 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 3.0 seconds
[0m18:38:19.246692 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:38:19.419253 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m18:38:19.431732 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m18:38:19.432871 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m18:38:19.433858 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:38:19.983035 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:38:19.987737 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:38:20.172232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '41655175-82af-4889-908e-7504fe67e8c8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705860d1bc70>]}
[0m18:38:20.174246 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:38:20.175234 [info ] [MainThread]: 
[0m18:38:20.179476 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:38:20.180462 [info ] [Thread-1 (]: 1 of 2 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m18:38:20.181493 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m18:38:20.182007 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:38:20.199648 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:38:20.200666 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 18:38:20.182293 => 18:38:20.200360
[0m18:38:20.201088 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:38:20.219159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:38:20.220154 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:38:20.220757 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m18:38:20.221120 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:22.548848 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m18:38:22.564237 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 18:38:20.201320 => 18:38:22.563765
[0m18:38:22.565129 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m18:38:22.755997 [info ] [Thread-1 (]: 1 of 2 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 2.57s]
[0m18:38:22.758143 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:38:22.759523 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:38:22.760984 [info ] [Thread-1 (]: 2 of 2 START test unique_dim_listing_listing_id ................................ [RUN]
[0m18:38:22.762865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m18:38:22.763986 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:38:22.775323 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:38:22.776227 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 18:38:22.764638 => 18:38:22.775901
[0m18:38:22.776821 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:38:22.779519 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:38:22.780656 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:38:22.781198 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:38:22.781708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:38:23.757939 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:38:23.761864 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 18:38:22.777159 => 18:38:23.761613
[0m18:38:23.762275 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m18:38:23.959306 [info ] [Thread-1 (]: 2 of 2 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 1.20s]
[0m18:38:23.961562 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:38:23.965611 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:38:23.967398 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m18:38:23.968993 [info ] [MainThread]: 
[0m18:38:23.970549 [info ] [MainThread]: Finished running 2 tests in 0 hours 0 minutes and 7.56 seconds (7.56s).
[0m18:38:23.972785 [debug] [MainThread]: Command end result
[0m18:38:23.984465 [info ] [MainThread]: 
[0m18:38:23.984989 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:38:23.985483 [info ] [MainThread]: 
[0m18:38:23.985861 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:38:23.986805 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.007333, "process_user_time": 2.156614, "process_kernel_time": 0.123448, "process_mem_max_rss": "118756", "process_out_blocks": "1880", "process_in_blocks": "0"}
[0m18:38:23.987518 [debug] [MainThread]: Command `dbt test` succeeded at 18:38:23.987340 after 8.01 seconds
[0m18:38:23.987933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70586497f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705861bbfa90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x705861a65b70>]}
[0m18:38:23.988309 [debug] [MainThread]: Flushing usage events
[0m18:43:28.482542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9ebab820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9cdf65c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9cdf6560>]}


============================== 18:43:28.485200 | b534c9b8-ca5a-42ac-9dc8-e7178836f325 ==============================
[0m18:43:28.485200 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:43:28.485861 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:43:28.743486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b534c9b8-ca5a-42ac-9dc8-e7178836f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9bda3d60>]}
[0m18:43:28.819020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b534c9b8-ca5a-42ac-9dc8-e7178836f325', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9cdb5f30>]}
[0m18:43:28.820298 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:43:28.826964 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:43:28.861151 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:43:28.861874 [debug] [MainThread]: Partial parsing: updated file: dbtlearnnew://models/schema.yaml
[0m18:43:29.138602 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid test config given in models/schema.yaml:
  	test definition dictionary must have exactly one key, got [('relationships', None), ('to', "ref('dim_hosts')"), ('field', 'host_id')] instead (3 keys)
  	@: UnparsedModelUpdate(original_file_path='mode...ne)
[0m18:43:29.139581 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.6938956, "process_user_time": 2.148954, "process_kernel_time": 0.091529, "process_mem_max_rss": "113608", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m18:43:29.140137 [debug] [MainThread]: Command `dbt test` failed at 18:43:29.140012 after 0.69 seconds
[0m18:43:29.140485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9ebab820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9b143eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70db9b11edd0>]}
[0m18:43:29.140836 [debug] [MainThread]: Flushing usage events
[0m18:44:21.003677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ca157b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9fa0a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9fa0a530>]}


============================== 18:44:21.005895 | 190e7bad-a85e-4c25-8ec6-07208e0622f5 ==============================
[0m18:44:21.005895 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:44:21.006389 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:44:21.237415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '190e7bad-a85e-4c25-8ec6-07208e0622f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9e98bd30>]}
[0m18:44:21.305346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '190e7bad-a85e-4c25-8ec6-07208e0622f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9ea740d0>]}
[0m18:44:21.306092 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:44:21.311740 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:44:21.341329 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:44:21.341756 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:44:21.346405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '190e7bad-a85e-4c25-8ec6-07208e0622f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9e58e200>]}
[0m18:44:21.401104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '190e7bad-a85e-4c25-8ec6-07208e0622f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9e6b0160>]}
[0m18:44:21.401904 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 5 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:44:21.402603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '190e7bad-a85e-4c25-8ec6-07208e0622f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ca1d31de0>]}
[0m18:44:21.404903 [info ] [MainThread]: 
[0m18:44:21.405950 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:44:21.407590 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m18:44:21.420866 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:44:21.421312 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:44:21.422194 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:44:23.199171 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 2.0 seconds
[0m18:44:23.203666 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:44:23.378703 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m18:44:23.389620 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m18:44:23.390895 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m18:44:23.391808 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:44:24.027669 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:44:24.031209 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:44:24.214021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '190e7bad-a85e-4c25-8ec6-07208e0622f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9e758040>]}
[0m18:44:24.215898 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:44:24.217155 [info ] [MainThread]: 
[0m18:44:24.221989 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:44:24.223211 [info ] [Thread-1 (]: 1 of 5 START test accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m18:44:24.224728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m18:44:24.225470 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:44:24.246315 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:44:24.247620 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 18:44:24.225894 => 18:44:24.247262
[0m18:44:24.248746 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:44:24.267424 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:44:24.269262 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:44:24.270029 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listing
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m18:44:24.270633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:25.071915 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:25.083435 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 18:44:24.249026 => 18:44:25.082967
[0m18:44:25.084310 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: Close
[0m18:44:25.255332 [info ] [Thread-1 (]: 1 of 5 PASS accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 1.03s]
[0m18:44:25.258339 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:44:25.259673 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:44:25.260945 [info ] [Thread-1 (]: 2 of 5 START test not_null_dim_listing_host_id ................................. [RUN]
[0m18:44:25.262613 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m18:44:25.263687 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:44:25.279282 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:44:25.280513 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 18:44:25.264286 => 18:44:25.280105
[0m18:44:25.281188 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:44:25.284066 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:44:25.285232 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:44:25.286008 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listing
where host_id is null



      
    ) dbt_internal_test
[0m18:44:25.286649 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:25.821506 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:25.827020 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 18:44:25.281567 => 18:44:25.826317
[0m18:44:25.828263 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: Close
[0m18:44:26.015657 [info ] [Thread-1 (]: 2 of 5 PASS not_null_dim_listing_host_id ....................................... [[32mPASS[0m in 0.75s]
[0m18:44:26.017530 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:44:26.019185 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:44:26.020505 [info ] [Thread-1 (]: 3 of 5 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m18:44:26.022512 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m18:44:26.023350 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:44:26.030187 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:44:26.031154 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 18:44:26.023773 => 18:44:26.030870
[0m18:44:26.031732 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:44:26.034096 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:44:26.034925 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:44:26.035849 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m18:44:26.036160 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:26.525387 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:44:26.531319 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 18:44:26.031950 => 18:44:26.530589
[0m18:44:26.532550 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m18:44:26.746714 [info ] [Thread-1 (]: 3 of 5 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 0.72s]
[0m18:44:26.749316 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:44:26.751317 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:44:26.752721 [info ] [Thread-1 (]: 4 of 5 START test relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ... [RUN]
[0m18:44:26.754569 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m18:44:26.755617 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:44:26.765446 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:44:26.766440 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 18:44:26.756076 => 18:44:26.766139
[0m18:44:26.766820 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:44:26.769281 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:44:26.770447 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:44:26.770874 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listing
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:44:26.771252 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:27.642150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:27.647637 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 18:44:26.767051 => 18:44:27.646953
[0m18:44:27.649153 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: Close
[0m18:44:27.931668 [info ] [Thread-1 (]: 4 of 5 PASS relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ......... [[32mPASS[0m in 1.18s]
[0m18:44:27.933651 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:44:27.935261 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:44:27.936610 [info ] [Thread-1 (]: 5 of 5 START test unique_dim_listing_listing_id ................................ [RUN]
[0m18:44:27.938439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m18:44:27.939472 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:44:27.948282 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:44:27.949196 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 18:44:27.940057 => 18:44:27.948878
[0m18:44:27.949590 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:44:27.952746 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:44:27.955843 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:44:27.956407 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:44:27.956794 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:44:28.462250 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:44:28.467411 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 18:44:27.949801 => 18:44:28.466723
[0m18:44:28.468641 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m18:44:28.638877 [info ] [Thread-1 (]: 5 of 5 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 0.70s]
[0m18:44:28.640704 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:44:28.644266 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:44:28.645118 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m18:44:28.646051 [info ] [MainThread]: 
[0m18:44:28.647103 [info ] [MainThread]: Finished running 5 tests in 0 hours 0 minutes and 7.24 seconds (7.24s).
[0m18:44:28.650150 [debug] [MainThread]: Command end result
[0m18:44:28.665699 [info ] [MainThread]: 
[0m18:44:28.666405 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:44:28.666925 [info ] [MainThread]: 
[0m18:44:28.667407 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:44:28.668482 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.6971197, "process_user_time": 2.411032, "process_kernel_time": 0.127315, "process_mem_max_rss": "121212", "process_out_blocks": "2008", "process_in_blocks": "0"}
[0m18:44:28.669256 [debug] [MainThread]: Command `dbt test` succeeded at 18:44:28.669062 after 7.70 seconds
[0m18:44:28.669628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ca157b850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772ca1d31b40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x772c9ea3d900>]}
[0m18:44:28.670033 [debug] [MainThread]: Flushing usage events
[0m18:47:33.808136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45c0b5b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bed325f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bed32590>]}


============================== 18:47:33.810381 | fb8b94f7-c5cc-4f9b-95af-066fec302bb9 ==============================
[0m18:47:33.810381 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:47:33.810905 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:47:34.074808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb8b94f7-c5cc-4f9b-95af-066fec302bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bdd2fd60>]}
[0m18:47:34.151374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb8b94f7-c5cc-4f9b-95af-066fec302bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45becf1f60>]}
[0m18:47:34.152110 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:47:34.157809 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:47:34.191112 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:47:34.191710 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://tests/dim_listing_minimum.sql
[0m18:47:34.339388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb8b94f7-c5cc-4f9b-95af-066fec302bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bd83bd90>]}
[0m18:47:34.352626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb8b94f7-c5cc-4f9b-95af-066fec302bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bdae3df0>]}
[0m18:47:34.353575 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 6 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:47:34.354222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb8b94f7-c5cc-4f9b-95af-066fec302bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bdae3e80>]}
[0m18:47:34.356495 [info ] [MainThread]: 
[0m18:47:34.357569 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:47:34.359319 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m18:47:34.373479 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:47:34.373916 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:47:34.374239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:47:35.043357 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:47:35.049426 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:47:35.220397 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m18:47:35.232223 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m18:47:35.233020 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m18:47:35.233597 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:47:35.842810 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:47:35.846608 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:47:36.014245 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb8b94f7-c5cc-4f9b-95af-066fec302bb9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bce33100>]}
[0m18:47:36.017543 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:47:36.018474 [info ] [MainThread]: 
[0m18:47:36.021527 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:47:36.022339 [info ] [Thread-1 (]: 1 of 6 START test accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m18:47:36.023424 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m18:47:36.024077 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:47:36.041644 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:47:36.042604 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 18:47:36.024450 => 18:47:36.042288
[0m18:47:36.043025 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:47:36.062791 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:47:36.064217 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:47:36.065155 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listing
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m18:47:36.066149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:36.605431 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:47:36.620152 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 18:47:36.043247 => 18:47:36.619686
[0m18:47:36.621049 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: Close
[0m18:47:36.806289 [info ] [Thread-1 (]: 1 of 6 PASS accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.78s]
[0m18:47:36.807972 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:47:36.809316 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m18:47:36.810734 [info ] [Thread-1 (]: 2 of 6 START test dim_listing_minimum .......................................... [RUN]
[0m18:47:36.812005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.dim_listing_minimum)
[0m18:47:36.812854 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m18:47:36.821161 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m18:47:36.822129 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 18:47:36.813758 => 18:47:36.821781
[0m18:47:36.822745 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m18:47:36.825951 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.dim_listing_minimum"
[0m18:47:36.826975 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.dim_listing_minimum"
[0m18:47:36.827518 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.dim_listing_minimum"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from 
AIRBNB.DEV.dim_listing
where minimum_nights < 1 
limit 10
      
    ) dbt_internal_test
[0m18:47:36.827999 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:42.505935 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 6.0 seconds
[0m18:47:42.510575 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 18:47:36.823101 => 18:47:42.510057
[0m18:47:42.511573 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: Close
[0m18:47:42.684797 [info ] [Thread-1 (]: 2 of 6 PASS dim_listing_minimum ................................................ [[32mPASS[0m in 5.87s]
[0m18:47:42.686952 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m18:47:42.688310 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:47:42.689871 [info ] [Thread-1 (]: 3 of 6 START test not_null_dim_listing_host_id ................................. [RUN]
[0m18:47:42.692132 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m18:47:42.693317 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:47:42.710413 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:47:42.711477 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 18:47:42.693976 => 18:47:42.711157
[0m18:47:42.711982 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:47:42.716767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:47:42.718095 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:47:42.718629 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listing
where host_id is null



      
    ) dbt_internal_test
[0m18:47:42.719081 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:43.350029 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:47:43.355635 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 18:47:42.712273 => 18:47:43.354909
[0m18:47:43.356925 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: Close
[0m18:47:43.528701 [info ] [Thread-1 (]: 3 of 6 PASS not_null_dim_listing_host_id ....................................... [[32mPASS[0m in 0.84s]
[0m18:47:43.531670 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:47:43.533956 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:47:43.535373 [info ] [Thread-1 (]: 4 of 6 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m18:47:43.537440 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m18:47:43.538728 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:47:43.551342 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:47:43.553287 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 18:47:43.539420 => 18:47:43.552575
[0m18:47:43.554394 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:47:43.562595 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:47:43.569301 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:47:43.570792 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m18:47:43.571562 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:44.244860 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:47:44.250379 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 18:47:43.555050 => 18:47:44.249860
[0m18:47:44.251318 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m18:47:44.443680 [info ] [Thread-1 (]: 4 of 6 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 0.91s]
[0m18:47:44.444998 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:47:44.445820 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:47:44.447047 [info ] [Thread-1 (]: 5 of 6 START test relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ... [RUN]
[0m18:47:44.448775 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m18:47:44.449399 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:47:44.457203 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:47:44.458017 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 18:47:44.449728 => 18:47:44.457769
[0m18:47:44.458400 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:47:44.460574 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:47:44.461803 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:47:44.462410 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listing
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:47:44.463031 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:45.000171 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:47:45.005677 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 18:47:44.458610 => 18:47:45.004815
[0m18:47:45.006951 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: Close
[0m18:47:45.185988 [info ] [Thread-1 (]: 5 of 6 PASS relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ......... [[32mPASS[0m in 0.74s]
[0m18:47:45.187447 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:47:45.188414 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:47:45.190171 [info ] [Thread-1 (]: 6 of 6 START test unique_dim_listing_listing_id ................................ [RUN]
[0m18:47:45.191657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m18:47:45.192480 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:47:45.204390 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:47:45.208937 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 18:47:45.192875 => 18:47:45.208439
[0m18:47:45.210031 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:47:45.214477 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:47:45.217145 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:47:45.218117 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:47:45.218904 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:47:45.767521 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:47:45.775846 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 18:47:45.210512 => 18:47:45.775021
[0m18:47:45.776807 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m18:47:46.003250 [info ] [Thread-1 (]: 6 of 6 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 0.81s]
[0m18:47:46.005259 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:47:46.008636 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:47:46.009469 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m18:47:46.010298 [info ] [MainThread]: 
[0m18:47:46.011025 [info ] [MainThread]: Finished running 6 tests in 0 hours 0 minutes and 11.65 seconds (11.65s).
[0m18:47:46.013135 [debug] [MainThread]: Command end result
[0m18:47:46.023653 [info ] [MainThread]: 
[0m18:47:46.024092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:47:46.024407 [info ] [MainThread]: 
[0m18:47:46.024706 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:47:46.025445 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 12.253708, "process_user_time": 2.877704, "process_kernel_time": 0.139888, "process_mem_max_rss": "121352", "process_out_blocks": "2920", "process_in_blocks": "0"}
[0m18:47:46.025942 [debug] [MainThread]: Command `dbt test` succeeded at 18:47:46.025826 after 12.25 seconds
[0m18:47:46.026275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45c0b5b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bd916050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7e45bed32770>]}
[0m18:47:46.026620 [debug] [MainThread]: Flushing usage events
[0m18:58:00.935617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddad7f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd920a590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd920a530>]}


============================== 18:58:00.942699 | 53feaa47-9b0b-49bd-87f5-fc53b10d71da ==============================
[0m18:58:00.942699 [info ] [MainThread]: Running with dbt=1.7.10
[0m18:58:00.943471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:58:02.143341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '53feaa47-9b0b-49bd-87f5-fc53b10d71da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd8187d30>]}
[0m18:58:02.220809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '53feaa47-9b0b-49bd-87f5-fc53b10d71da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd82740d0>]}
[0m18:58:02.223176 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m18:58:02.232786 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m18:58:02.724992 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:58:02.725595 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://tests/consistent_created_at.sql
[0m18:58:02.851507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '53feaa47-9b0b-49bd-87f5-fc53b10d71da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd7e60a90>]}
[0m18:58:02.930965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '53feaa47-9b0b-49bd-87f5-fc53b10d71da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd7f47f10>]}
[0m18:58:02.931712 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 7 tests, 3 sources, 0 exposures, 0 metrics, 430 macros, 0 groups, 0 semantic models
[0m18:58:02.932201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53feaa47-9b0b-49bd-87f5-fc53b10d71da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd823f970>]}
[0m18:58:02.934928 [info ] [MainThread]: 
[0m18:58:02.936030 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:58:02.937817 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m18:58:02.952306 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m18:58:02.952845 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m18:58:02.953323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:58:03.623278 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:58:03.627886 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m18:58:03.807188 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m18:58:03.811929 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m18:58:03.812364 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m18:58:03.812676 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:58:04.372711 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m18:58:04.377381 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m18:58:04.554567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '53feaa47-9b0b-49bd-87f5-fc53b10d71da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd72abf40>]}
[0m18:58:04.556699 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m18:58:04.557760 [info ] [MainThread]: 
[0m18:58:04.566241 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:58:04.567016 [info ] [Thread-1 (]: 1 of 7 START test accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m18:58:04.568037 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m18:58:04.568677 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:58:04.583497 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:58:04.585857 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 18:58:04.569037 => 18:58:04.585561
[0m18:58:04.586286 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:58:04.605327 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:58:04.608133 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m18:58:04.608837 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listing
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m18:58:04.609262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:05.272273 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:58:05.286267 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 18:58:04.586513 => 18:58:05.285889
[0m18:58:05.286908 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: Close
[0m18:58:05.473986 [info ] [Thread-1 (]: 1 of 7 PASS accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.91s]
[0m18:58:05.475816 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m18:58:05.476966 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m18:58:05.478147 [info ] [Thread-1 (]: 2 of 7 START test consistent_created_at ........................................ [RUN]
[0m18:58:05.479833 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.consistent_created_at)
[0m18:58:05.480817 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m18:58:05.487401 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m18:58:05.488429 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 18:58:05.481354 => 18:58:05.488082
[0m18:58:05.488891 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m18:58:05.491542 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.consistent_created_at"
[0m18:58:05.492442 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.consistent_created_at"
[0m18:58:05.492837 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.fct_reviews fr
left join AIRBNB.DEV.dim_listing dl
on dl.listing_id = fr.listing_id
where fr.review_date < dl.created_at
      
    ) dbt_internal_test
[0m18:58:05.493200 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:06.539381 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:58:06.543257 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 18:58:05.489176 => 18:58:06.543020
[0m18:58:06.543647 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: Close
[0m18:58:06.722320 [info ] [Thread-1 (]: 2 of 7 PASS consistent_created_at .............................................. [[32mPASS[0m in 1.24s]
[0m18:58:06.724512 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m18:58:06.725885 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m18:58:06.727116 [info ] [Thread-1 (]: 3 of 7 START test dim_listing_minimum .......................................... [RUN]
[0m18:58:06.728893 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.consistent_created_at, now test.dbtlearnnew.dim_listing_minimum)
[0m18:58:06.730021 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m18:58:06.736772 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m18:58:06.739908 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 18:58:06.730664 => 18:58:06.739554
[0m18:58:06.740409 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m18:58:06.743055 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.dim_listing_minimum"
[0m18:58:06.745136 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.dim_listing_minimum"
[0m18:58:06.745549 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.dim_listing_minimum"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from 
AIRBNB.DEV.dim_listing
where minimum_nights < 1 
limit 10
      
    ) dbt_internal_test
[0m18:58:06.745895 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.264778 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:58:07.270235 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 18:58:06.740691 => 18:58:07.269501
[0m18:58:07.271535 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: Close
[0m18:58:07.444244 [info ] [Thread-1 (]: 3 of 7 PASS dim_listing_minimum ................................................ [[32mPASS[0m in 0.72s]
[0m18:58:07.446154 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m18:58:07.447457 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:58:07.448779 [info ] [Thread-1 (]: 4 of 7 START test not_null_dim_listing_host_id ................................. [RUN]
[0m18:58:07.450516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m18:58:07.451587 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:58:07.460248 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:58:07.462572 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 18:58:07.452152 => 18:58:07.462244
[0m18:58:07.462991 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:58:07.466220 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:58:07.468643 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m18:58:07.469104 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listing
where host_id is null



      
    ) dbt_internal_test
[0m18:58:07.469453 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:07.968453 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m18:58:07.973882 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 18:58:07.463209 => 18:58:07.973123
[0m18:58:07.975179 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: Close
[0m18:58:08.154139 [info ] [Thread-1 (]: 4 of 7 PASS not_null_dim_listing_host_id ....................................... [[32mPASS[0m in 0.70s]
[0m18:58:08.156097 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m18:58:08.157428 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:58:08.158752 [info ] [Thread-1 (]: 5 of 7 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m18:58:08.160703 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m18:58:08.162027 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:58:08.171071 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:58:08.173699 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 18:58:08.162661 => 18:58:08.173355
[0m18:58:08.174170 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:58:08.176876 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:58:08.178977 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m18:58:08.179446 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m18:58:08.179926 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:12.940125 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m18:58:12.943291 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 18:58:08.174453 => 18:58:12.943038
[0m18:58:12.943737 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m18:58:13.212452 [info ] [Thread-1 (]: 5 of 7 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 5.05s]
[0m18:58:13.214531 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m18:58:13.215971 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:58:13.217548 [info ] [Thread-1 (]: 6 of 7 START test relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ... [RUN]
[0m18:58:13.219457 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m18:58:13.220573 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:58:13.233958 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:58:13.236513 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 18:58:13.221428 => 18:58:13.236105
[0m18:58:13.237155 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:58:13.239632 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:58:13.242687 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m18:58:13.243164 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listing
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m18:58:13.243521 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:13.772614 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:58:13.776293 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 18:58:13.237512 => 18:58:13.776053
[0m18:58:13.776681 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: Close
[0m18:58:13.954961 [info ] [Thread-1 (]: 6 of 7 PASS relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ......... [[32mPASS[0m in 0.74s]
[0m18:58:13.956746 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m18:58:13.957991 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:58:13.959220 [info ] [Thread-1 (]: 7 of 7 START test unique_dim_listing_listing_id ................................ [RUN]
[0m18:58:13.960919 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m18:58:13.961976 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:58:13.973224 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:58:13.975652 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 18:58:13.962535 => 18:58:13.975328
[0m18:58:13.976076 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:58:13.978686 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:58:13.981854 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m18:58:13.982597 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:58:13.983243 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:58:14.585034 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m18:58:14.590726 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 18:58:13.976323 => 18:58:14.589962
[0m18:58:14.592004 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m18:58:14.785325 [info ] [Thread-1 (]: 7 of 7 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 0.82s]
[0m18:58:14.787367 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m18:58:14.791128 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:58:14.792099 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m18:58:14.793070 [info ] [MainThread]: 
[0m18:58:14.794125 [info ] [MainThread]: Finished running 7 tests in 0 hours 0 minutes and 11.86 seconds (11.86s).
[0m18:58:14.797700 [debug] [MainThread]: Command end result
[0m18:58:14.810638 [info ] [MainThread]: 
[0m18:58:14.811105 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:58:14.811461 [info ] [MainThread]: 
[0m18:58:14.811783 [info ] [MainThread]: Done. PASS=7 WARN=0 ERROR=0 SKIP=0 TOTAL=7
[0m18:58:14.815248 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 13.935495, "process_user_time": 2.891319, "process_kernel_time": 0.152391, "process_mem_max_rss": "121276", "process_out_blocks": "2968", "process_in_blocks": "0"}
[0m18:58:14.815889 [debug] [MainThread]: Command `dbt test` succeeded at 18:58:14.815749 after 13.94 seconds
[0m18:58:14.816258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcddad7f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd734ba90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fcdd816cdc0>]}
[0m18:58:14.816625 [debug] [MainThread]: Flushing usage events
[0m19:14:18.976318 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9a005973a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99feaee6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99feaee650>]}


============================== 19:14:18.978639 | 9d09515f-28b5-4877-9ea3-25352e1a9e9d ==============================
[0m19:14:18.978639 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:14:18.979220 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select dim_listing', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:19.275244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d09515f-28b5-4877-9ea3-25352e1a9e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99feaee7a0>]}
[0m19:14:19.357858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d09515f-28b5-4877-9ea3-25352e1a9e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99feaa41f0>]}
[0m19:14:19.358613 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:14:19.367455 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:14:19.404575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m19:14:19.405586 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://tests/no_null_in_dimlisting.sql
[0m19:14:19.568822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d09515f-28b5-4877-9ea3-25352e1a9e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99fd5b1810>]}
[0m19:14:19.586431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d09515f-28b5-4877-9ea3-25352e1a9e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99fd857cd0>]}
[0m19:14:19.587214 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 8 tests, 3 sources, 0 exposures, 0 metrics, 431 macros, 0 groups, 0 semantic models
[0m19:14:19.587716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d09515f-28b5-4877-9ea3-25352e1a9e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99fd857fd0>]}
[0m19:14:19.590081 [info ] [MainThread]: 
[0m19:14:19.591152 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:19.592763 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m19:14:19.609909 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:14:19.610411 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:14:19.610754 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:20.394079 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:14:20.400877 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:14:20.587889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:14:20.598731 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:14:20.599826 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:14:20.600380 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:14:21.124100 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:14:21.127536 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:14:21.316603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d09515f-28b5-4877-9ea3-25352e1a9e9d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99fd4c77c0>]}
[0m19:14:21.317759 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:14:21.318385 [info ] [MainThread]: 
[0m19:14:21.336262 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:14:21.336820 [info ] [Thread-1 (]: 1 of 8 START test accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m19:14:21.337673 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m19:14:21.338121 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:14:21.361190 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:14:21.368737 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 19:14:21.338417 => 19:14:21.367210
[0m19:14:21.369468 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:14:21.388182 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:14:21.389634 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:14:21.390106 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listing
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m19:14:21.390487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:21.912930 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:21.930278 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 19:14:21.369797 => 19:14:21.929352
[0m19:14:21.931440 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: Close
[0m19:14:22.108701 [info ] [Thread-1 (]: 1 of 8 PASS accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.77s]
[0m19:14:22.109978 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:14:22.110857 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m19:14:22.111827 [info ] [Thread-1 (]: 2 of 8 START test consistent_created_at ........................................ [RUN]
[0m19:14:22.112852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.consistent_created_at)
[0m19:14:22.113425 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m19:14:22.117493 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m19:14:22.118349 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 19:14:22.113720 => 19:14:22.118088
[0m19:14:22.118720 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m19:14:22.121032 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.consistent_created_at"
[0m19:14:22.122257 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.consistent_created_at"
[0m19:14:22.122722 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.fct_reviews fr
left join AIRBNB.DEV.dim_listing dl
on dl.listing_id = fr.listing_id
where fr.review_date < dl.created_at
      
    ) dbt_internal_test
[0m19:14:22.123123 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:22.683311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:22.688246 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 19:14:22.118939 => 19:14:22.687675
[0m19:14:22.689330 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: Close
[0m19:14:22.882064 [info ] [Thread-1 (]: 2 of 8 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.77s]
[0m19:14:22.885182 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m19:14:22.887131 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m19:14:22.888791 [info ] [Thread-1 (]: 3 of 8 START test dim_listing_minimum .......................................... [RUN]
[0m19:14:22.890450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.consistent_created_at, now test.dbtlearnnew.dim_listing_minimum)
[0m19:14:22.891193 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m19:14:22.894850 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m19:14:22.898761 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 19:14:22.891526 => 19:14:22.898267
[0m19:14:22.899446 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m19:14:22.901813 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.dim_listing_minimum"
[0m19:14:22.904164 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.dim_listing_minimum"
[0m19:14:22.904692 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.dim_listing_minimum"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from 
AIRBNB.DEV.dim_listing
where minimum_nights < 1 
limit 10
      
    ) dbt_internal_test
[0m19:14:22.905071 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:23.501771 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:23.506410 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 19:14:22.899760 => 19:14:23.505821
[0m19:14:23.507435 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: Close
[0m19:14:23.680958 [info ] [Thread-1 (]: 3 of 8 PASS dim_listing_minimum ................................................ [[32mPASS[0m in 0.79s]
[0m19:14:23.683642 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m19:14:23.685478 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.no_null_in_dimlisting
[0m19:14:23.686937 [info ] [Thread-1 (]: 4 of 8 START test no_null_in_dimlisting ........................................ [RUN]
[0m19:14:23.688556 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.no_null_in_dimlisting)
[0m19:14:23.689585 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.no_null_in_dimlisting
[0m19:14:23.702141 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:14:23.702671 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
describe table AIRBNB.DEV.dim_listing
[0m19:14:23.703042 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:24.293723 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.0 seconds
[0m19:14:24.297676 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:14:24.299338 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (compile): 19:14:23.690174 => 19:14:24.298688
[0m19:14:24.300224 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.no_null_in_dimlisting
[0m19:14:24.303915 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:14:24.305304 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:14:24.305855 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from AIRBNB.DEV.dim_listing where 
  LISTING_ID is null or
  LISTING_NAME is null or
  ROOM_TYPE is null or
  MINIMUM_NIGHTS is null or
  HOST_ID is null or
  PRICE is null or
  CREATED_AT is null or
  UPDATED_AT is null or
  
  FALSE

      
    ) dbt_internal_test
[0m19:14:24.746103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:14:24.752107 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (execute): 19:14:24.300642 => 19:14:24.751336
[0m19:14:24.753464 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: Close
[0m19:14:24.921537 [info ] [Thread-1 (]: 4 of 8 PASS no_null_in_dimlisting .............................................. [[32mPASS[0m in 1.23s]
[0m19:14:24.923061 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.no_null_in_dimlisting
[0m19:14:24.923979 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:14:24.924871 [info ] [Thread-1 (]: 5 of 8 START test not_null_dim_listing_host_id ................................. [RUN]
[0m19:14:24.926025 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.no_null_in_dimlisting, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m19:14:24.926566 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:14:24.935580 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:14:24.936434 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 19:14:24.926899 => 19:14:24.936151
[0m19:14:24.936807 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:14:24.938926 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:14:24.941584 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:14:24.942189 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listing
where host_id is null



      
    ) dbt_internal_test
[0m19:14:24.942646 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:25.476974 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:25.482456 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 19:14:24.937012 => 19:14:25.481840
[0m19:14:25.483479 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: Close
[0m19:14:25.664683 [info ] [Thread-1 (]: 5 of 8 PASS not_null_dim_listing_host_id ....................................... [[32mPASS[0m in 0.74s]
[0m19:14:25.666387 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:14:25.667365 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:14:25.668202 [info ] [Thread-1 (]: 6 of 8 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m19:14:25.669429 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m19:14:25.670218 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:14:25.674599 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:14:25.675442 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 19:14:25.670549 => 19:14:25.675178
[0m19:14:25.675823 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:14:25.678998 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:14:25.680222 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:14:25.680666 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m19:14:25.681020 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:26.207688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:26.209581 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 19:14:25.676035 => 19:14:26.209325
[0m19:14:26.210009 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m19:14:26.376239 [info ] [Thread-1 (]: 6 of 8 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 0.71s]
[0m19:14:26.378350 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:14:26.380114 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:14:26.381786 [info ] [Thread-1 (]: 7 of 8 START test relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ... [RUN]
[0m19:14:26.384192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m19:14:26.385453 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:14:26.411076 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:14:26.417376 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 19:14:26.386173 => 19:14:26.414655
[0m19:14:26.419554 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:14:26.425642 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:14:26.431422 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:14:26.432350 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listing
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:14:26.433130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:26.986867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:26.992726 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 19:14:26.420749 => 19:14:26.991970
[0m19:14:26.994410 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: Close
[0m19:14:27.436640 [info ] [Thread-1 (]: 7 of 8 PASS relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ......... [[32mPASS[0m in 1.05s]
[0m19:14:27.438601 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:14:27.439903 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:14:27.441033 [info ] [Thread-1 (]: 8 of 8 START test unique_dim_listing_listing_id ................................ [RUN]
[0m19:14:27.442740 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m19:14:27.443973 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:14:27.453405 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:14:27.454396 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 19:14:27.444433 => 19:14:27.454101
[0m19:14:27.454818 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:14:27.457122 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:14:27.458052 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:14:27.458445 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:14:27.458845 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:14:28.173094 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:14:28.177219 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 19:14:27.455049 => 19:14:28.176653
[0m19:14:28.178882 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m19:14:28.358307 [info ] [Thread-1 (]: 8 of 8 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 0.92s]
[0m19:14:28.359926 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:14:28.363300 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:28.364176 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m19:14:28.364898 [info ] [MainThread]: 
[0m19:14:28.365510 [info ] [MainThread]: Finished running 8 tests in 0 hours 0 minutes and 8.77 seconds (8.77s).
[0m19:14:28.367201 [debug] [MainThread]: Command end result
[0m19:14:28.382970 [info ] [MainThread]: 
[0m19:14:28.383960 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:28.384450 [info ] [MainThread]: 
[0m19:14:28.384925 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=0 SKIP=0 TOTAL=8
[0m19:14:28.386219 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 9.447765, "process_user_time": 3.00284, "process_kernel_time": 0.109597, "process_mem_max_rss": "121824", "process_out_blocks": "2984", "process_in_blocks": "0"}
[0m19:14:28.387103 [debug] [MainThread]: Command `dbt test` succeeded at 19:14:28.386890 after 9.45 seconds
[0m19:14:28.387644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b9a005973a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99feaa41f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7b99fcbc3bb0>]}
[0m19:14:28.388212 [debug] [MainThread]: Flushing usage events
[0m19:18:56.565367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd642e6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd6412fe590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd6412fe530>]}


============================== 19:18:56.567713 | bebbd49b-a8c6-4f47-96cb-44efe4778275 ==============================
[0m19:18:56.567713 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:18:56.568246 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m19:18:56.841006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bebbd49b-a8c6-4f47-96cb-44efe4778275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd6404fbd30>]}
[0m19:18:56.917948 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bebbd49b-a8c6-4f47-96cb-44efe4778275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd6403640d0>]}
[0m19:18:56.918739 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:18:56.925001 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:18:56.959229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:18:56.959850 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:18:56.967382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bebbd49b-a8c6-4f47-96cb-44efe4778275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd63fe880d0>]}
[0m19:18:57.033850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bebbd49b-a8c6-4f47-96cb-44efe4778275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd64025d090>]}
[0m19:18:57.034426 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:18:57.034842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bebbd49b-a8c6-4f47-96cb-44efe4778275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd643627a90>]}
[0m19:18:57.036637 [info ] [MainThread]: 
[0m19:18:57.037408 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:18:57.038581 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m19:18:57.054399 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:18:57.054951 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:18:57.055317 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:57.691929 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:18:57.696988 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:18:57.861616 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:18:57.870681 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:18:57.871174 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:18:57.871548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:18:58.368503 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 0.0 seconds
[0m19:18:58.373205 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:18:58.555509 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bebbd49b-a8c6-4f47-96cb-44efe4778275', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd6400364d0>]}
[0m19:18:58.557322 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:18:58.558126 [info ] [MainThread]: 
[0m19:18:58.560997 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:18:58.561839 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m19:18:58.563240 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m19:18:58.563852 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:18:58.578811 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:18:58.580096 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 19:18:58.564151 => 19:18:58.579717
[0m19:18:58.581013 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:18:58.598887 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:18:58.600120 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:18:58.600598 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listing
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m19:18:58.601039 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:59.252208 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:18:59.260959 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 19:18:58.581404 => 19:18:59.260687
[0m19:18:59.261552 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: Close
[0m19:18:59.428121 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.87s]
[0m19:18:59.430492 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:18:59.432005 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m19:18:59.433137 [info ] [Thread-1 (]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m19:18:59.434146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.consistent_created_at)
[0m19:18:59.434774 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m19:18:59.437906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m19:18:59.440131 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 19:18:59.435081 => 19:18:59.439808
[0m19:18:59.440564 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m19:18:59.442850 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.consistent_created_at"
[0m19:18:59.445528 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.consistent_created_at"
[0m19:18:59.446299 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.fct_reviews fr
left join AIRBNB.DEV.dim_listing dl
on dl.listing_id = fr.listing_id
where fr.review_date < dl.created_at
      
    ) dbt_internal_test
[0m19:18:59.447070 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:18:59.953928 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:18:59.958053 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 19:18:59.440820 => 19:18:59.957471
[0m19:18:59.958992 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: Close
[0m19:19:00.138681 [info ] [Thread-1 (]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.70s]
[0m19:19:00.140025 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m19:19:00.140889 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m19:19:00.141726 [info ] [Thread-1 (]: 3 of 9 START test dim_listing_minimum .......................................... [RUN]
[0m19:19:00.142701 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.consistent_created_at, now test.dbtlearnnew.dim_listing_minimum)
[0m19:19:00.143286 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m19:19:00.147639 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m19:19:00.148587 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 19:19:00.143632 => 19:19:00.148258
[0m19:19:00.148970 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m19:19:00.151708 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.dim_listing_minimum"
[0m19:19:00.154333 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.dim_listing_minimum"
[0m19:19:00.154911 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.dim_listing_minimum"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from 
AIRBNB.DEV.dim_listing
where minimum_nights < 1 
limit 10
      
    ) dbt_internal_test
[0m19:19:00.155330 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:00.638569 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:19:00.643142 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 19:19:00.149182 => 19:19:00.642580
[0m19:19:00.644134 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: Close
[0m19:19:00.815973 [info ] [Thread-1 (]: 3 of 9 PASS dim_listing_minimum ................................................ [[32mPASS[0m in 0.67s]
[0m19:19:00.817868 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m19:19:00.819066 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.no_null_in_dimlisting
[0m19:19:00.820011 [info ] [Thread-1 (]: 4 of 9 START test no_null_in_dimlisting ........................................ [RUN]
[0m19:19:00.821450 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.no_null_in_dimlisting)
[0m19:19:00.822115 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.no_null_in_dimlisting
[0m19:19:00.834883 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:19:00.835371 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
describe table AIRBNB.DEV.dim_listing
[0m19:19:00.835750 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:01.418467 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.0 seconds
[0m19:19:01.424999 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:19:01.426580 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (compile): 19:19:00.822504 => 19:19:01.426112
[0m19:19:01.427122 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.no_null_in_dimlisting
[0m19:19:01.430981 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:19:01.434072 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:19:01.434605 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from AIRBNB.DEV.dim_listing where 
  LISTING_ID is null or
  LISTING_NAME is null or
  ROOM_TYPE is null or
  MINIMUM_NIGHTS is null or
  HOST_ID is null or
  PRICE is null or
  CREATED_AT is null or
  UPDATED_AT is null or
  
  FALSE

      
    ) dbt_internal_test
[0m19:19:01.560446 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:19:01.565189 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (execute): 19:19:01.427429 => 19:19:01.564254
[0m19:19:01.566459 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: Close
[0m19:19:01.739110 [info ] [Thread-1 (]: 4 of 9 PASS no_null_in_dimlisting .............................................. [[32mPASS[0m in 0.92s]
[0m19:19:01.740567 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.no_null_in_dimlisting
[0m19:19:01.741640 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:19:01.742584 [info ] [Thread-1 (]: 5 of 9 START test not_null_dim_listing_host_id ................................. [RUN]
[0m19:19:01.744003 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.no_null_in_dimlisting, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m19:19:01.744672 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:19:01.753627 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:19:01.755898 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 19:19:01.745056 => 19:19:01.755582
[0m19:19:01.756315 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:19:01.759649 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:19:01.760850 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:19:01.761665 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listing
where host_id is null



      
    ) dbt_internal_test
[0m19:19:01.762092 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:02.394799 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:19:02.401015 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 19:19:01.756536 => 19:19:02.400337
[0m19:19:02.402270 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: Close
[0m19:19:02.572512 [info ] [Thread-1 (]: 5 of 9 PASS not_null_dim_listing_host_id ....................................... [[32mPASS[0m in 0.83s]
[0m19:19:02.574433 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:19:02.575755 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:19:02.577008 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m19:19:02.578520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m19:19:02.580276 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:19:02.587356 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:19:02.589624 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 19:19:02.581165 => 19:19:02.589277
[0m19:19:02.590050 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:19:02.592356 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:19:02.594852 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:19:02.595397 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m19:19:02.595781 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:03.085324 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:19:03.090215 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 19:19:02.590290 => 19:19:03.089502
[0m19:19:03.091481 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m19:19:03.260601 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 0.68s]
[0m19:19:03.261370 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:19:03.261889 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:19:03.262479 [info ] [Thread-1 (]: 7 of 9 START test positive_value_dim_listing_minimum_nights .................... [RUN]
[0m19:19:03.263250 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5)
[0m19:19:03.263783 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:19:03.268469 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m19:19:03.269552 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (compile): 19:19:03.264001 => 19:19:03.269096
[0m19:19:03.270466 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:19:03.273436 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m19:19:03.274530 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m19:19:03.275110 [debug] [Thread-1 (]: On test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from AIRBNB.DEV.dim_listing
where minimum_nights < 1 

      
    ) dbt_internal_test
[0m19:19:03.275796 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:03.795455 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:19:03.800584 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (execute): 19:19:03.270744 => 19:19:03.799972
[0m19:19:03.801569 [debug] [Thread-1 (]: On test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5: Close
[0m19:19:03.969388 [info ] [Thread-1 (]: 7 of 9 PASS positive_value_dim_listing_minimum_nights .......................... [[32mPASS[0m in 0.71s]
[0m19:19:03.970988 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:19:03.971860 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:19:03.972637 [info ] [Thread-1 (]: 8 of 9 START test relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ... [RUN]
[0m19:19:03.973762 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m19:19:03.974407 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:19:03.982872 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:19:03.983898 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 19:19:03.974717 => 19:19:03.983595
[0m19:19:03.984344 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:19:03.986838 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:19:03.988183 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:19:03.988594 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listing
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:19:03.988945 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:04.505494 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:19:04.508740 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 19:19:03.984590 => 19:19:04.508365
[0m19:19:04.509437 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: Close
[0m19:19:04.684980 [info ] [Thread-1 (]: 8 of 9 PASS relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ......... [[32mPASS[0m in 0.71s]
[0m19:19:04.686690 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:19:04.687446 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:19:04.688195 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_listing_listing_id ................................ [RUN]
[0m19:19:04.689285 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m19:19:04.689777 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:19:04.695690 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:19:04.699467 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 19:19:04.690050 => 19:19:04.699131
[0m19:19:04.699905 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:19:04.702196 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:19:04.704816 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:19:04.705500 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:19:04.706107 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:19:05.228766 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:19:05.231755 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 19:19:04.700130 => 19:19:05.231489
[0m19:19:05.232214 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m19:19:05.421946 [info ] [Thread-1 (]: 9 of 9 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 0.73s]
[0m19:19:05.423559 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:19:05.427230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:05.428167 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m19:19:05.428981 [info ] [MainThread]: 
[0m19:19:05.430803 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 8.39 seconds (8.39s).
[0m19:19:05.434504 [debug] [MainThread]: Command end result
[0m19:19:05.444328 [info ] [MainThread]: 
[0m19:19:05.445009 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:05.445498 [info ] [MainThread]: 
[0m19:19:05.445971 [info ] [MainThread]: Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
[0m19:19:05.447225 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 8.918451, "process_user_time": 2.865885, "process_kernel_time": 0.141456, "process_mem_max_rss": "119724", "process_out_blocks": "2120", "process_in_blocks": "0"}
[0m19:19:05.447841 [debug] [MainThread]: Command `dbt test` succeeded at 19:19:05.447709 after 8.92 seconds
[0m19:19:05.448384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd642e6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd64025fe20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7cd643626a70>]}
[0m19:19:05.448768 [debug] [MainThread]: Flushing usage events
[0m19:20:18.298773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa8082a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa6516620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa65165c0>]}


============================== 19:20:18.301020 | 2f544aff-b6bf-4255-8231-181a0f6bee5c ==============================
[0m19:20:18.301020 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:20:18.301520 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:18.526869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2f544aff-b6bf-4255-8231-181a0f6bee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa6516710>]}
[0m19:20:18.594275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2f544aff-b6bf-4255-8231-181a0f6bee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa54463e0>]}
[0m19:20:18.595066 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:20:18.600767 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:20:18.630394 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:20:18.630800 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:20:18.635840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2f544aff-b6bf-4255-8231-181a0f6bee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa50a00d0>]}
[0m19:20:18.689817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2f544aff-b6bf-4255-8231-181a0f6bee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa53b6e60>]}
[0m19:20:18.690586 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:20:18.691075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f544aff-b6bf-4255-8231-181a0f6bee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa5545690>]}
[0m19:20:18.693585 [info ] [MainThread]: 
[0m19:20:18.694656 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:18.696178 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m19:20:18.708552 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:20:18.708985 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:20:18.709350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:19.483281 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:20:19.486901 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:20:19.664384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:20:19.675522 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:20:19.676651 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:20:19.677684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:20.480198 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:20:20.484741 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:20:20.657903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2f544aff-b6bf-4255-8231-181a0f6bee5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa524e5f0>]}
[0m19:20:20.660020 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:20:20.661139 [info ] [MainThread]: 
[0m19:20:20.665802 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:20:20.667110 [info ] [Thread-1 (]: 1 of 9 START test accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [RUN]
[0m19:20:20.668617 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m19:20:20.669597 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:20:20.686863 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:20:20.689330 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 19:20:20.670123 => 19:20:20.688984
[0m19:20:20.689759 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:20:20.706365 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:20:20.709196 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m19:20:20.709922 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with all_values as (

    select
        room_type as value_field,
        count(*) as n_records

    from AIRBNB.DEV.dim_listing
    group by room_type

)

select *
from all_values
where value_field not in (
    'Entire home/apt','Private room','Shared room','Hotel room'
)



      
    ) dbt_internal_test
[0m19:20:20.710359 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:21.253159 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:20:21.260076 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 19:20:20.689977 => 19:20:21.259823
[0m19:20:21.260511 [debug] [Thread-1 (]: On test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08: Close
[0m19:20:21.430890 [info ] [Thread-1 (]: 1 of 9 PASS accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room  [[32mPASS[0m in 0.76s]
[0m19:20:21.433015 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m19:20:21.434442 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m19:20:21.435881 [info ] [Thread-1 (]: 2 of 9 START test consistent_created_at ........................................ [RUN]
[0m19:20:21.437728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.consistent_created_at)
[0m19:20:21.438864 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m19:20:21.446177 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m19:20:21.449456 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 19:20:21.439536 => 19:20:21.448983
[0m19:20:21.450110 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m19:20:21.453429 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.consistent_created_at"
[0m19:20:21.454503 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.consistent_created_at"
[0m19:20:21.454909 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.consistent_created_at"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from AIRBNB.DEV.fct_reviews fr
left join AIRBNB.DEV.dim_listing dl
on dl.listing_id = fr.listing_id
where fr.review_date < dl.created_at
      
    ) dbt_internal_test
[0m19:20:21.455267 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:21.955445 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:20:21.960629 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 19:20:21.450586 => 19:20:21.959856
[0m19:20:21.961998 [debug] [Thread-1 (]: On test.dbtlearnnew.consistent_created_at: Close
[0m19:20:22.137777 [info ] [Thread-1 (]: 2 of 9 PASS consistent_created_at .............................................. [[32mPASS[0m in 0.70s]
[0m19:20:22.138432 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m19:20:22.138823 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m19:20:22.139202 [info ] [Thread-1 (]: 3 of 9 START test dim_listing_minimum .......................................... [RUN]
[0m19:20:22.139749 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.consistent_created_at, now test.dbtlearnnew.dim_listing_minimum)
[0m19:20:22.140083 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m19:20:22.143144 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m19:20:22.145287 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 19:20:22.140275 => 19:20:22.144995
[0m19:20:22.145679 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m19:20:22.147819 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.dim_listing_minimum"
[0m19:20:22.148753 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.dim_listing_minimum"
[0m19:20:22.149280 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.dim_listing_minimum"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      select * from 
AIRBNB.DEV.dim_listing
where minimum_nights < 1 
limit 10
      
    ) dbt_internal_test
[0m19:20:22.149758 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:22.733448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:20:22.738812 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 19:20:22.145889 => 19:20:22.738024
[0m19:20:22.740164 [debug] [Thread-1 (]: On test.dbtlearnnew.dim_listing_minimum: Close
[0m19:20:22.916384 [info ] [Thread-1 (]: 3 of 9 PASS dim_listing_minimum ................................................ [[32mPASS[0m in 0.78s]
[0m19:20:22.918393 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m19:20:22.919770 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.no_null_in_dimlisting
[0m19:20:22.920917 [info ] [Thread-1 (]: 4 of 9 START test no_null_in_dimlisting ........................................ [RUN]
[0m19:20:22.922930 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.no_null_in_dimlisting)
[0m19:20:22.924146 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.no_null_in_dimlisting
[0m19:20:22.939009 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:20:22.939483 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
describe table AIRBNB.DEV.dim_listing
[0m19:20:22.939827 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:23.419959 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.0 seconds
[0m19:20:23.425007 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:20:23.430913 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (compile): 19:20:22.924824 => 19:20:23.430038
[0m19:20:23.432114 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.no_null_in_dimlisting
[0m19:20:23.436660 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:20:23.438253 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m19:20:23.438902 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  select * from AIRBNB.DEV.dim_listing where 
  LISTING_ID is null or
  LISTING_NAME is null or
  ROOM_TYPE is null or
  MINIMUM_NIGHTS is null or
  HOST_ID is null or
  PRICE is null or
  CREATED_AT is null or
  UPDATED_AT is null or
  
  FALSE

      
    ) dbt_internal_test
[0m19:20:23.538161 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:20:23.544113 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (execute): 19:20:23.432831 => 19:20:23.543306
[0m19:20:23.545457 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: Close
[0m19:20:23.711977 [info ] [Thread-1 (]: 4 of 9 PASS no_null_in_dimlisting .............................................. [[32mPASS[0m in 0.79s]
[0m19:20:23.714006 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.no_null_in_dimlisting
[0m19:20:23.715310 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:20:23.716475 [info ] [Thread-1 (]: 5 of 9 START test not_null_dim_listing_host_id ................................. [RUN]
[0m19:20:23.718510 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.no_null_in_dimlisting, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m19:20:23.719645 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:20:23.730125 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:20:23.732469 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 19:20:23.720291 => 19:20:23.732126
[0m19:20:23.732927 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:20:23.735202 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:20:23.737555 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m19:20:23.738177 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select host_id
from AIRBNB.DEV.dim_listing
where host_id is null



      
    ) dbt_internal_test
[0m19:20:23.738590 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:24.289527 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:20:24.295084 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 19:20:23.733192 => 19:20:24.294370
[0m19:20:24.296135 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc: Close
[0m19:20:24.482089 [info ] [Thread-1 (]: 5 of 9 PASS not_null_dim_listing_host_id ....................................... [[32mPASS[0m in 0.76s]
[0m19:20:24.483958 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m19:20:24.485285 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:20:24.486586 [info ] [Thread-1 (]: 6 of 9 START test not_null_dim_listing_listing_id .............................. [RUN]
[0m19:20:24.488413 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m19:20:24.489547 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:20:24.498303 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:20:24.499518 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 19:20:24.490217 => 19:20:24.499090
[0m19:20:24.500099 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:20:24.502545 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:20:24.504908 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m19:20:24.505381 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select listing_id
from AIRBNB.DEV.dim_listing
where listing_id is null



      
    ) dbt_internal_test
[0m19:20:24.505754 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:24.971335 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:20:24.976612 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 19:20:24.500335 => 19:20:24.975845
[0m19:20:24.977946 [debug] [Thread-1 (]: On test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335: Close
[0m19:20:25.140094 [info ] [Thread-1 (]: 6 of 9 PASS not_null_dim_listing_listing_id .................................... [[32mPASS[0m in 0.65s]
[0m19:20:25.141729 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m19:20:25.142815 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:20:25.143774 [info ] [Thread-1 (]: 7 of 9 START test positive_value_dim_listing_minimum_nights .................... [RUN]
[0m19:20:25.144827 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5)
[0m19:20:25.145483 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:20:25.150525 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m19:20:25.151291 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (compile): 19:20:25.145861 => 19:20:25.151047
[0m19:20:25.151666 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:20:25.154088 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m19:20:25.155035 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m19:20:25.155412 [debug] [Thread-1 (]: On test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select * from AIRBNB.DEV.dim_listing
where minimum_nights > 1 

      
    ) dbt_internal_test
[0m19:20:25.155755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:26.083006 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:20:26.086590 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (execute): 19:20:25.151878 => 19:20:26.086345
[0m19:20:26.087011 [debug] [Thread-1 (]: On test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5: Close
[0m19:20:26.277183 [error] [Thread-1 (]: 7 of 9 FAIL 13454 positive_value_dim_listing_minimum_nights .................... [[31mFAIL 13454[0m in 1.13s]
[0m19:20:26.279273 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m19:20:26.280731 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:20:26.282164 [info ] [Thread-1 (]: 8 of 9 START test relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ... [RUN]
[0m19:20:26.284075 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m19:20:26.285233 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:20:26.297418 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:20:26.300160 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 19:20:26.285890 => 19:20:26.299705
[0m19:20:26.300807 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:20:26.303196 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:20:26.305792 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m19:20:26.306298 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with child as (
    select host_id as from_field
    from AIRBNB.DEV.dim_listing
    where host_id is not null
),

parent as (
    select host_id as to_field
    from AIRBNB.DEV.dim_hosts
)

select
    from_field

from child
left join parent
    on child.from_field = parent.to_field

where parent.to_field is null



      
    ) dbt_internal_test
[0m19:20:26.306661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:27.482674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:20:27.487740 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 19:20:26.301175 => 19:20:27.487012
[0m19:20:27.489034 [debug] [Thread-1 (]: On test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e: Close
[0m19:20:27.677256 [info ] [Thread-1 (]: 8 of 9 PASS relationships_dim_listing_host_id__host_id__ref_dim_hosts_ ......... [[32mPASS[0m in 1.39s]
[0m19:20:27.679368 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m19:20:27.680754 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:20:27.682139 [info ] [Thread-1 (]: 9 of 9 START test unique_dim_listing_listing_id ................................ [RUN]
[0m19:20:27.683987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m19:20:27.685141 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:20:27.695684 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:20:27.698321 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 19:20:27.685801 => 19:20:27.698019
[0m19:20:27.698758 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:20:27.701227 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:20:27.702639 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m19:20:27.703033 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    listing_id as unique_field,
    count(*) as n_records

from AIRBNB.DEV.dim_listing
where listing_id is not null
group by listing_id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:20:27.703364 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:20:28.181293 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:20:28.186514 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 19:20:27.698991 => 19:20:28.185713
[0m19:20:28.187842 [debug] [Thread-1 (]: On test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61: Close
[0m19:20:28.362494 [info ] [Thread-1 (]: 9 of 9 PASS unique_dim_listing_listing_id ...................................... [[32mPASS[0m in 0.68s]
[0m19:20:28.363150 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m19:20:28.364340 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:28.364647 [debug] [MainThread]: Connection 'test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61' was properly closed.
[0m19:20:28.364954 [info ] [MainThread]: 
[0m19:20:28.365283 [info ] [MainThread]: Finished running 9 tests in 0 hours 0 minutes and 9.67 seconds (9.67s).
[0m19:20:28.366597 [debug] [MainThread]: Command end result
[0m19:20:28.376600 [info ] [MainThread]: 
[0m19:20:28.377272 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:20:28.377761 [info ] [MainThread]: 
[0m19:20:28.378231 [error] [MainThread]: [31mFailure in test positive_value_dim_listing_minimum_nights (models/schema.yaml)[0m
[0m19:20:28.378650 [error] [MainThread]:   Got 13454 results, configured to fail if != 0
[0m19:20:28.379056 [info ] [MainThread]: 
[0m19:20:28.379464 [info ] [MainThread]:   compiled Code at target/compiled/dbtlearnnew/models/schema.yaml/positive_value_dim_listing_minimum_nights.sql
[0m19:20:28.379905 [info ] [MainThread]: 
[0m19:20:28.380334 [info ] [MainThread]: Done. PASS=8 WARN=0 ERROR=1 SKIP=0 TOTAL=9
[0m19:20:28.381322 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 10.114951, "process_user_time": 2.724392, "process_kernel_time": 0.135621, "process_mem_max_rss": "119708", "process_out_blocks": "2128", "command_success": false, "process_in_blocks": "0"}
[0m19:20:28.382020 [debug] [MainThread]: Command `dbt test` failed at 19:20:28.381853 after 10.12 seconds
[0m19:20:28.382515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa8082a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa6516710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7befa56e5090>]}
[0m19:20:28.383013 [debug] [MainThread]: Flushing usage events
[0m19:29:37.108658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1178576a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1176a06620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1176a065c0>]}


============================== 19:29:37.110957 | 772d807b-276e-42ec-8161-5b4033be7dfd ==============================
[0m19:29:37.110957 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:29:37.111445 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:29:37.337631 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1176a06710>]}
[0m19:29:37.405364 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11759363e0>]}
[0m19:29:37.406113 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:29:37.411720 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:29:37.442842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:29:37.443269 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:29:37.448298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11755940d0>]}
[0m19:29:37.498602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11758a2e60>]}
[0m19:29:37.499352 [info ] [MainThread]: Found 1 seed, 8 models, 1 snapshot, 9 tests, 3 sources, 0 exposures, 0 metrics, 432 macros, 0 groups, 0 semantic models
[0m19:29:37.499864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1175a39690>]}
[0m19:29:37.501969 [info ] [MainThread]: 
[0m19:29:37.502883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:29:37.504283 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:29:37.519756 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:29:37.520336 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:29:37.520756 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:29:38.170432 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:29:38.174407 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:29:38.349358 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m19:29:38.359087 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:29:38.359671 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:29:38.359990 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:38.978271 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:29:38.982722 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:29:39.172816 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:29:39.185353 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:29:39.186628 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:29:39.187501 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:29:39.878380 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:29:39.883129 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:29:40.058507 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11755dfdc0>]}
[0m19:29:40.060570 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:29:40.061707 [info ] [MainThread]: 
[0m19:29:40.065165 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m19:29:40.066368 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m19:29:40.067126 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m19:29:40.075235 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m19:29:40.077491 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 19:29:40.067501 => 19:29:40.077173
[0m19:29:40.078401 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m19:29:40.078853 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m19:29:40.079472 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m19:29:40.079861 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m19:29:40.082285 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m19:29:40.084526 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 19:29:40.080078 => 19:29:40.084115
[0m19:29:40.085794 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m19:29:40.086254 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m19:29:40.086871 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m19:29:40.087285 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m19:29:40.090536 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m19:29:40.094037 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 19:29:40.087554 => 19:29:40.093282
[0m19:29:40.095312 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m19:29:40.095733 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m19:29:40.096218 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m19:29:40.096867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m19:29:40.097203 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m19:29:40.100748 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m19:29:40.102922 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 19:29:40.097398 => 19:29:40.102642
[0m19:29:40.103307 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m19:29:40.126596 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m19:29:40.129278 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m19:29:40.129750 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
          AIRBNB.raw.raw_hosts
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m19:29:40.130131 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:41.725228 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m19:29:41.753139 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 19:29:40.103507 => 19:29:41.752939
[0m19:29:41.753598 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m19:29:41.918198 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1175580970>]}
[0m19:29:41.920016 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.82s]
[0m19:29:41.921855 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m19:29:41.923260 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m19:29:41.924663 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m19:29:41.926594 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m19:29:41.927561 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m19:29:41.936458 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m19:29:41.938964 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 19:29:41.928161 => 19:29:41.938654
[0m19:29:41.939362 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m19:29:41.941807 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m19:29:41.944705 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m19:29:41.945206 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m19:29:41.945599 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:43.229065 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:29:43.235420 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 19:29:41.939573 => 19:29:43.234824
[0m19:29:43.236585 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m19:29:43.409219 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11754fc7f0>]}
[0m19:29:43.411118 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 1.48s]
[0m19:29:43.413046 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m19:29:43.414438 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m19:29:43.416003 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:29:43.418073 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m19:29:43.419049 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m19:29:43.429044 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 19:29:43.419629 => 19:29:43.428724
[0m19:29:43.462772 [debug] [Thread-1 (]: Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:29:43.463309 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1174bba9e0>]}
[0m19:29:43.463854 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model DEV.fct_reviews .................... [[31mERROR[0m in 0.05s]
[0m19:29:43.464310 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m19:29:43.464691 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m19:29:43.465261 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m19:29:43.465859 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m19:29:43.466206 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m19:29:43.468811 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m19:29:43.471795 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 19:29:43.466404 => 19:29:43.471403
[0m19:29:43.472231 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m19:29:43.476549 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m19:29:43.479259 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m19:29:43.479761 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m19:29:43.480142 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:29:44.805934 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:29:44.812025 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 19:29:43.472443 => 19:29:44.811399
[0m19:29:44.813490 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m19:29:44.993478 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '772d807b-276e-42ec-8161-5b4033be7dfd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1174c2df60>]}
[0m19:29:44.995387 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.53s]
[0m19:29:44.997421 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m19:29:44.998684 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m19:29:45.000256 [info ] [Thread-1 (]: 5 of 5 SKIP relation DEV.mart_full_moon ........................................ [[33mSKIP[0m]
[0m19:29:45.001789 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m19:29:45.005297 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:29:45.006282 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listings_w_hosts' was properly closed.
[0m19:29:45.007313 [info ] [MainThread]: 
[0m19:29:45.008369 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 7.50 seconds (7.50s).
[0m19:29:45.011806 [debug] [MainThread]: Command end result
[0m19:29:45.026072 [info ] [MainThread]: 
[0m19:29:45.026903 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:29:45.027566 [info ] [MainThread]: 
[0m19:29:45.028002 [error] [MainThread]:   Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  'dbt_utils' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m19:29:45.028371 [info ] [MainThread]: 
[0m19:29:45.028899 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:29:45.030449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 7.9546156, "process_user_time": 2.413981, "process_kernel_time": 0.12747, "process_mem_max_rss": "119732", "process_out_blocks": "2016", "command_success": false, "process_in_blocks": "0"}
[0m19:29:45.031040 [debug] [MainThread]: Command `dbt run` failed at 19:29:45.030861 after 7.96 seconds
[0m19:29:45.031416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c1178576a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11758a27a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c11759363e0>]}
[0m19:29:45.031759 [debug] [MainThread]: Flushing usage events
[0m19:30:05.046258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39427a6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3940c3a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3940c3a4a0>]}


============================== 19:30:05.049158 | 6a3b6827-b2e0-4b0f-80ce-01b68468db76 ==============================
[0m19:30:05.049158 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:30:05.049682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt deps', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:30:05.114311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a3b6827-b2e0-4b0f-80ce-01b68468db76', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3940bef4f0>]}
[0m19:30:05.114879 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:30:05.123421 [info ] [MainThread]: Warning: No packages were found in packages.yml
[0m19:30:05.124352 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.11093613, "process_user_time": 1.452759, "process_kernel_time": 0.080485, "process_mem_max_rss": "88216", "process_in_blocks": "8", "process_out_blocks": "0"}
[0m19:30:05.125045 [debug] [MainThread]: Command `dbt deps` succeeded at 19:30:05.124870 after 0.11 seconds
[0m19:30:05.125483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f39427a6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3940c3a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f3940c95d50>]}
[0m19:30:05.125857 [debug] [MainThread]: Flushing usage events
[0m19:30:34.947308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b725b7b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b72400a500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b72400a4a0>]}


============================== 19:30:34.949565 | 801bf88f-fdcd-4e79-bead-3a787f9671b5 ==============================
[0m19:30:34.949565 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:30:34.950078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt deps', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:30:35.015618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '801bf88f-fdcd-4e79-bead-3a787f9671b5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b72400a680>]}
[0m19:30:35.016497 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-w36iwks4'
[0m19:30:35.016934 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m19:30:36.770825 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m19:30:36.774126 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m19:30:36.888777 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m19:30:36.903950 [info ] [MainThread]: Updating lock file in file path: /home/kishanmahajan/Desktop/course/dbtlearnnew/package-lock.yml
[0m19:30:36.908162 [debug] [MainThread]: Set downloads directory='/tmp/dbt-downloads-ggdem0q9'
[0m19:30:36.910961 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m19:30:37.800829 [info ] [MainThread]: Installed from version 1.1.1
[0m19:30:37.801647 [info ] [MainThread]: Up to date!
[0m19:30:37.802620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '801bf88f-fdcd-4e79-bead-3a787f9671b5', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b724064a00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b726333a90>]}
[0m19:30:37.804119 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 2.88912, "process_user_time": 1.669792, "process_kernel_time": 0.103735, "process_mem_max_rss": "91380", "process_out_blocks": "2240", "process_in_blocks": "0"}
[0m19:30:37.804997 [debug] [MainThread]: Command `dbt deps` succeeded at 19:30:37.804788 after 2.89 seconds
[0m19:30:37.805515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b725b7b7f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b724009cf0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x73b7263329b0>]}
[0m19:30:37.806053 [debug] [MainThread]: Flushing usage events
[0m19:30:50.292085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c75a77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c5a3a620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c5a3a5c0>]}


============================== 19:30:50.294315 | ee0d3fad-2fa5-4328-a35f-b6cacb3a5244 ==============================
[0m19:30:50.294315 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:30:50.294847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:30:50.523104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c4a3a380>]}
[0m19:30:50.591357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c4a0c040>]}
[0m19:30:50.592156 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:30:50.603754 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:30:50.612307 [info ] [MainThread]: Unable to do partial parsing because a project dependency has been added
[0m19:30:50.612741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c4a7efe0>]}
[0m19:30:52.132237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bf7a4460>]}
[0m19:30:52.144693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c4ab9270>]}
[0m19:30:52.145525 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m19:30:52.146155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bfac3bb0>]}
[0m19:30:52.148459 [info ] [MainThread]: 
[0m19:30:52.149513 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:30:52.151093 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:30:52.165109 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:30:52.165540 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:30:52.165839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:30:52.816404 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:30:52.820268 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:30:53.019813 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m19:30:53.036311 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:30:53.036951 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:30:53.037392 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:53.687371 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:30:53.691963 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:30:53.884275 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:30:53.895151 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:30:53.896071 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:30:53.896833 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:30:54.471919 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:30:54.476490 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:30:54.667538 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bf772c20>]}
[0m19:30:54.669616 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:30:54.670666 [info ] [MainThread]: 
[0m19:30:54.675224 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m19:30:54.676658 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m19:30:54.677438 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m19:30:54.686730 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m19:30:54.687534 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 19:30:54.677948 => 19:30:54.687283
[0m19:30:54.688278 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m19:30:54.688670 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m19:30:54.689460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m19:30:54.689906 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m19:30:54.693166 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m19:30:54.693942 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 19:30:54.690160 => 19:30:54.693717
[0m19:30:54.694660 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m19:30:54.695029 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m19:30:54.695608 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m19:30:54.696010 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m19:30:54.698789 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m19:30:54.699671 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 19:30:54.696205 => 19:30:54.699381
[0m19:30:54.700627 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m19:30:54.701064 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m19:30:54.701668 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m19:30:54.702335 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m19:30:54.702693 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m19:30:54.706746 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m19:30:54.708963 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 19:30:54.702898 => 19:30:54.708663
[0m19:30:54.709361 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m19:30:54.731973 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m19:30:54.733465 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m19:30:54.733900 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
          AIRBNB.raw.raw_hosts
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m19:30:54.734266 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:55.961190 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:30:55.978887 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 19:30:54.709568 => 19:30:55.978687
[0m19:30:55.979334 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m19:30:56.172212 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bec3bbb0>]}
[0m19:30:56.174138 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 1.47s]
[0m19:30:56.176014 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m19:30:56.177343 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m19:30:56.178792 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m19:30:56.180671 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m19:30:56.181903 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m19:30:56.192659 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m19:30:56.195319 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 19:30:56.182576 => 19:30:56.194979
[0m19:30:56.195760 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m19:30:56.198408 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m19:30:56.199628 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m19:30:56.200057 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m19:30:56.200410 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:57.450931 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:30:57.457429 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 19:30:56.195999 => 19:30:57.456763
[0m19:30:57.458621 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m19:30:57.685755 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bf7840d0>]}
[0m19:30:57.687685 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 1.51s]
[0m19:30:57.689544 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m19:30:57.690789 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m19:30:57.692272 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:30:57.694353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m19:30:57.695544 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m19:30:57.710653 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:30:57.713400 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 19:30:57.696211 => 19:30:57.713056
[0m19:30:57.713832 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m19:30:57.742739 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m19:30:57.743249 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id

from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m19:30:57.743631 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:30:58.470056 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b355c8-3201-0a9b-0000-000840d2f0a1
[0m19:30:58.470570 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 25 at position 193
invalid identifier 'REVIEW_NAME'
[0m19:30:58.471110 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 19:30:57.714053 => 19:30:58.470915
[0m19:30:58.471462 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m19:30:58.661434 [debug] [Thread-1 (]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 25 at position 193
  invalid identifier 'REVIEW_NAME'
[0m19:30:58.662880 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bec6a710>]}
[0m19:30:58.664560 [error] [Thread-1 (]: 3 of 5 ERROR creating sql incremental model DEV.fct_reviews .................... [[31mERROR[0m in 0.97s]
[0m19:30:58.666323 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m19:30:58.667557 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m19:30:58.668716 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m19:30:58.670441 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m19:30:58.671303 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m19:30:58.675931 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m19:30:58.678825 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 19:30:58.671735 => 19:30:58.678459
[0m19:30:58.679270 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m19:30:58.681901 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m19:30:58.682940 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m19:30:58.683313 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m19:30:58.683745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:00.042786 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m19:31:00.050263 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 19:30:58.679513 => 19:31:00.049516
[0m19:31:00.051443 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m19:31:00.251455 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ee0d3fad-2fa5-4328-a35f-b6cacb3a5244', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7bf564a60>]}
[0m19:31:00.253314 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.58s]
[0m19:31:00.254947 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m19:31:00.256107 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m19:31:00.257383 [info ] [Thread-1 (]: 5 of 5 SKIP relation DEV.mart_full_moon ........................................ [[33mSKIP[0m]
[0m19:31:00.258532 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m19:31:00.261538 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:00.262360 [debug] [MainThread]: Connection 'model.dbtlearnnew.dim_listings_w_hosts' was properly closed.
[0m19:31:00.263214 [info ] [MainThread]: 
[0m19:31:00.263813 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 8.11 seconds (8.11s).
[0m19:31:00.265576 [debug] [MainThread]: Command end result
[0m19:31:00.276674 [info ] [MainThread]: 
[0m19:31:00.277406 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:31:00.277856 [info ] [MainThread]: 
[0m19:31:00.278188 [error] [MainThread]:   Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 25 at position 193
  invalid identifier 'REVIEW_NAME'
[0m19:31:00.278509 [info ] [MainThread]: 
[0m19:31:00.278831 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=1 TOTAL=5
[0m19:31:00.279658 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 10.019981, "process_user_time": 3.740898, "process_kernel_time": 0.128615, "process_mem_max_rss": "133488", "process_out_blocks": "3656", "command_success": false, "process_in_blocks": "0"}
[0m19:31:00.280255 [debug] [MainThread]: Command `dbt run` failed at 19:31:00.280079 after 10.02 seconds
[0m19:31:00.280761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c75a77f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c4879ab0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x77e7c4a7f0a0>]}
[0m19:31:00.281362 [debug] [MainThread]: Flushing usage events
[0m19:31:49.571341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdd97ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdbe0a6b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdbe0a650>]}


============================== 19:31:49.573600 | c3eb3852-c529-48f0-b357-97fb50b301a9 ==============================
[0m19:31:49.573600 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:31:49.574135 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select fct_reviews', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:31:49.845907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdbe0a770>]}
[0m19:31:49.937311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdbdc0130>]}
[0m19:31:49.938630 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:31:49.952243 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:31:50.075873 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:31:50.076480 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:31:50.085796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fda9fdf60>]}
[0m19:31:50.098764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fda9c9330>]}
[0m19:31:50.099588 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m19:31:50.099989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fda9c9540>]}
[0m19:31:50.101432 [info ] [MainThread]: 
[0m19:31:50.102250 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:31:50.103238 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:31:50.115349 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:31:50.116617 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:31:50.117157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:31:50.763380 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:31:50.768642 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:31:50.955914 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:31:50.972835 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:31:50.973300 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:31:50.973634 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:51.485745 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:31:51.490407 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:31:51.670817 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m19:31:51.680160 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:31:51.681029 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:31:51.681829 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:31:52.535807 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:31:52.542771 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:31:52.728281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdaa4fd30>]}
[0m19:31:52.729775 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:31:52.730640 [info ] [MainThread]: 
[0m19:31:52.761044 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m19:31:52.761927 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:31:52.762866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtlearnnew.fct_reviews)
[0m19:31:52.763392 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m19:31:52.805795 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:31:52.812277 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:31:52.814940 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 19:31:52.763698 => 19:31:52.814507
[0m19:31:52.815653 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m19:31:52.859631 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m19:31:52.862620 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m19:31:52.863232 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id

from src_review where review_text is not null

        );
[0m19:31:52.863637 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:31:53.738688 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b355c9-3201-0a09-0000-000840d293f5
[0m19:31:53.739527 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 193
invalid identifier 'REVIEW_NAME'
[0m19:31:53.740692 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 19:31:52.816022 => 19:31:53.740125
[0m19:31:53.741702 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m19:31:53.908279 [debug] [Thread-1 (]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 24 at position 193
  invalid identifier 'REVIEW_NAME'
  compiled Code at target/run/dbtlearnnew/models/fct/fct_reviews.sql
[0m19:31:53.909791 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c3eb3852-c529-48f0-b357-97fb50b301a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fda005990>]}
[0m19:31:53.911508 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model DEV.fct_reviews .................... [[31mERROR[0m in 1.15s]
[0m19:31:53.913390 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m19:31:53.918415 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:31:53.920198 [debug] [MainThread]: Connection 'model.dbtlearnnew.fct_reviews' was properly closed.
[0m19:31:53.921832 [info ] [MainThread]: 
[0m19:31:53.923419 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m19:31:53.925775 [debug] [MainThread]: Command end result
[0m19:31:53.946340 [info ] [MainThread]: 
[0m19:31:53.947146 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:31:53.947741 [info ] [MainThread]: 
[0m19:31:53.948438 [error] [MainThread]:   Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 24 at position 193
  invalid identifier 'REVIEW_NAME'
  compiled Code at target/run/dbtlearnnew/models/fct/fct_reviews.sql
[0m19:31:53.949088 [info ] [MainThread]: 
[0m19:31:53.951146 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:31:53.952350 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 4.416844, "process_user_time": 2.473288, "process_kernel_time": 0.165165, "process_mem_max_rss": "120940", "process_out_blocks": "2416", "command_success": false, "process_in_blocks": "0"}
[0m19:31:53.953100 [debug] [MainThread]: Command `dbt run` failed at 19:31:53.952934 after 4.42 seconds
[0m19:31:53.953585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdd97ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fdb370100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x702fda93f5b0>]}
[0m19:31:53.954034 [debug] [MainThread]: Flushing usage events
[0m19:35:20.398689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c773636f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c77345426e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7734542680>]}


============================== 19:35:20.400908 | 072e1246-91d7-4021-9b71-4587bd3ed50f ==============================
[0m19:35:20.400908 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:35:20.401553 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --full-refresh --select fct_reviews', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:35:20.679539 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c77345427a0>]}
[0m19:35:20.755085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c773342b700>]}
[0m19:35:20.756187 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:35:20.766166 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:35:20.806589 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m19:35:20.807335 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m19:35:20.807772 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m19:35:20.808136 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m19:35:20.808450 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m19:35:20.808772 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m19:35:20.809168 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m19:35:20.809595 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m19:35:20.810041 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m19:35:20.810481 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m19:35:20.810904 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m19:35:20.811325 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m19:35:20.811744 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m19:35:20.812158 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m19:35:20.812573 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m19:35:20.813002 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m19:35:20.813432 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m19:35:20.813852 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m19:35:20.814276 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m19:35:20.814695 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m19:35:20.815109 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m19:35:20.815524 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m19:35:20.815891 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m19:35:20.816259 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m19:35:20.816557 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m19:35:20.816845 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m19:35:20.817149 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m19:35:20.817452 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m19:35:20.817745 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m19:35:20.818040 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m19:35:20.818332 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m19:35:20.818621 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m19:35:20.819034 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m19:35:20.819453 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m19:35:20.819817 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m19:35:20.820121 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m19:35:20.820455 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m19:35:20.820757 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m19:35:20.821051 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m19:35:20.821450 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m19:35:20.821761 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m19:35:20.822055 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m19:35:20.822344 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m19:35:20.822635 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m19:35:20.822921 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m19:35:20.823204 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m19:35:20.823487 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m19:35:20.824322 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m19:35:20.824704 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m19:35:20.825009 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m19:35:20.825323 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m19:35:20.825607 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m19:35:21.075130 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7733171c00>]}
[0m19:35:21.094266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7733114940>]}
[0m19:35:21.095126 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m19:35:21.095635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c7733114b50>]}
[0m19:35:21.097529 [info ] [MainThread]: 
[0m19:35:21.098646 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:35:21.100154 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:35:21.114514 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:35:21.115035 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:35:21.115368 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:35:21.734242 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:35:21.739712 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:35:21.915849 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:35:21.927727 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:35:21.928188 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:35:21.928496 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:22.577229 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:35:22.578776 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:35:22.753829 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m19:35:22.761990 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:35:22.762595 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:35:22.762939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:35:23.367168 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:35:23.373745 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:35:23.554009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c77331c6b60>]}
[0m19:35:23.556668 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:35:23.557923 [info ] [MainThread]: 
[0m19:35:23.561211 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m19:35:23.561817 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:35:23.562537 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtlearnnew.fct_reviews)
[0m19:35:23.562930 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m19:35:23.574319 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 19:35:23.563158 => 19:35:23.574036
[0m19:35:23.579280 [debug] [Thread-1 (]: Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The dbtlearnnew.fct_reviews model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m19:35:23.579834 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '072e1246-91d7-4021-9b71-4587bd3ed50f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c77327ab2e0>]}
[0m19:35:23.580461 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model DEV.fct_reviews .................... [[31mERROR[0m in 0.02s]
[0m19:35:23.580960 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m19:35:23.582209 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:35:23.582556 [debug] [MainThread]: Connection 'model.dbtlearnnew.fct_reviews' was properly closed.
[0m19:35:23.582883 [info ] [MainThread]: 
[0m19:35:23.583202 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 2.48 seconds (2.48s).
[0m19:35:23.583738 [debug] [MainThread]: Command end result
[0m19:35:23.598739 [info ] [MainThread]: 
[0m19:35:23.599488 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:35:23.599930 [info ] [MainThread]: 
[0m19:35:23.600266 [error] [MainThread]:   Compilation Error in model fct_reviews (models/fct/fct_reviews.sql)
  
  Warning: `dbt_utils.surrogate_key` has been replaced by `dbt_utils.generate_surrogate_key`. The new macro treats null values differently to empty strings. To restore the behaviour of the original macro, add a global variable in dbt_project.yml called `surrogate_key_treat_nulls_as_empty_strings` to your dbt_project.yml file with a value of True. The dbtlearnnew.fct_reviews model triggered this warning. 
  
  > in macro default__surrogate_key (macros/sql/surrogate_key.sql)
  > called by macro surrogate_key (macros/sql/surrogate_key.sql)
  > called by model fct_reviews (models/fct/fct_reviews.sql)
[0m19:35:23.600611 [info ] [MainThread]: 
[0m19:35:23.600941 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:35:23.601681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.2437205, "process_user_time": 2.555227, "process_kernel_time": 0.137095, "process_mem_max_rss": "120476", "process_out_blocks": "3560", "command_success": false, "process_in_blocks": "0"}
[0m19:35:23.602215 [debug] [MainThread]: Command `dbt run` failed at 19:35:23.602055 after 3.24 seconds
[0m19:35:23.602928 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c773636f3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c773342b700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c77331140d0>]}
[0m19:35:23.603545 [debug] [MainThread]: Flushing usage events
[0m19:36:04.430046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2ed8aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2d2e2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2d2e2620>]}


============================== 19:36:04.432358 | 30c1f1d2-0b75-490b-bd90-2006681dea59 ==============================
[0m19:36:04.432358 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:36:04.432925 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --full-refresh --select fct_reviews', 'send_anonymous_usage_stats': 'True'}
[0m19:36:04.669090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2d2e2740>]}
[0m19:36:04.741244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2c23d390>]}
[0m19:36:04.742103 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:36:04.751384 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:36:04.789281 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m19:36:04.789871 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m19:36:04.790286 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m19:36:04.790618 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m19:36:04.790932 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m19:36:04.791256 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m19:36:04.791558 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m19:36:04.791971 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m19:36:04.792388 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m19:36:04.792772 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m19:36:04.793100 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m19:36:04.793479 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m19:36:04.793827 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m19:36:04.794135 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m19:36:04.794439 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m19:36:04.794782 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m19:36:04.795105 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m19:36:04.795492 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m19:36:04.795843 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m19:36:04.796165 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m19:36:04.796485 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m19:36:04.796793 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m19:36:04.797137 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m19:36:04.797432 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m19:36:04.797727 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m19:36:04.798032 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m19:36:04.798325 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m19:36:04.798618 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m19:36:04.798907 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m19:36:04.799194 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m19:36:04.799513 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m19:36:04.799846 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m19:36:04.800137 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m19:36:04.800436 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m19:36:04.800732 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m19:36:04.801015 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m19:36:04.801319 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m19:36:04.801604 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m19:36:04.801927 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m19:36:04.802232 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m19:36:04.802520 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m19:36:04.802807 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m19:36:04.803090 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m19:36:04.803409 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m19:36:04.803772 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m19:36:04.804069 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m19:36:04.804358 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m19:36:04.805121 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m19:36:04.805434 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m19:36:04.805741 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m19:36:04.806048 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m19:36:04.806354 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m19:36:05.033916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2beddb70>]}
[0m19:36:05.046680 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2c068940>]}
[0m19:36:05.047545 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m19:36:05.048283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2c068b80>]}
[0m19:36:05.050046 [info ] [MainThread]: 
[0m19:36:05.051461 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:05.052960 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:36:05.066484 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:36:05.066953 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:36:05.067331 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:05.708416 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:36:05.712306 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:36:05.899366 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m19:36:05.916637 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:36:05.917224 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:36:05.917578 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:06.634991 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:36:06.639606 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:36:06.831490 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m19:36:06.843085 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:36:06.844689 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:36:06.845767 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:07.357688 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:36:07.361794 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:36:07.544306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2bf36c80>]}
[0m19:36:07.545026 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:07.545406 [info ] [MainThread]: 
[0m19:36:07.546990 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m19:36:07.547455 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:36:07.548034 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtlearnnew.fct_reviews)
[0m19:36:07.548383 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m19:36:07.576281 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:36:07.580507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:36:07.582985 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 19:36:07.548643 => 19:36:07.582665
[0m19:36:07.583391 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m19:36:07.621855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m19:36:07.623296 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m19:36:07.623765 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id

from src_review where review_text is not null

        );
[0m19:36:07.624166 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:08.163441 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01b355ce-3201-0a13-0000-000840d2b471
[0m19:36:08.164871 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 24 at position 193
invalid identifier 'REVIEW_NAME'
[0m19:36:08.166518 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 19:36:07.583611 => 19:36:08.165900
[0m19:36:08.167639 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m19:36:08.338690 [debug] [Thread-1 (]: Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 24 at position 193
  invalid identifier 'REVIEW_NAME'
  compiled Code at target/run/dbtlearnnew/models/fct/fct_reviews.sql
[0m19:36:08.340149 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '30c1f1d2-0b75-490b-bd90-2006681dea59', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2b50b340>]}
[0m19:36:08.341740 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model DEV.fct_reviews .................... [[31mERROR[0m in 0.79s]
[0m19:36:08.343096 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m19:36:08.345673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:08.346259 [debug] [MainThread]: Connection 'model.dbtlearnnew.fct_reviews' was properly closed.
[0m19:36:08.346923 [info ] [MainThread]: 
[0m19:36:08.347828 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 3.30 seconds (3.30s).
[0m19:36:08.348572 [debug] [MainThread]: Command end result
[0m19:36:08.360075 [info ] [MainThread]: 
[0m19:36:08.360831 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:36:08.361360 [info ] [MainThread]: 
[0m19:36:08.361808 [error] [MainThread]:   Database Error in model fct_reviews (models/fct/fct_reviews.sql)
  000904 (42000): SQL compilation error: error line 24 at position 193
  invalid identifier 'REVIEW_NAME'
  compiled Code at target/run/dbtlearnnew/models/fct/fct_reviews.sql
[0m19:36:08.362266 [info ] [MainThread]: 
[0m19:36:08.362735 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m19:36:08.363739 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 3.9701428, "process_user_time": 2.480934, "process_kernel_time": 0.07973, "process_mem_max_rss": "121760", "process_out_blocks": "3592", "command_success": false, "process_in_blocks": "0"}
[0m19:36:08.364445 [debug] [MainThread]: Command `dbt run` failed at 19:36:08.364274 after 3.97 seconds
[0m19:36:08.364951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2ed8aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2c068a60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7deb2bf35ea0>]}
[0m19:36:08.365453 [debug] [MainThread]: Flushing usage events
[0m19:36:39.717595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99261a6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c992463a680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c992463a620>]}


============================== 19:36:39.723474 | 4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e ==============================
[0m19:36:39.723474 [info ] [MainThread]: Running with dbt=1.7.10
[0m19:36:39.724141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --full-refresh --select fct_reviews', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:36:39.993009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c992463a740>]}
[0m19:36:40.067092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99235ed390>]}
[0m19:36:40.067862 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m19:36:40.078786 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m19:36:40.116991 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m19:36:40.117583 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m19:36:40.117984 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m19:36:40.118303 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m19:36:40.118607 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m19:36:40.118914 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m19:36:40.119288 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m19:36:40.119663 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m19:36:40.120162 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m19:36:40.121692 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m19:36:40.122307 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m19:36:40.122850 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m19:36:40.123408 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m19:36:40.123925 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m19:36:40.124389 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m19:36:40.124829 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m19:36:40.125270 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m19:36:40.125699 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m19:36:40.126164 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m19:36:40.126598 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m19:36:40.127017 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m19:36:40.127431 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m19:36:40.127848 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m19:36:40.128261 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m19:36:40.128680 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m19:36:40.129113 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m19:36:40.129573 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m19:36:40.129998 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m19:36:40.130447 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m19:36:40.130754 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m19:36:40.131047 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m19:36:40.131336 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m19:36:40.131628 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m19:36:40.131923 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m19:36:40.132237 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m19:36:40.132527 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m19:36:40.132820 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m19:36:40.133128 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m19:36:40.133418 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m19:36:40.133708 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m19:36:40.133992 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m19:36:40.134274 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m19:36:40.134559 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m19:36:40.134827 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m19:36:40.135089 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m19:36:40.135356 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m19:36:40.135643 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m19:36:40.136373 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m19:36:40.137165 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m19:36:40.137648 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m19:36:40.137993 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m19:36:40.138307 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m19:36:40.410369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c9923279b40>]}
[0m19:36:40.432363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c992332ab30>]}
[0m19:36:40.433378 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m19:36:40.433980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c992332add0>]}
[0m19:36:40.435721 [info ] [MainThread]: 
[0m19:36:40.437016 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:36:40.439956 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m19:36:40.456977 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m19:36:40.457806 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m19:36:40.458226 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:36:41.582936 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m19:36:41.589026 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m19:36:41.766060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m19:36:41.782460 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m19:36:41.782956 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m19:36:41.783328 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:42.404690 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:36:42.410322 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m19:36:42.589453 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m19:36:42.601806 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m19:36:42.602752 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m19:36:42.603654 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:36:43.286639 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m19:36:43.295036 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m19:36:43.467620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99232d2c80>]}
[0m19:36:43.469493 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m19:36:43.470418 [info ] [MainThread]: 
[0m19:36:43.474192 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m19:36:43.475344 [info ] [Thread-1 (]: 1 of 1 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m19:36:43.476299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.fct_reviews)
[0m19:36:43.476830 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m19:36:43.506187 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:36:43.512813 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m19:36:43.513797 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 19:36:43.477162 => 19:36:43.513522
[0m19:36:43.514172 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m19:36:43.557877 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m19:36:43.559595 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m19:36:43.560216 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace transient table AIRBNB.DEV.fct_reviews
         as
        (

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id

from src_review where review_text is not null

        );
[0m19:36:43.560763 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:36:48.734110 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 5.0 seconds
[0m19:36:48.750580 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m19:36:48.757534 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m19:36:48.758059 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m19:36:48.867687 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m19:36:48.893005 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 19:36:43.514378 => 19:36:48.892792
[0m19:36:48.893539 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m19:36:49.065281 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ab42f0c-4d5d-4e7e-a842-7872f5b2db6e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99228af340>]}
[0m19:36:49.066924 [info ] [Thread-1 (]: 1 of 1 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 5.59s]
[0m19:36:49.068248 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m19:36:49.070333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:36:49.071210 [debug] [MainThread]: Connection 'model.dbtlearnnew.fct_reviews' was properly closed.
[0m19:36:49.072232 [info ] [MainThread]: 
[0m19:36:49.073019 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 8.64 seconds (8.64s).
[0m19:36:49.074328 [debug] [MainThread]: Command end result
[0m19:36:49.083604 [info ] [MainThread]: 
[0m19:36:49.084101 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:36:49.084456 [info ] [MainThread]: 
[0m19:36:49.084796 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:36:49.085678 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 9.409193, "process_user_time": 2.746423, "process_kernel_time": 0.145724, "process_mem_max_rss": "120964", "process_out_blocks": "3592", "process_in_blocks": "0"}
[0m19:36:49.086595 [debug] [MainThread]: Command `dbt run` succeeded at 19:36:49.086368 after 9.41 seconds
[0m19:36:49.087087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99261a6b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99235ed390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7c99228e68c0>]}
[0m19:36:49.087970 [debug] [MainThread]: Flushing usage events
[0m22:14:42.188050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf69777f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf4e06710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf4e066b0>]}


============================== 22:14:42.195387 | 2c31330c-5564-41eb-9577-4db98566c2f5 ==============================
[0m22:14:42.195387 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:14:42.195900 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:14:43.348648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2c31330c-5564-41eb-9577-4db98566c2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf4e067d0>]}
[0m22:14:43.422485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2c31330c-5564-41eb-9577-4db98566c2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf7173c40>]}
[0m22:14:43.424707 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:14:43.438788 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:14:43.682898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 0 files changed.
[0m22:14:43.683641 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:14:43.684040 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:14:43.684383 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:14:43.684695 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:14:43.684994 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:14:43.685309 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:14:43.685599 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:14:43.685903 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:14:43.686203 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:14:43.686497 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:14:43.686921 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:14:43.687262 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:14:43.687620 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:14:43.687928 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:14:43.688223 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:14:43.688562 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:14:43.688859 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:14:43.689159 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:14:43.689450 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:14:43.689736 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:14:43.690024 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:14:43.690324 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:14:43.690616 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:14:43.690916 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:14:43.691248 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:14:43.691544 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:14:43.691833 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:14:43.692132 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:14:43.692434 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:14:43.692781 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:14:43.693108 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:14:43.693403 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:14:43.693689 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:14:43.693984 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:14:43.694289 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:14:43.694588 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:14:43.694877 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:14:43.695163 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:14:43.695455 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:14:43.695748 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:14:43.696043 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:14:43.696337 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:14:43.696625 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:14:43.696910 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:14:43.697215 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:14:43.697502 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:14:43.698277 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:14:43.698577 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:14:43.698882 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:14:43.699176 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:14:43.699477 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:14:43.942907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2c31330c-5564-41eb-9577-4db98566c2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf39cdcc0>]}
[0m22:14:44.174842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2c31330c-5564-41eb-9577-4db98566c2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf3b6ca30>]}
[0m22:14:44.175499 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m22:14:44.175909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c31330c-5564-41eb-9577-4db98566c2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf3b6cb20>]}
[0m22:14:44.177648 [info ] [MainThread]: 
[0m22:14:44.178391 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:14:44.179630 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m22:14:44.196525 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m22:14:44.197001 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m22:14:44.197350 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:14:50.061996 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 6.0 seconds
[0m22:14:50.066248 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m22:14:50.238315 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m22:14:50.248014 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m22:14:50.248760 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m22:14:50.249377 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:14:56.549064 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 6.0 seconds
[0m22:14:56.553578 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m22:14:56.815122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2c31330c-5564-41eb-9577-4db98566c2f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf3a7ff40>]}
[0m22:14:56.816854 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:14:56.817807 [info ] [MainThread]: 
[0m22:14:56.826584 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m22:14:56.828231 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m22:14:56.829177 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m22:14:56.836192 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m22:14:56.838658 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 22:14:56.829511 => 22:14:56.838329
[0m22:14:56.839588 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m22:14:56.840152 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m22:14:56.841353 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m22:14:56.841804 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m22:14:56.845130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m22:14:56.848141 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 22:14:56.842026 => 22:14:56.847769
[0m22:14:56.849069 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m22:14:56.849531 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m22:14:56.850157 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m22:14:56.850581 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m22:14:56.853324 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m22:14:56.855997 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 22:14:56.850826 => 22:14:56.855592
[0m22:14:56.857920 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m22:14:56.858574 [debug] [Thread-1 (]: Began running node seed.dbtlearnnew.seed_full_moon_dates
[0m22:14:56.859516 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now seed.dbtlearnnew.seed_full_moon_dates)
[0m22:14:56.859890 [debug] [Thread-1 (]: Began compiling node seed.dbtlearnnew.seed_full_moon_dates
[0m22:14:56.861735 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (compile): 22:14:56.860089 => 22:14:56.861481
[0m22:14:56.862127 [debug] [Thread-1 (]: Began executing node seed.dbtlearnnew.seed_full_moon_dates
[0m22:14:56.862541 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (execute): 22:14:56.862340 => 22:14:56.862352
[0m22:14:56.863313 [debug] [Thread-1 (]: Finished running node seed.dbtlearnnew.seed_full_moon_dates
[0m22:14:56.863729 [debug] [Thread-1 (]: Began running node snapshot.dbtlearnnew.scd_raw_listings
[0m22:14:56.864361 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearnnew.seed_full_moon_dates, now snapshot.dbtlearnnew.scd_raw_listings)
[0m22:14:56.864718 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearnnew.scd_raw_listings
[0m22:14:56.867840 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (compile): 22:14:56.864924 => 22:14:56.867605
[0m22:14:56.868263 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearnnew.scd_raw_listings
[0m22:14:56.868704 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (execute): 22:14:56.868487 => 22:14:56.868501
[0m22:14:56.869511 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearnnew.scd_raw_listings
[0m22:14:56.869911 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m22:14:56.870525 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearnnew.scd_raw_listings, now model.dbtlearnnew.dim_hosts)
[0m22:14:56.870853 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m22:14:56.876130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m22:14:56.878966 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 22:14:56.871046 => 22:14:56.878601
[0m22:14:56.879448 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m22:14:56.879919 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 22:14:56.879709 => 22:14:56.879723
[0m22:14:56.880722 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m22:14:56.881116 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m22:14:56.881716 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m22:14:56.882045 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m22:14:56.886696 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m22:14:56.889488 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 22:14:56.882226 => 22:14:56.889104
[0m22:14:56.890041 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m22:14:56.890665 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 22:14:56.890394 => 22:14:56.890435
[0m22:14:56.891621 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m22:14:56.892034 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m22:14:56.892705 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m22:14:56.893225 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m22:14:56.916047 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m22:14:56.918806 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 22:14:56.893449 => 22:14:56.918463
[0m22:14:56.919221 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m22:14:56.919786 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 22:14:56.919484 => 22:14:56.919498
[0m22:14:56.920831 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m22:14:56.921265 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m22:14:56.922005 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m22:14:56.922448 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m22:14:56.927193 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m22:14:56.929804 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 22:14:56.922736 => 22:14:56.929434
[0m22:14:56.930276 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m22:14:56.930721 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 22:14:56.930511 => 22:14:56.930525
[0m22:14:56.931498 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m22:14:56.931911 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:14:56.932535 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m22:14:56.932887 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:14:56.943609 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m22:14:56.946366 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 22:14:56.933089 => 22:14:56.945950
[0m22:14:56.946888 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:14:56.947338 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 22:14:56.947121 => 22:14:56.947136
[0m22:14:56.948149 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:14:56.948567 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m22:14:56.949200 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.dim_listing_minimum)
[0m22:14:56.949549 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m22:14:56.952186 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m22:14:56.954837 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 22:14:56.949747 => 22:14:56.954516
[0m22:14:56.955336 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m22:14:56.955973 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 22:14:56.955682 => 22:14:56.955699
[0m22:14:56.957192 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m22:14:56.958015 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.no_null_in_dimlisting
[0m22:14:56.958934 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.no_null_in_dimlisting)
[0m22:14:56.959618 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.no_null_in_dimlisting
[0m22:14:56.972376 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m22:14:56.973110 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
describe table AIRBNB.DEV.dim_listing
[0m22:14:56.973730 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:14:57.780239 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:14:57.784927 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m22:14:57.788814 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (compile): 22:14:56.959936 => 22:14:57.788249
[0m22:14:57.789765 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.no_null_in_dimlisting
[0m22:14:57.791272 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (execute): 22:14:57.790820 => 22:14:57.790845
[0m22:14:57.791999 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: Close
[0m22:14:57.978969 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.no_null_in_dimlisting
[0m22:14:57.981003 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:14:57.983199 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.no_null_in_dimlisting, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m22:14:57.984172 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:14:57.993137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m22:14:57.995509 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 22:14:57.984523 => 22:14:57.995041
[0m22:14:57.996206 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:14:57.996791 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 22:14:57.996561 => 22:14:57.996576
[0m22:14:57.997584 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:14:57.997966 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:14:57.998575 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m22:14:57.998903 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:14:58.002574 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m22:14:58.004772 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 22:14:57.999094 => 22:14:58.004433
[0m22:14:58.005213 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:14:58.005729 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 22:14:58.005504 => 22:14:58.005518
[0m22:14:58.006617 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:14:58.007334 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:14:58.008530 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5)
[0m22:14:58.009101 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:14:58.014517 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m22:14:58.016806 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (compile): 22:14:58.009420 => 22:14:58.016455
[0m22:14:58.017297 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:14:58.017747 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (execute): 22:14:58.017555 => 22:14:58.017564
[0m22:14:58.018520 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:14:58.018901 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:14:58.019481 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m22:14:58.019811 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:14:58.027037 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m22:14:58.029628 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 22:14:58.020003 => 22:14:58.029189
[0m22:14:58.030111 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:14:58.030554 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 22:14:58.030345 => 22:14:58.030361
[0m22:14:58.031487 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:14:58.031902 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:14:58.032514 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m22:14:58.032858 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:14:58.038623 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m22:14:58.041579 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 22:14:58.033050 => 22:14:58.041206
[0m22:14:58.042127 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:14:58.042620 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 22:14:58.042385 => 22:14:58.042398
[0m22:14:58.043432 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:14:58.043837 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m22:14:58.044586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61, now model.dbtlearnnew.mart_full_moon)
[0m22:14:58.044956 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m22:14:58.048925 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m22:14:58.051255 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 22:14:58.045224 => 22:14:58.050956
[0m22:14:58.051713 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m22:14:58.052131 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 22:14:58.051934 => 22:14:58.051946
[0m22:14:58.052911 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m22:14:58.053336 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m22:14:58.053967 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.mart_full_moon, now test.dbtlearnnew.consistent_created_at)
[0m22:14:58.054313 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m22:14:58.058820 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m22:14:58.061373 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 22:14:58.054514 => 22:14:58.061037
[0m22:14:58.061849 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m22:14:58.062301 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 22:14:58.062093 => 22:14:58.062108
[0m22:14:58.063164 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m22:14:58.063983 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:14:58.064343 [debug] [MainThread]: Connection 'test.dbtlearnnew.consistent_created_at' was properly closed.
[0m22:14:58.066369 [debug] [MainThread]: Command end result
[0m22:14:58.443266 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m22:14:58.443820 [info ] [MainThread]: Building catalog
[0m22:14:58.447684 [debug] [ThreadPool]: Acquiring new snowflake connection 'AIRBNB.information_schema'
[0m22:14:58.464519 [debug] [ThreadPool]: Using snowflake connection "AIRBNB.information_schema"
[0m22:14:58.465393 [debug] [ThreadPool]: On AIRBNB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "AIRBNB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AIRBNB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listing')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('mart_full_moon')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AIRBNB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listing')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('mart_full_moon')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m22:14:58.465932 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:04.222075 [debug] [ThreadPool]: SQL status: SUCCESS 68 in 6.0 seconds
[0m22:15:04.242582 [debug] [ThreadPool]: On AIRBNB.information_schema: Close
[0m22:15:05.654653 [info ] [MainThread]: Catalog written to /home/kishanmahajan/Desktop/course/dbtlearnnew/target/catalog.json
[0m22:15:05.659648 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 23.527225, "process_user_time": 2.89594, "process_kernel_time": 0.216175, "process_mem_max_rss": "121732", "process_in_blocks": "1912", "process_out_blocks": "6808"}
[0m22:15:05.660649 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:15:05.660495 after 23.53 seconds
[0m22:15:05.661024 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:15:05.661353 [debug] [MainThread]: Connection 'AIRBNB.information_schema' was properly closed.
[0m22:15:05.661782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf69777f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf306a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x759cf3e71c00>]}
[0m22:15:05.662175 [debug] [MainThread]: Flushing usage events
[0m22:16:14.320593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcee1fa7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcee043a5c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcee043a560>]}


============================== 22:16:14.323187 | c2fdae5f-dd10-4aa2-b96a-cdfd2e0c0041 ==============================
[0m22:16:14.323187 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:16:14.323736 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:16:14.581760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c2fdae5f-dd10-4aa2-b96a-cdfd2e0c0041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcedf439d20>]}
[0m22:16:14.656553 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c2fdae5f-dd10-4aa2-b96a-cdfd2e0c0041', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcedf40fdc0>]}
[0m22:22:25.525025 [error] [MainThread]: Encountered an error:

[0m22:22:25.572338 [error] [MainThread]: Traceback (most recent call last):
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m22:22:25.573481 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 371.28876, "process_user_time": 1.895163, "process_kernel_time": 0.130258, "process_mem_max_rss": "106624", "process_in_blocks": "32", "process_out_blocks": "2968", "command_success": false}
[0m22:22:25.574114 [debug] [MainThread]: Command `dbt docs serve` failed at 22:22:25.573986 after 371.29 seconds
[0m22:22:25.574468 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcee1fa7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcedf3f0730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bcedf3f2440>]}
[0m22:22:25.574821 [debug] [MainThread]: Flushing usage events
[0m22:26:21.794038 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744134c6f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7441330fe6e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7441330fe680>]}


============================== 22:26:21.796485 | de7667ba-69c4-4019-bd24-c6069aa08655 ==============================
[0m22:26:21.796485 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:26:21.797211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:26:22.060899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'de7667ba-69c4-4019-bd24-c6069aa08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7441330fe7a0>]}
[0m22:26:22.136379 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'de7667ba-69c4-4019-bd24-c6069aa08655', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744132167700>]}
[0m22:26:22.137150 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:26:22.147571 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:26:22.164535 [error] [MainThread]: Encountered an error:
Parsing Error
  Error reading dbtlearnnew: schema.yaml - Runtime Error
    Syntax error near line 31
    ------------------------------
    28 | 
    29 | 
    30 |       - name: minimum_nights
    31 |         description: '{{doc('dim_listing_cleansed__minimum_nights')}}'
    32 |         tests:
    33 |           - positive_value
    
    Raw Error:
    ------------------------------
    while parsing a block mapping
      in "<unicode string>", line 30, column 9
    did not find expected key
      in "<unicode string>", line 31, column 30
[0m22:26:22.165695 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.40653843, "process_user_time": 1.879975, "process_kernel_time": 0.083998, "process_mem_max_rss": "108404", "process_out_blocks": "16", "command_success": false, "process_in_blocks": "0"}
[0m22:26:22.166480 [debug] [MainThread]: Command `dbt docs generate` failed at 22:26:22.166278 after 0.41 seconds
[0m22:26:22.167045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744134c6f820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744131e3a260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x744131e3a140>]}
[0m22:26:22.167526 [debug] [MainThread]: Flushing usage events
[0m22:27:21.916409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765be237ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765be080a770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765be080a710>]}


============================== 22:27:21.918583 | 8e6fc37c-e9ad-4a56-8933-e4a5cdb82573 ==============================
[0m22:27:21.918583 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:27:21.919061 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:27:22.146098 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e6fc37c-e9ad-4a56-8933-e4a5cdb82573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765be080a830>]}
[0m22:27:22.214794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e6fc37c-e9ad-4a56-8933-e4a5cdb82573', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765bdf9e0370>]}
[0m22:27:22.215580 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:27:22.224702 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:27:22.260872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 1 files changed.
[0m22:27:22.261813 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:27:22.262212 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:27:22.262546 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:27:22.262854 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:27:22.263167 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:27:22.263476 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:27:22.263774 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:27:22.264066 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:27:22.264357 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:27:22.264645 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:27:22.264928 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:27:22.265243 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:27:22.265535 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:27:22.265824 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:27:22.266108 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:27:22.266392 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:27:22.266675 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:27:22.266957 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:27:22.267243 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:27:22.267531 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:27:22.267816 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:27:22.268102 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:27:22.268385 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:27:22.268669 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:27:22.268967 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:27:22.269260 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:27:22.269544 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:27:22.269829 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:27:22.270113 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:27:22.270397 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:27:22.270683 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:27:22.270965 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:27:22.271245 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:27:22.271526 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:27:22.271808 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:27:22.272137 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:27:22.272544 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:27:22.272886 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:27:22.273241 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:27:22.273558 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:27:22.273857 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:27:22.274149 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:27:22.274446 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:27:22.274747 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:27:22.275046 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:27:22.313156 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:27:22.313612 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:27:22.313923 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:27:22.314229 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:27:22.314516 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:27:22.314798 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:27:22.315230 [debug] [MainThread]: Partial parsing: updated file: dbtlearnnew://models/schema.yaml
[0m22:27:22.701933 [error] [MainThread]: Encountered an error:
Compilation Error
  Documentation for 'model.dbtlearnnew.dim_listing' depends on doc 'dim_listing_cleansed__minimum_nights'  which was not found
[0m22:27:22.702822 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_wall_clock_time": 0.81879103, "process_user_time": 2.139937, "process_kernel_time": 0.109428, "process_mem_max_rss": "114228", "process_out_blocks": "24", "command_success": false, "process_in_blocks": "0"}
[0m22:27:22.703420 [debug] [MainThread]: Command `dbt docs generate` failed at 22:27:22.703296 after 0.82 seconds
[0m22:27:22.703775 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765be237ab90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765bdea96d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x765bdea94ac0>]}
[0m22:27:22.704127 [debug] [MainThread]: Flushing usage events
[0m22:28:16.965315 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e4199aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3fbea740>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3fbea6e0>]}


============================== 22:28:16.967683 | 39bd6da4-7e69-44c3-9717-ddb19767ef56 ==============================
[0m22:28:16.967683 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:28:16.968192 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:17.201437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39bd6da4-7e69-44c3-9717-ddb19767ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3fbea800>]}
[0m22:28:17.269811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39bd6da4-7e69-44c3-9717-ddb19767ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3ea84880>]}
[0m22:28:17.270609 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:28:17.280018 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:28:17.316122 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 51 files added, 2 files changed.
[0m22:28:17.317060 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_accepted_values.sql
[0m22:28:17.317507 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_time.sql
[0m22:28:17.317827 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_single_value.sql
[0m22:28:17.318128 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/relationships_where.sql
[0m22:28:17.318422 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_surrogate_key.sql
[0m22:28:17.318715 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck_table.sql
[0m22:28:17.319012 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/pivot.sql
[0m22:28:17.319300 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_pattern.sql
[0m22:28:17.319583 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/union.sql
[0m22:28:17.319866 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/width_bucket.sql
[0m22:28:17.320148 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/expression_is_true.sql
[0m22:28:17.320428 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_relation.sql
[0m22:28:17.320717 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_query_results_as_dict.sql
[0m22:28:17.320999 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_relations_by_prefix.sql
[0m22:28:17.321290 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/star.sql
[0m22:28:17.321590 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/accepted_range.sql
[0m22:28:17.321888 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_add.sql
[0m22:28:17.322185 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_path.sql
[0m22:28:17.322467 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/groupby.sql
[0m22:28:17.322748 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/unique_combination_of_columns.sql
[0m22:28:17.323032 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/at_least_one.sql
[0m22:28:17.323312 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_pattern_sql.sql
[0m22:28:17.323594 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/recency.sql
[0m22:28:17.323877 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/cardinality_equality.sql
[0m22:28:17.324207 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_subtract.sql
[0m22:28:17.324505 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/pretty_log_format.sql
[0m22:28:17.324792 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_null_proportion.sql
[0m22:28:17.325073 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_column_values.sql
[0m22:28:17.325373 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_empty_string.sql
[0m22:28:17.325656 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/mutually_exclusive_ranges.sql
[0m22:28:17.325936 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_tables_by_prefix_sql.sql
[0m22:28:17.326215 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/safe_divide.sql
[0m22:28:17.326494 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_host.sql
[0m22:28:17.326777 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/not_constant.sql
[0m22:28:17.327056 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/generate_series.sql
[0m22:28:17.327339 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/web/get_url_parameter.sql
[0m22:28:17.327675 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/unpivot.sql
[0m22:28:17.328004 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_table_types_sql.sql
[0m22:28:17.328396 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/get_filtered_columns_in_relation.sql
[0m22:28:17.328706 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/sequential_values.sql
[0m22:28:17.329003 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equal_rowcount.sql
[0m22:28:17.329303 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/log_info.sql
[0m22:28:17.329590 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/nullcheck.sql
[0m22:28:17.329875 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/deduplicate.sql
[0m22:28:17.330157 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/date_spine.sql
[0m22:28:17.368869 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/equality.sql
[0m22:28:17.369334 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/generic_tests/fewer_rows_than.sql
[0m22:28:17.369669 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/slugify.sql
[0m22:28:17.369985 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/jinja_helpers/_is_ephemeral.sql
[0m22:28:17.370289 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/surrogate_key.sql
[0m22:28:17.370582 [debug] [MainThread]: Partial parsing: added file: dbt_utils://macros/sql/haversine_distance.sql
[0m22:28:17.371039 [debug] [MainThread]: Partial parsing: updated file: dbtlearnnew://models/schema.yaml
[0m22:28:17.371403 [debug] [MainThread]: Partial parsing: updated file: dbtlearnnew://models/docs.md
[0m22:28:17.769827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39bd6da4-7e69-44c3-9717-ddb19767ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3df4beb0>]}
[0m22:28:17.779223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39bd6da4-7e69-44c3-9717-ddb19767ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3e784be0>]}
[0m22:28:17.779878 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m22:28:17.780308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39bd6da4-7e69-44c3-9717-ddb19767ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3e784d60>]}
[0m22:28:17.782278 [info ] [MainThread]: 
[0m22:28:17.783106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:28:17.784892 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_dev'
[0m22:28:17.800950 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m22:28:17.801431 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m22:28:17.801845 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:18.472718 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m22:28:18.477673 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m22:28:18.639075 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m22:28:18.652322 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m22:28:18.653440 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m22:28:18.654264 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:28:19.289321 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m22:28:19.293881 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m22:28:19.467759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39bd6da4-7e69-44c3-9717-ddb19767ef56', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3e8930a0>]}
[0m22:28:19.469884 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:28:19.470969 [info ] [MainThread]: 
[0m22:28:19.476131 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m22:28:19.478105 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m22:28:19.479309 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m22:28:19.490120 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m22:28:19.490921 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 22:28:19.480010 => 22:28:19.490682
[0m22:28:19.491665 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m22:28:19.492068 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m22:28:19.492889 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m22:28:19.493312 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m22:28:19.495850 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m22:28:19.496579 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 22:28:19.493627 => 22:28:19.496358
[0m22:28:19.497479 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m22:28:19.497991 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m22:28:19.498823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m22:28:19.499406 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m22:28:19.501979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m22:28:19.504286 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 22:28:19.499629 => 22:28:19.503970
[0m22:28:19.505180 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m22:28:19.505619 [debug] [Thread-1 (]: Began running node seed.dbtlearnnew.seed_full_moon_dates
[0m22:28:19.506257 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now seed.dbtlearnnew.seed_full_moon_dates)
[0m22:28:19.506697 [debug] [Thread-1 (]: Began compiling node seed.dbtlearnnew.seed_full_moon_dates
[0m22:28:19.508618 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (compile): 22:28:19.506908 => 22:28:19.508395
[0m22:28:19.509115 [debug] [Thread-1 (]: Began executing node seed.dbtlearnnew.seed_full_moon_dates
[0m22:28:19.509664 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (execute): 22:28:19.509405 => 22:28:19.509415
[0m22:28:19.510454 [debug] [Thread-1 (]: Finished running node seed.dbtlearnnew.seed_full_moon_dates
[0m22:28:19.510852 [debug] [Thread-1 (]: Began running node snapshot.dbtlearnnew.scd_raw_listings
[0m22:28:19.511438 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearnnew.seed_full_moon_dates, now snapshot.dbtlearnnew.scd_raw_listings)
[0m22:28:19.511776 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearnnew.scd_raw_listings
[0m22:28:19.515379 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (compile): 22:28:19.511964 => 22:28:19.515146
[0m22:28:19.515775 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearnnew.scd_raw_listings
[0m22:28:19.516179 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (execute): 22:28:19.515987 => 22:28:19.515997
[0m22:28:19.516898 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearnnew.scd_raw_listings
[0m22:28:19.517281 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m22:28:19.517830 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearnnew.scd_raw_listings, now model.dbtlearnnew.dim_hosts)
[0m22:28:19.518155 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m22:28:19.521742 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m22:28:19.522455 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 22:28:19.518351 => 22:28:19.522199
[0m22:28:19.522995 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m22:28:19.523543 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 22:28:19.523285 => 22:28:19.523295
[0m22:28:19.524520 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m22:28:19.524906 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m22:28:19.525508 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m22:28:19.525833 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m22:28:19.530423 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m22:28:19.532755 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 22:28:19.526024 => 22:28:19.532467
[0m22:28:19.533162 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m22:28:19.533568 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 22:28:19.533377 => 22:28:19.533389
[0m22:28:19.534310 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m22:28:19.534677 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m22:28:19.535280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m22:28:19.535763 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m22:28:19.555122 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m22:28:19.557722 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 22:28:19.535958 => 22:28:19.557322
[0m22:28:19.558313 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m22:28:19.558947 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 22:28:19.558652 => 22:28:19.558665
[0m22:28:19.559800 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m22:28:19.560180 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m22:28:19.560802 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m22:28:19.561266 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m22:28:19.563938 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m22:28:19.564635 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 22:28:19.561472 => 22:28:19.564396
[0m22:28:19.564969 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m22:28:19.565352 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 22:28:19.565170 => 22:28:19.565180
[0m22:28:19.566044 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m22:28:19.566422 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:28:19.566987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m22:28:19.567322 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:28:19.572038 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m22:28:19.573080 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 22:28:19.567520 => 22:28:19.572682
[0m22:28:19.573704 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:28:19.574348 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 22:28:19.574037 => 22:28:19.574051
[0m22:28:19.575201 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:28:19.575598 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m22:28:19.576304 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.dim_listing_minimum)
[0m22:28:19.576693 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m22:28:19.579466 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m22:28:19.581658 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 22:28:19.576925 => 22:28:19.581283
[0m22:28:19.582244 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m22:28:19.582830 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 22:28:19.582567 => 22:28:19.582579
[0m22:28:19.583596 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m22:28:19.583977 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.no_null_in_dimlisting
[0m22:28:19.584563 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.no_null_in_dimlisting)
[0m22:28:19.584894 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.no_null_in_dimlisting
[0m22:28:19.595403 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m22:28:19.595870 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
describe table AIRBNB.DEV.dim_listing
[0m22:28:19.596232 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:28:20.083881 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 0.0 seconds
[0m22:28:20.089180 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m22:28:20.095320 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (compile): 22:28:19.585108 => 22:28:20.094504
[0m22:28:20.096512 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.no_null_in_dimlisting
[0m22:28:20.097835 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (execute): 22:28:20.097225 => 22:28:20.097248
[0m22:28:20.098895 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: Close
[0m22:28:20.270013 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.no_null_in_dimlisting
[0m22:28:20.271404 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:28:20.273314 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.no_null_in_dimlisting, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m22:28:20.274536 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:28:20.288090 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m22:28:20.289031 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 22:28:20.275269 => 22:28:20.288690
[0m22:28:20.289448 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:28:20.289859 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 22:28:20.289660 => 22:28:20.289673
[0m22:28:20.290630 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:28:20.291014 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:28:20.291614 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m22:28:20.291957 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:28:20.296267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m22:28:20.297014 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 22:28:20.292159 => 22:28:20.296781
[0m22:28:20.297392 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:28:20.297782 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 22:28:20.297597 => 22:28:20.297608
[0m22:28:20.298507 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:28:20.298876 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:28:20.299434 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5)
[0m22:28:20.299764 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:28:20.303067 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m22:28:20.305168 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (compile): 22:28:20.299955 => 22:28:20.304822
[0m22:28:20.305606 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:28:20.306074 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (execute): 22:28:20.305851 => 22:28:20.305863
[0m22:28:20.306848 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:28:20.307256 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:28:20.307840 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m22:28:20.308164 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:28:20.312367 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m22:28:20.313168 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 22:28:20.308352 => 22:28:20.312874
[0m22:28:20.313688 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:28:20.314263 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 22:28:20.313997 => 22:28:20.314007
[0m22:28:20.315203 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:28:20.315581 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:28:20.316151 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m22:28:20.316472 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:28:20.321488 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m22:28:20.322287 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 22:28:20.316662 => 22:28:20.322043
[0m22:28:20.322654 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:28:20.323053 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 22:28:20.322863 => 22:28:20.322873
[0m22:28:20.323775 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:28:20.324182 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m22:28:20.324759 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61, now model.dbtlearnnew.mart_full_moon)
[0m22:28:20.325095 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m22:28:20.327880 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m22:28:20.330269 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 22:28:20.325290 => 22:28:20.329967
[0m22:28:20.330672 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m22:28:20.331090 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 22:28:20.330897 => 22:28:20.330909
[0m22:28:20.331870 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m22:28:20.332265 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m22:28:20.332866 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.mart_full_moon, now test.dbtlearnnew.consistent_created_at)
[0m22:28:20.333210 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m22:28:20.335788 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m22:28:20.336427 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 22:28:20.333407 => 22:28:20.336216
[0m22:28:20.336766 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m22:28:20.337155 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 22:28:20.336962 => 22:28:20.336972
[0m22:28:20.337859 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m22:28:20.338562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:28:20.338862 [debug] [MainThread]: Connection 'test.dbtlearnnew.consistent_created_at' was properly closed.
[0m22:28:20.340747 [debug] [MainThread]: Command end result
[0m22:28:20.403297 [debug] [MainThread]: Acquiring new snowflake connection 'generate_catalog'
[0m22:28:20.403828 [info ] [MainThread]: Building catalog
[0m22:28:20.407748 [debug] [ThreadPool]: Acquiring new snowflake connection 'AIRBNB.information_schema'
[0m22:28:20.424443 [debug] [ThreadPool]: Using snowflake connection "AIRBNB.information_schema"
[0m22:28:20.425382 [debug] [ThreadPool]: On AIRBNB.information_schema: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "AIRBNB.information_schema"} */
with tables as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",
        coalesce(table_type, 'DYNAMIC TABLE') as "table_type",
        comment as "table_comment",

        -- note: this is the _role_ that owns the table
        table_owner as "table_owner",

        'Clustering Key' as "stats:clustering_key:label",
        clustering_key as "stats:clustering_key:value",
        'The key used to cluster this table' as "stats:clustering_key:description",
        (clustering_key is not null) as "stats:clustering_key:include",

        'Row Count' as "stats:row_count:label",
        row_count as "stats:row_count:value",
        'An approximate count of rows in this table' as "stats:row_count:description",
        (row_count is not null) as "stats:row_count:include",

        'Approximate Size' as "stats:bytes:label",
        bytes as "stats:bytes:value",
        'Approximate size of the table as reported by Snowflake' as "stats:bytes:description",
        (bytes is not null) as "stats:bytes:include",

        'Last Modified' as "stats:last_modified:label",
        to_varchar(convert_timezone('UTC', last_altered), 'yyyy-mm-dd HH24:MI'||'UTC') as "stats:last_modified:value",
        'The timestamp for last update/change' as "stats:last_modified:description",
        (last_altered is not null and table_type='BASE TABLE') as "stats:last_modified:include"
    from AIRBNB.INFORMATION_SCHEMA.tables
            where (
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listing')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('mart_full_moon')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
            )
        ),
        columns as (
            select
        table_catalog as "table_database",
        table_schema as "table_schema",
        table_name as "table_name",

        column_name as "column_name",
        ordinal_position as "column_index",
        data_type as "column_type",
        comment as "column_comment"
    from AIRBNB.INFORMATION_SCHEMA.columns
            where (
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listing')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_listings_w_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('mart_full_moon')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('dim_hosts')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('seed_full_moon_dates')
                )
             or 
                (
                    upper("table_schema") = upper('dev')
                    and upper("table_name") = upper('scd_raw_listings')
                )
             or 
                (
                    upper("table_schema") = upper('DEV')
                    and upper("table_name") = upper('fct_reviews')
                )
             or 
                (
                    upper("table_schema") = upper('raw')
                    and upper("table_name") = upper('raw_hosts')
                )
            )
        )
        select *
    from tables
    join columns using ("table_database", "table_schema", "table_name")
    order by "column_index"
[0m22:28:20.426199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:28:25.041792 [debug] [ThreadPool]: SQL status: SUCCESS 68 in 5.0 seconds
[0m22:28:25.054786 [debug] [ThreadPool]: On AIRBNB.information_schema: Close
[0m22:28:25.254196 [info ] [MainThread]: Catalog written to /home/kishanmahajan/Desktop/course/dbtlearnnew/target/catalog.json
[0m22:28:25.255358 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 8.32265, "process_user_time": 2.784616, "process_kernel_time": 0.096021, "process_mem_max_rss": "125464", "process_out_blocks": "6784", "process_in_blocks": "0"}
[0m22:28:25.255962 [debug] [MainThread]: Command `dbt docs generate` succeeded at 22:28:25.255839 after 8.32 seconds
[0m22:28:25.256281 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m22:28:25.256550 [debug] [MainThread]: Connection 'AIRBNB.information_schema' was properly closed.
[0m22:28:25.256838 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e4199aa10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3ea87e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x763e3ec159c0>]}
[0m22:28:25.257175 [debug] [MainThread]: Flushing usage events
[0m22:28:32.244846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23fc6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23e0fe590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23e0fe530>]}


============================== 22:28:32.247073 | 10208e22-b476-46c0-8ca5-8c455a9139a4 ==============================
[0m22:28:32.247073 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:28:32.247585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt docs serve', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:28:32.475408 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '10208e22-b476-46c0-8ca5-8c455a9139a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23d2fa3e0>]}
[0m22:28:32.543883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '10208e22-b476-46c0-8ca5-8c455a9139a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23d032350>]}
[0m22:29:27.220473 [error] [MainThread]: Encountered an error:

[0m22:29:27.224817 [error] [MainThread]: Traceback (most recent call last):
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 237, in serve_forever
    self._handle_request_noblock()
  File "/usr/lib/python3.10/socketserver.py", line 316, in _handle_request_noblock
    self.process_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 347, in process_request
    self.finish_request(request, client_address)
  File "/usr/lib/python3.10/socketserver.py", line 360, in finish_request
    self.RequestHandlerClass(request, client_address, self)
  File "/usr/lib/python3.10/http/server.py", line 668, in __init__
    super().__init__(*args, **kwargs)
  File "/usr/lib/python3.10/socketserver.py", line 747, in __init__
    self.handle()
  File "/usr/lib/python3.10/http/server.py", line 433, in handle
    self.handle_one_request()
  File "/usr/lib/python3.10/http/server.py", line 401, in handle_one_request
    self.raw_requestline = self.rfile.readline(65537)
  File "/usr/lib/python3.10/socket.py", line 705, in readinto
    return self._sock.recv_into(b)
KeyboardInterrupt

[0m22:29:27.229291 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 55.016445, "process_user_time": 1.661521, "process_kernel_time": 0.130859, "process_mem_max_rss": "106676", "process_out_blocks": "2960", "command_success": false, "process_in_blocks": "0"}
[0m22:29:27.231455 [debug] [MainThread]: Command `dbt docs serve` failed at 22:29:27.231020 after 55.02 seconds
[0m22:29:27.232580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23fc6f850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23d031cc0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7bc23d030970>]}
[0m22:29:27.233420 [debug] [MainThread]: Flushing usage events
[0m22:35:40.515787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca6ad8b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca692e2530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca692e24d0>]}


============================== 22:35:40.518133 | 5befa5d9-157f-400a-8a6a-84c8f8d74f62 ==============================
[0m22:35:40.518133 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:35:40.518670 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:35:40.784473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5befa5d9-157f-400a-8a6a-84c8f8d74f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca6828bd30>]}
[0m22:35:40.862800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5befa5d9-157f-400a-8a6a-84c8f8d74f62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca684e29b0>]}
[0m22:41:16.892743 [error] [MainThread]: Encountered an error:

[0m22:41:16.903235 [error] [MainThread]: Traceback (most recent call last):
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 169, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 198, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/requires.py", line 245, in wrapper
    return func(*args, **kwargs)
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/cli/main.py", line 324, in docs_serve
    results = task.run()
  File "/home/kishanmahajan/Desktop/course/venv/lib/python3.10/site-packages/dbt/task/serve.py", line 28, in run
    httpd.serve_forever()
  File "/usr/lib/python3.10/socketserver.py", line 232, in serve_forever
    ready = selector.select(poll_interval)
  File "/usr/lib/python3.10/selectors.py", line 416, in select
    fd_event_list = self._selector.poll(timeout)
KeyboardInterrupt

[0m22:41:16.905711 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_wall_clock_time": 336.42624, "process_user_time": 1.917649, "process_kernel_time": 0.119355, "process_mem_max_rss": "106384", "process_out_blocks": "2968", "command_success": false, "process_in_blocks": "0"}
[0m22:41:16.906792 [debug] [MainThread]: Command `dbt docs serve` failed at 22:41:16.906589 after 336.43 seconds
[0m22:41:16.907294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca6ad8b880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca68244700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x79ca68247d60>]}
[0m22:41:16.907717 [debug] [MainThread]: Flushing usage events
[0m22:43:53.622786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289dda7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289c23a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289c23a590>]}


============================== 22:43:53.625184 | b244b132-9712-4167-bb66-2c8af621a1e6 ==============================
[0m22:43:53.625184 [info ] [MainThread]: Running with dbt=1.7.10
[0m22:43:53.625665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/kishanmahajan/.dbt', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt compile', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:43:53.884268 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b244b132-9712-4167-bb66-2c8af621a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289b23e380>]}
[0m22:43:53.959053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b244b132-9712-4167-bb66-2c8af621a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289b1ebd30>]}
[0m22:43:53.959810 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m22:43:53.971391 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m22:43:54.067188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m22:43:54.068162 [debug] [MainThread]: Partial parsing: added file: dbtlearnnew://analyses/full_moon_no_sleep.sql
[0m22:43:54.177219 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b244b132-9712-4167-bb66-2c8af621a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289adec220>]}
[0m22:43:54.197665 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b244b132-9712-4167-bb66-2c8af621a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289afae590>]}
[0m22:43:54.198389 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 analysis, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m22:43:54.199015 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b244b132-9712-4167-bb66-2c8af621a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289afacee0>]}
[0m22:43:54.202447 [info ] [MainThread]: 
[0m22:43:54.203863 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:43:54.205818 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB_DEV'
[0m22:43:54.225250 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m22:43:54.225690 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m22:43:54.226054 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:43:55.128574 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m22:43:55.133823 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m22:43:55.376582 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m22:43:55.383802 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m22:43:55.384541 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m22:43:55.384976 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m22:43:56.115678 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m22:43:56.129031 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m22:43:56.617118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b244b132-9712-4167-bb66-2c8af621a1e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289af7ba60>]}
[0m22:43:56.618375 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m22:43:56.619193 [info ] [MainThread]: 
[0m22:43:56.621627 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m22:43:56.622445 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtlearnnew.scr_hosts)
[0m22:43:56.622859 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m22:43:56.629022 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m22:43:56.631892 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 22:43:56.623072 => 22:43:56.631442
[0m22:43:56.634233 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m22:43:56.634892 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m22:43:56.635754 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m22:43:56.636292 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m22:43:56.638877 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m22:43:56.641293 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 22:43:56.636521 => 22:43:56.640947
[0m22:43:56.642188 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m22:43:56.642582 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m22:43:56.643152 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m22:43:56.643543 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m22:43:56.646665 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m22:43:56.649676 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 22:43:56.643755 => 22:43:56.649144
[0m22:43:56.651647 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m22:43:56.652202 [debug] [Thread-1 (]: Began running node seed.dbtlearnnew.seed_full_moon_dates
[0m22:43:56.652909 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now seed.dbtlearnnew.seed_full_moon_dates)
[0m22:43:56.653386 [debug] [Thread-1 (]: Began compiling node seed.dbtlearnnew.seed_full_moon_dates
[0m22:43:56.655356 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (compile): 22:43:56.653606 => 22:43:56.655094
[0m22:43:56.655876 [debug] [Thread-1 (]: Began executing node seed.dbtlearnnew.seed_full_moon_dates
[0m22:43:56.656314 [debug] [Thread-1 (]: Timing info for seed.dbtlearnnew.seed_full_moon_dates (execute): 22:43:56.656106 => 22:43:56.656118
[0m22:43:56.657110 [debug] [Thread-1 (]: Finished running node seed.dbtlearnnew.seed_full_moon_dates
[0m22:43:56.657511 [debug] [Thread-1 (]: Began running node snapshot.dbtlearnnew.scd_raw_listings
[0m22:43:56.658118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly seed.dbtlearnnew.seed_full_moon_dates, now snapshot.dbtlearnnew.scd_raw_listings)
[0m22:43:56.658453 [debug] [Thread-1 (]: Began compiling node snapshot.dbtlearnnew.scd_raw_listings
[0m22:43:56.662269 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (compile): 22:43:56.658644 => 22:43:56.661987
[0m22:43:56.662763 [debug] [Thread-1 (]: Began executing node snapshot.dbtlearnnew.scd_raw_listings
[0m22:43:56.663224 [debug] [Thread-1 (]: Timing info for snapshot.dbtlearnnew.scd_raw_listings (execute): 22:43:56.663015 => 22:43:56.663028
[0m22:43:56.664062 [debug] [Thread-1 (]: Finished running node snapshot.dbtlearnnew.scd_raw_listings
[0m22:43:56.664460 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m22:43:56.665118 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly snapshot.dbtlearnnew.scd_raw_listings, now model.dbtlearnnew.dim_hosts)
[0m22:43:56.665486 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m22:43:56.670067 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m22:43:56.671120 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 22:43:56.665748 => 22:43:56.670822
[0m22:43:56.671790 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m22:43:56.672542 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 22:43:56.672230 => 22:43:56.672248
[0m22:43:56.673713 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m22:43:56.674167 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m22:43:56.674806 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m22:43:56.675154 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m22:43:56.679998 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m22:43:56.684613 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 22:43:56.675352 => 22:43:56.684089
[0m22:43:56.685480 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m22:43:56.686051 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 22:43:56.685854 => 22:43:56.685864
[0m22:43:56.686815 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m22:43:56.687207 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m22:43:56.687823 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m22:43:56.688316 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m22:43:56.711776 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m22:43:56.712679 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 22:43:56.688523 => 22:43:56.712427
[0m22:43:56.713054 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m22:43:56.713443 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 22:43:56.713267 => 22:43:56.713276
[0m22:43:56.714492 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m22:43:56.715231 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m22:43:56.716406 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m22:43:56.716936 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m22:43:56.720983 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m22:43:56.724613 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 22:43:56.717189 => 22:43:56.724198
[0m22:43:56.725312 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m22:43:56.726007 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 22:43:56.725695 => 22:43:56.725710
[0m22:43:56.727188 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m22:43:56.727696 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:43:56.728552 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08)
[0m22:43:56.729130 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:43:56.745990 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08"
[0m22:43:56.748465 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (compile): 22:43:56.729469 => 22:43:56.748072
[0m22:43:56.749227 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:43:56.749945 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08 (execute): 22:43:56.749660 => 22:43:56.749683
[0m22:43:56.750908 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08
[0m22:43:56.751640 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.dim_listing_minimum
[0m22:43:56.752362 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.accepted_values_dim_listing_room_type__Entire_home_apt__Private_room__Shared_room__Hotel_room.d48a904e08, now test.dbtlearnnew.dim_listing_minimum)
[0m22:43:56.752744 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.dim_listing_minimum
[0m22:43:56.755286 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.dim_listing_minimum"
[0m22:43:56.755998 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (compile): 22:43:56.752953 => 22:43:56.755759
[0m22:43:56.756400 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.dim_listing_minimum
[0m22:43:56.756912 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.dim_listing_minimum (execute): 22:43:56.756666 => 22:43:56.756679
[0m22:43:56.757785 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.dim_listing_minimum
[0m22:43:56.758183 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.no_null_in_dimlisting
[0m22:43:56.758817 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.dim_listing_minimum, now test.dbtlearnnew.no_null_in_dimlisting)
[0m22:43:56.759188 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.no_null_in_dimlisting
[0m22:43:56.770306 [debug] [Thread-1 (]: Using snowflake connection "test.dbtlearnnew.no_null_in_dimlisting"
[0m22:43:56.770790 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "test.dbtlearnnew.no_null_in_dimlisting"} */
describe table AIRBNB.DEV.dim_listing
[0m22:43:56.771213 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m22:43:57.337123 [debug] [Thread-1 (]: SQL status: SUCCESS 8 in 1.0 seconds
[0m22:43:57.342607 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.no_null_in_dimlisting"
[0m22:43:57.347728 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (compile): 22:43:56.759383 => 22:43:57.346618
[0m22:43:57.349440 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.no_null_in_dimlisting
[0m22:43:57.350691 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.no_null_in_dimlisting (execute): 22:43:57.350179 => 22:43:57.350205
[0m22:43:57.351628 [debug] [Thread-1 (]: On test.dbtlearnnew.no_null_in_dimlisting: Close
[0m22:43:57.526286 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.no_null_in_dimlisting
[0m22:43:57.527704 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:43:57.529492 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.no_null_in_dimlisting, now test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc)
[0m22:43:57.530503 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:43:57.543011 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc"
[0m22:43:57.543967 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (compile): 22:43:57.531095 => 22:43:57.543671
[0m22:43:57.544346 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:43:57.544737 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc (execute): 22:43:57.544547 => 22:43:57.544559
[0m22:43:57.545473 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc
[0m22:43:57.545860 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:43:57.546428 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_host_id.1845a1bebc, now test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335)
[0m22:43:57.546765 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:43:57.550576 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335"
[0m22:43:57.552805 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (compile): 22:43:57.546952 => 22:43:57.552453
[0m22:43:57.553261 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:43:57.553689 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335 (execute): 22:43:57.553488 => 22:43:57.553503
[0m22:43:57.554457 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335
[0m22:43:57.554845 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:43:57.555452 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.not_null_dim_listing_listing_id.104f8b3335, now test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5)
[0m22:43:57.555790 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:43:57.559792 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5"
[0m22:43:57.560633 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (compile): 22:43:57.555981 => 22:43:57.560345
[0m22:43:57.561008 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:43:57.561446 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5 (execute): 22:43:57.561228 => 22:43:57.561240
[0m22:43:57.562207 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5
[0m22:43:57.562596 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:43:57.563176 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.positive_value_dim_listing_minimum_nights.3b29be56a5, now test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e)
[0m22:43:57.563515 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:43:57.571674 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e"
[0m22:43:57.572664 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (compile): 22:43:57.563711 => 22:43:57.572384
[0m22:43:57.573052 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:43:57.573449 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e (execute): 22:43:57.573267 => 22:43:57.573276
[0m22:43:57.574186 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e
[0m22:43:57.574562 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:43:57.575139 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.relationships_dim_listing_host_id__host_id__ref_dim_hosts_.152e98fe2e, now test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61)
[0m22:43:57.575464 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:43:57.580601 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61"
[0m22:43:57.584328 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (compile): 22:43:57.575654 => 22:43:57.583809
[0m22:43:57.584990 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:43:57.585523 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61 (execute): 22:43:57.585292 => 22:43:57.585307
[0m22:43:57.586346 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61
[0m22:43:57.586773 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m22:43:57.587546 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.unique_dim_listing_listing_id.5c6a1b4f61, now model.dbtlearnnew.mart_full_moon)
[0m22:43:57.588046 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m22:43:57.591069 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m22:43:57.591878 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 22:43:57.588299 => 22:43:57.591601
[0m22:43:57.592278 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m22:43:57.592686 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 22:43:57.592489 => 22:43:57.592502
[0m22:43:57.593472 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m22:43:57.593899 [debug] [Thread-1 (]: Began running node test.dbtlearnnew.consistent_created_at
[0m22:43:57.594580 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.mart_full_moon, now test.dbtlearnnew.consistent_created_at)
[0m22:43:57.594921 [debug] [Thread-1 (]: Began compiling node test.dbtlearnnew.consistent_created_at
[0m22:43:57.598597 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbtlearnnew.consistent_created_at"
[0m22:43:57.601422 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (compile): 22:43:57.595116 => 22:43:57.601073
[0m22:43:57.601863 [debug] [Thread-1 (]: Began executing node test.dbtlearnnew.consistent_created_at
[0m22:43:57.602286 [debug] [Thread-1 (]: Timing info for test.dbtlearnnew.consistent_created_at (execute): 22:43:57.602087 => 22:43:57.602100
[0m22:43:57.603057 [debug] [Thread-1 (]: Finished running node test.dbtlearnnew.consistent_created_at
[0m22:43:57.603450 [debug] [Thread-1 (]: Began running node analysis.dbtlearnnew.full_moon_no_sleep
[0m22:43:57.604042 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbtlearnnew.consistent_created_at, now analysis.dbtlearnnew.full_moon_no_sleep)
[0m22:43:57.604390 [debug] [Thread-1 (]: Began compiling node analysis.dbtlearnnew.full_moon_no_sleep
[0m22:43:57.607025 [debug] [Thread-1 (]: Writing injected SQL for node "analysis.dbtlearnnew.full_moon_no_sleep"
[0m22:43:57.607946 [debug] [Thread-1 (]: Timing info for analysis.dbtlearnnew.full_moon_no_sleep (compile): 22:43:57.604590 => 22:43:57.607600
[0m22:43:57.608928 [debug] [Thread-1 (]: Began executing node analysis.dbtlearnnew.full_moon_no_sleep
[0m22:43:57.609634 [debug] [Thread-1 (]: Timing info for analysis.dbtlearnnew.full_moon_no_sleep (execute): 22:43:57.609331 => 22:43:57.609347
[0m22:43:57.610571 [debug] [Thread-1 (]: Finished running node analysis.dbtlearnnew.full_moon_no_sleep
[0m22:43:57.611369 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:43:57.611688 [debug] [MainThread]: Connection 'analysis.dbtlearnnew.full_moon_no_sleep' was properly closed.
[0m22:43:57.613683 [debug] [MainThread]: Command end result
[0m22:43:57.630013 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 4.0429225, "process_user_time": 2.517129, "process_kernel_time": 0.170702, "process_mem_max_rss": "123076", "process_out_blocks": "3792", "process_in_blocks": "0"}
[0m22:43:57.630873 [debug] [MainThread]: Command `dbt compile` succeeded at 22:43:57.630715 after 4.04 seconds
[0m22:43:57.631264 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289dda7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289c23a5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x74289b1e8b20>]}
[0m22:43:57.631677 [debug] [MainThread]: Flushing usage events
[0m12:47:59.380149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708917f97820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089164ee5f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089164ee590>]}


============================== 12:47:59.382489 | 0d01339c-937f-41c5-a416-68407ffbf0c2 ==============================
[0m12:47:59.382489 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:47:59.383078 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:47:59.663067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891549a380>]}
[0m12:47:59.738122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891544bd30>]}
[0m12:47:59.738928 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m12:47:59.749126 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m12:47:59.834575 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m12:47:59.835018 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m12:47:59.839826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891511a5f0>]}
[0m12:47:59.851340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089150dd9c0>]}
[0m12:47:59.852114 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 analysis, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m12:47:59.852780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089150ddbd0>]}
[0m12:47:59.855084 [info ] [MainThread]: 
[0m12:47:59.856094 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m12:47:59.857596 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m12:47:59.870583 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m12:47:59.871082 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m12:47:59.871404 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m12:48:00.807219 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 1.0 seconds
[0m12:48:00.812769 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m12:48:00.994462 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_dev)
[0m12:48:01.008957 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m12:48:01.009586 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m12:48:01.009937 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:01.652949 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:48:01.658467 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m12:48:01.905119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now list_AIRBNB_DEV)
[0m12:48:01.914517 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m12:48:01.915290 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m12:48:01.915957 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m12:48:02.607066 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m12:48:02.611975 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m12:48:02.806551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708915449690>]}
[0m12:48:02.809266 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m12:48:02.810881 [info ] [MainThread]: 
[0m12:48:02.815383 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m12:48:02.816735 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now model.dbtlearnnew.scr_hosts)
[0m12:48:02.817412 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m12:48:02.826024 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m12:48:02.828404 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 12:48:02.817758 => 12:48:02.828104
[0m12:48:02.829274 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m12:48:02.829696 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m12:48:02.830296 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m12:48:02.830694 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m12:48:02.833119 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m12:48:02.835379 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 12:48:02.830893 => 12:48:02.835112
[0m12:48:02.836193 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m12:48:02.836704 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m12:48:02.837849 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m12:48:02.838351 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m12:48:02.842707 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m12:48:02.844039 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 12:48:02.838655 => 12:48:02.843640
[0m12:48:02.845184 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m12:48:02.845604 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m12:48:02.846104 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m12:48:02.846761 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m12:48:02.847135 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m12:48:02.850791 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m12:48:02.851553 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 12:48:02.847339 => 12:48:02.851310
[0m12:48:02.851898 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m12:48:02.876970 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m12:48:02.879826 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m12:48:02.880298 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
          AIRBNB.raw.raw_hosts
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m12:48:02.880640 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:05.525068 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:48:05.551990 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 12:48:02.852099 => 12:48:05.551790
[0m12:48:05.552472 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m12:48:05.738739 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891516f910>]}
[0m12:48:05.739430 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 2.89s]
[0m12:48:05.739983 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m12:48:05.740369 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m12:48:05.740930 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m12:48:05.741769 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m12:48:05.742249 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m12:48:05.748125 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m12:48:05.750828 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 12:48:05.742545 => 12:48:05.750464
[0m12:48:05.751420 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m12:48:05.754076 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m12:48:05.757018 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m12:48:05.757693 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m12:48:05.758265 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:08.572811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.0 seconds
[0m12:48:08.582260 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 12:48:05.751677 => 12:48:08.581321
[0m12:48:08.583821 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m12:48:10.688331 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891475eb60>]}
[0m12:48:10.689832 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 4.95s]
[0m12:48:10.691499 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m12:48:10.692696 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m12:48:10.693862 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m12:48:10.695038 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m12:48:10.695655 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m12:48:10.717504 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m12:48:10.720159 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 12:48:10.695998 => 12:48:10.719850
[0m12:48:10.720578 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m12:48:10.750197 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:10.750675 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id

from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m12:48:10.751038 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:11.582344 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:11.593454 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:11.594127 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:48:11.706794 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:48:11.716500 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:11.717759 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m12:48:11.828930 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:48:11.843535 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:11.844044 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:48:11.947283 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:48:11.956587 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:11.957507 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m12:48:12.090288 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m12:48:12.104925 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m12:48:12.116146 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m12:48:12.118932 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:12.119398 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m12:48:12.253225 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:48:12.255084 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:12.262739 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT", "REVIEW_ID")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT", "REVIEW_ID"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m12:48:13.971234 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m12:48:13.974713 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:13.977140 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m12:48:14.319376 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:48:14.337025 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m12:48:14.343520 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m12:48:14.344050 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m12:48:14.509353 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m12:48:14.515455 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 12:48:10.720793 => 12:48:14.514852
[0m12:48:14.516727 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m12:48:14.695216 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708914583e50>]}
[0m12:48:14.696653 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.00s]
[0m12:48:14.698112 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m12:48:14.699032 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m12:48:14.699929 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m12:48:14.701036 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m12:48:14.701620 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m12:48:14.705037 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m12:48:14.705907 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 12:48:14.701966 => 12:48:14.705633
[0m12:48:14.706299 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m12:48:14.709410 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m12:48:14.713179 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m12:48:14.713674 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m12:48:14.714030 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:15.931776 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m12:48:15.933773 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 12:48:14.706529 => 12:48:15.933581
[0m12:48:15.934174 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m12:48:17.073779 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708914733a90>]}
[0m12:48:17.076104 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 2.37s]
[0m12:48:17.078070 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m12:48:17.079537 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m12:48:17.081060 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_full_moon ................................ [RUN]
[0m12:48:17.082867 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now model.dbtlearnnew.mart_full_moon)
[0m12:48:17.083951 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m12:48:17.089697 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m12:48:17.091065 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 12:48:17.084588 => 12:48:17.090781
[0m12:48:17.091541 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m12:48:17.096035 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.mart_full_moon"
[0m12:48:17.098942 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.mart_full_moon"
[0m12:48:17.099388 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.mart_full_moon"} */
create or replace transient table AIRBNB.DEV.mart_full_moon
         as
        (
WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)
SELECT
    r.*,CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
r
LEFT JOIN full_moon_dates
fm
ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m12:48:17.099745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m12:48:20.949369 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m12:48:20.955365 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 12:48:17.091807 => 12:48:20.954763
[0m12:48:20.956692 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: Close
[0m12:48:23.832512 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0d01339c-937f-41c5-a416-68407ffbf0c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089145e1ab0>]}
[0m12:48:23.833388 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_full_moon ........................... [[32mSUCCESS 1[0m in 6.75s]
[0m12:48:23.835642 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m12:48:23.844396 [debug] [MainThread]: Connection 'master' was properly closed.
[0m12:48:23.845846 [debug] [MainThread]: Connection 'model.dbtlearnnew.mart_full_moon' was properly closed.
[0m12:48:23.846494 [info ] [MainThread]: 
[0m12:48:23.847234 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 23.99 seconds (23.99s).
[0m12:48:23.849587 [debug] [MainThread]: Command end result
[0m12:48:23.867698 [info ] [MainThread]: 
[0m12:48:23.868414 [info ] [MainThread]: [32mCompleted successfully[0m
[0m12:48:23.869479 [info ] [MainThread]: 
[0m12:48:23.870472 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m12:48:23.874550 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 24.532606, "process_user_time": 3.022831, "process_kernel_time": 0.14739, "process_mem_max_rss": "122072", "process_in_blocks": "4776", "process_out_blocks": "3440"}
[0m12:48:23.875790 [debug] [MainThread]: Command `dbt run` succeeded at 12:48:23.875472 after 24.53 seconds
[0m12:48:23.876427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x708917f97820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x70891464af50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7089147641f0>]}
[0m12:48:23.877035 [debug] [MainThread]: Flushing usage events
[0m11:22:55.705650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22e7a6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22c9f6620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22c9f65c0>]}


============================== 11:22:55.710682 | 7926e20e-011a-4395-9765-4b97206264e6 ==============================
[0m11:22:55.710682 [info ] [MainThread]: Running with dbt=1.7.10
[0m11:22:55.711189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/kishanmahajan/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/kishanmahajan/Desktop/course/dbtlearnnew/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m11:22:56.346990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22b9a6380>]}
[0m11:22:56.421806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22bbf4040>]}
[0m11:22:56.424646 [info ] [MainThread]: Registered adapter: snowflake=1.7.1
[0m11:22:56.438372 [debug] [MainThread]: checksum: b88efa780424265bbbd676e971356ada6a7ea9debd0a80a519a6d2707465340d, vars: {}, profile: , target: , version: 1.7.10
[0m11:22:57.189622 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m11:22:57.190068 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m11:22:57.195140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22b62e620>]}
[0m11:22:57.268712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22b5e99f0>]}
[0m11:22:57.269432 [info ] [MainThread]: Found 8 models, 1 snapshot, 9 tests, 1 seed, 1 analysis, 3 sources, 0 exposures, 0 metrics, 546 macros, 0 groups, 0 semantic models
[0m11:22:57.269908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22b5e9c00>]}
[0m11:22:57.272247 [info ] [MainThread]: 
[0m11:22:57.273198 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:22:57.274691 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_AIRBNB'
[0m11:22:57.292924 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB"
[0m11:22:57.293858 [debug] [ThreadPool]: On list_AIRBNB: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB"} */
show terse schemas in database AIRBNB
    limit 10000
[0m11:22:57.294346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:23:00.437706 [debug] [ThreadPool]: SQL status: SUCCESS 4 in 3.0 seconds
[0m11:23:00.441820 [debug] [ThreadPool]: On list_AIRBNB: Close
[0m11:23:00.691420 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB, now list_AIRBNB_DEV)
[0m11:23:00.709304 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_DEV"
[0m11:23:00.710116 [debug] [ThreadPool]: On list_AIRBNB_DEV: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_DEV"} */
show terse objects in AIRBNB.DEV limit 10000
[0m11:23:00.710521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:01.549440 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m11:23:01.553639 [debug] [ThreadPool]: On list_AIRBNB_DEV: Close
[0m11:23:01.750521 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_AIRBNB_DEV, now list_AIRBNB_dev)
[0m11:23:01.762968 [debug] [ThreadPool]: Using snowflake connection "list_AIRBNB_dev"
[0m11:23:01.763808 [debug] [ThreadPool]: On list_AIRBNB_dev: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "connection_name": "list_AIRBNB_dev"} */
show terse objects in AIRBNB.dev limit 10000
[0m11:23:01.764567 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m11:23:02.592231 [debug] [ThreadPool]: SQL status: SUCCESS 10 in 1.0 seconds
[0m11:23:02.597026 [debug] [ThreadPool]: On list_AIRBNB_dev: Close
[0m11:23:02.810770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22a9b0580>]}
[0m11:23:02.812767 [info ] [MainThread]: Concurrency: 1 threads (target='dev')
[0m11:23:02.813655 [info ] [MainThread]: 
[0m11:23:02.831336 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.scr_hosts
[0m11:23:02.833495 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_AIRBNB_dev, now model.dbtlearnnew.scr_hosts)
[0m11:23:02.834495 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.scr_hosts
[0m11:23:02.842602 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.scr_hosts"
[0m11:23:02.845223 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.scr_hosts (compile): 11:23:02.834926 => 11:23:02.844880
[0m11:23:02.846106 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.scr_hosts
[0m11:23:02.846544 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_listing
[0m11:23:02.847214 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.scr_hosts, now model.dbtlearnnew.src_listing)
[0m11:23:02.847734 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_listing
[0m11:23:02.851155 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_listing"
[0m11:23:02.853619 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_listing (compile): 11:23:02.848073 => 11:23:02.853282
[0m11:23:02.854503 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_listing
[0m11:23:02.854934 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.src_reviews
[0m11:23:02.855634 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_listing, now model.dbtlearnnew.src_reviews)
[0m11:23:02.855980 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.src_reviews
[0m11:23:02.858485 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.src_reviews"
[0m11:23:02.860651 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.src_reviews (compile): 11:23:02.856173 => 11:23:02.860335
[0m11:23:02.861618 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.src_reviews
[0m11:23:02.862056 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_hosts
[0m11:23:02.862610 [info ] [Thread-1 (]: 1 of 5 START sql table model DEV.dim_hosts ..................................... [RUN]
[0m11:23:02.863212 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.src_reviews, now model.dbtlearnnew.dim_hosts)
[0m11:23:02.863550 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_hosts
[0m11:23:02.868082 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_hosts"
[0m11:23:02.871282 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (compile): 11:23:02.863745 => 11:23:02.870773
[0m11:23:02.871750 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_hosts
[0m11:23:02.896463 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_hosts"
[0m11:23:02.899714 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_hosts"
[0m11:23:02.900758 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_hosts"} */
create or replace transient table AIRBNB.DEV.dim_hosts
         as
        (with  __dbt__cte__scr_hosts as (
WITH raw_hosts AS (
        SELECT
            *
        FROM
          AIRBNB.raw.raw_hosts
)
SELECT
id AS host_id,
NAME AS host_name,
is_superhost,
created_at,
updated_at
FROM
raw_hosts
), src_host as (

    select * from __dbt__cte__scr_hosts
)
select 
host_id,
nvl(host_name , 'Anonymous') as host_name,
is_superhost,
created_at,
updated_at
from src_host
        );
[0m11:23:02.901179 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:04.634590 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:23:04.663209 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_hosts (execute): 11:23:02.872007 => 11:23:04.663005
[0m11:23:04.663617 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_hosts: Close
[0m11:23:05.664719 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22aa3ece0>]}
[0m11:23:05.665876 [info ] [Thread-1 (]: 1 of 5 OK created sql table model DEV.dim_hosts ................................ [[32mSUCCESS 1[0m in 2.80s]
[0m11:23:05.666414 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_hosts
[0m11:23:05.666779 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listing
[0m11:23:05.667241 [info ] [Thread-1 (]: 2 of 5 START sql table model DEV.dim_listing ................................... [RUN]
[0m11:23:05.667804 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_hosts, now model.dbtlearnnew.dim_listing)
[0m11:23:05.668124 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listing
[0m11:23:05.672823 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listing"
[0m11:23:05.675240 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (compile): 11:23:05.668323 => 11:23:05.674931
[0m11:23:05.675651 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listing
[0m11:23:05.678058 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listing"
[0m11:23:05.681251 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listing"
[0m11:23:05.681933 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listing"} */
create or replace transient table AIRBNB.DEV.dim_listing
         as
        (with  __dbt__cte__src_listing as (
WITH raw_listings AS (
SELECT
*
FROM
AIRBNB.raw.raw_listings
)
SELECT
    id AS listing_id,
    name AS listing_name,
    listing_url,
    room_type,
    minimum_nights,
    host_id,
    price AS price_str,
    created_at,
    updated_at
FROM
    raw_listings
), src_listings as (

    select * from __dbt__cte__src_listing
)

SELECT
 listing_id,
 listing_name,
 room_type,
 CASE
    WHEN minimum_nights = 0 THEN 1
    ELSE minimum_nights
 END AS minimum_nights,
 host_id,
 REPLACE(price_str,'$') :: NUMBER(10,2) AS price,
 created_at,
 updated_at
FROM
 src_listings
        );
[0m11:23:05.682344 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:07.099266 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:23:07.102894 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listing (execute): 11:23:05.675873 => 11:23:07.102712
[0m11:23:07.103273 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listing: Close
[0m11:23:07.305745 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22b66a0e0>]}
[0m11:23:07.307491 [info ] [Thread-1 (]: 2 of 5 OK created sql table model DEV.dim_listing .............................. [[32mSUCCESS 1[0m in 1.64s]
[0m11:23:07.309336 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listing
[0m11:23:07.310577 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.fct_reviews
[0m11:23:07.312307 [info ] [Thread-1 (]: 3 of 5 START sql incremental model DEV.fct_reviews ............................. [RUN]
[0m11:23:07.314192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listing, now model.dbtlearnnew.fct_reviews)
[0m11:23:07.315319 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.fct_reviews
[0m11:23:07.340810 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.fct_reviews"
[0m11:23:07.343596 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (compile): 11:23:07.316108 => 11:23:07.343147
[0m11:23:07.344235 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.fct_reviews
[0m11:23:07.373021 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:07.373490 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
create or replace  temporary view AIRBNB.DEV.fct_reviews__dbt_tmp
  
   as (
    

with  __dbt__cte__src_reviews as (
WITH raw_reviews AS (
SELECT
*
FROM
AIRBNB.raw.raw_reviews
)
SELECT
listing_id,date AS review_date,
reviewer_name,
comments AS review_text,
sentiment AS review_sentiment
FROM
raw_reviews
), src_review as (

    select * from __dbt__cte__src_reviews
)

select * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id

from src_review where review_text is not null

  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)

  );
[0m11:23:07.373843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:08.220019 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:23:08.227518 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:08.228085 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m11:23:08.358045 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:23:08.367855 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:08.368780 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews
[0m11:23:08.502374 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:23:08.525523 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:08.525959 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table AIRBNB.DEV.fct_reviews__dbt_tmp
[0m11:23:08.648887 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:23:08.659900 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:08.661036 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
describe table "AIRBNB"."DEV"."FCT_REVIEWS"
[0m11:23:08.775188 [debug] [Thread-1 (]: SQL status: SUCCESS 6 in 0.0 seconds
[0m11:23:08.784345 [debug] [Thread-1 (]: 
    In "AIRBNB"."DEV"."FCT_REVIEWS":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m11:23:08.795206 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.fct_reviews"
[0m11:23:08.798240 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:08.798708 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
-- back compat for old kwarg name
  
  begin;
[0m11:23:08.937201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:23:08.938657 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:08.939888 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
insert into AIRBNB.DEV.fct_reviews ("LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT", "REVIEW_ID")
        (
            select "LISTING_ID", "REVIEW_DATE", "REVIEWER_NAME", "REVIEW_TEXT", "REVIEW_SENTIMENT", "REVIEW_ID"
            from AIRBNB.DEV.fct_reviews__dbt_tmp
        );
[0m11:23:09.754858 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.0 seconds
[0m11:23:09.756357 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:09.757494 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
COMMIT
[0m11:23:10.061531 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:23:10.079349 [debug] [Thread-1 (]: Applying DROP to: AIRBNB.DEV.fct_reviews__dbt_tmp
[0m11:23:10.084413 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.fct_reviews"
[0m11:23:10.084817 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.fct_reviews"} */
drop view if exists AIRBNB.DEV.fct_reviews__dbt_tmp cascade
[0m11:23:10.235435 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.0 seconds
[0m11:23:10.241736 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.fct_reviews (execute): 11:23:07.344554 => 11:23:10.241148
[0m11:23:10.242910 [debug] [Thread-1 (]: On model.dbtlearnnew.fct_reviews: Close
[0m11:23:11.606760 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22aa3f880>]}
[0m11:23:11.608590 [info ] [Thread-1 (]: 3 of 5 OK created sql incremental model DEV.fct_reviews ........................ [[32mSUCCESS 1[0m in 4.29s]
[0m11:23:11.610548 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.fct_reviews
[0m11:23:11.611868 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.dim_listings_w_hosts
[0m11:23:11.613140 [info ] [Thread-1 (]: 4 of 5 START sql table model DEV.dim_listings_w_hosts .......................... [RUN]
[0m11:23:11.615171 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.fct_reviews, now model.dbtlearnnew.dim_listings_w_hosts)
[0m11:23:11.616211 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.dim_listings_w_hosts
[0m11:23:11.622179 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m11:23:11.625047 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (compile): 11:23:11.616822 => 11:23:11.624728
[0m11:23:11.625591 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.dim_listings_w_hosts
[0m11:23:11.628369 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.dim_listings_w_hosts"
[0m11:23:11.630910 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.dim_listings_w_hosts"
[0m11:23:11.631420 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.dim_listings_w_hosts"} */
create or replace transient table AIRBNB.DEV.dim_listings_w_hosts
         as
        (WITH
l AS (
SELECT
*
FROM
AIRBNB.DEV.dim_listing
),
h AS (
SELECT *
FROM AIRBNB.DEV.dim_hosts
)
SELECT
    l.listing_id,
    l.listing_name,
    l.room_type,
    l.minimum_nights,
    l.price,
    l.host_id,
    h.host_name,
    h.is_superhost as host_is_superhost,
    l.created_at,
    GREATEST(l.updated_at, h.updated_at) as updated_at
FROM l
LEFT JOIN h ON (h.host_id = l.host_id)
        );
[0m11:23:11.631791 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:13.349937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.0 seconds
[0m11:23:13.355934 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.dim_listings_w_hosts (execute): 11:23:11.625915 => 11:23:13.355334
[0m11:23:13.357231 [debug] [Thread-1 (]: On model.dbtlearnnew.dim_listings_w_hosts: Close
[0m11:23:13.567570 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22aa3f7f0>]}
[0m11:23:13.569529 [info ] [Thread-1 (]: 4 of 5 OK created sql table model DEV.dim_listings_w_hosts ..................... [[32mSUCCESS 1[0m in 1.95s]
[0m11:23:13.571410 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.dim_listings_w_hosts
[0m11:23:13.572695 [debug] [Thread-1 (]: Began running node model.dbtlearnnew.mart_full_moon
[0m11:23:13.574102 [info ] [Thread-1 (]: 5 of 5 START sql table model DEV.mart_full_moon ................................ [RUN]
[0m11:23:13.576002 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbtlearnnew.dim_listings_w_hosts, now model.dbtlearnnew.mart_full_moon)
[0m11:23:13.577182 [debug] [Thread-1 (]: Began compiling node model.dbtlearnnew.mart_full_moon
[0m11:23:13.585173 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbtlearnnew.mart_full_moon"
[0m11:23:13.588049 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (compile): 11:23:13.577871 => 11:23:13.587681
[0m11:23:13.588503 [debug] [Thread-1 (]: Began executing node model.dbtlearnnew.mart_full_moon
[0m11:23:13.591222 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbtlearnnew.mart_full_moon"
[0m11:23:13.593676 [debug] [Thread-1 (]: Using snowflake connection "model.dbtlearnnew.mart_full_moon"
[0m11:23:13.594116 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: /* {"app": "dbt", "dbt_version": "1.7.10", "profile_name": "dbtlearnnew", "target_name": "dev", "node_id": "model.dbtlearnnew.mart_full_moon"} */
create or replace transient table AIRBNB.DEV.mart_full_moon
         as
        (
WITH fct_reviews AS (
    SELECT * FROM AIRBNB.DEV.fct_reviews
),
full_moon_dates AS (
    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates
)
SELECT
    r.*,CASE
        WHEN fm.full_moon_date IS NULL THEN 'not full moon'
        ELSE 'full moon'
    END AS is_full_moon
FROM
    fct_reviews
r
LEFT JOIN full_moon_dates
fm
ON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))
        );
[0m11:23:13.594461 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m11:23:17.639884 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 4.0 seconds
[0m11:23:17.645697 [debug] [Thread-1 (]: Timing info for model.dbtlearnnew.mart_full_moon (execute): 11:23:13.588756 => 11:23:17.645106
[0m11:23:17.646846 [debug] [Thread-1 (]: On model.dbtlearnnew.mart_full_moon: Close
[0m11:23:17.844573 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7926e20e-011a-4395-9765-4b97206264e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22aa4e080>]}
[0m11:23:17.846425 [info ] [Thread-1 (]: 5 of 5 OK created sql table model DEV.mart_full_moon ........................... [[32mSUCCESS 1[0m in 4.27s]
[0m11:23:17.848226 [debug] [Thread-1 (]: Finished running node model.dbtlearnnew.mart_full_moon
[0m11:23:17.852020 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:23:17.853085 [debug] [MainThread]: Connection 'model.dbtlearnnew.mart_full_moon' was properly closed.
[0m11:23:17.854193 [info ] [MainThread]: 
[0m11:23:17.855316 [info ] [MainThread]: Finished running 4 table models, 1 incremental model in 0 hours 0 minutes and 20.58 seconds (20.58s).
[0m11:23:17.856280 [debug] [MainThread]: Command end result
[0m11:23:17.867848 [info ] [MainThread]: 
[0m11:23:17.868301 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:23:17.868607 [info ] [MainThread]: 
[0m11:23:17.868904 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m11:23:17.874306 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 22.223671, "process_user_time": 3.152663, "process_kernel_time": 0.130511, "process_mem_max_rss": "124424", "process_in_blocks": "16", "process_out_blocks": "3496"}
[0m11:23:17.875169 [debug] [MainThread]: Command `dbt run` succeeded at 11:23:17.874912 after 22.22 seconds
[0m11:23:17.875877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22e7a6a10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22aa4e080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x75b22b677b20>]}
[0m11:23:17.876420 [debug] [MainThread]: Flushing usage events
