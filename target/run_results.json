{"metadata": {"dbt_schema_version": "https://schemas.getdbt.com/dbt/run-results/v5.json", "dbt_version": "1.7.10", "generated_at": "2024-04-05T05:53:17.855559Z", "invocation_id": "7926e20e-011a-4395-9765-4b97206264e6", "env": {}}, "results": [{"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-05T05:53:02.863745Z", "completed_at": "2024-04-05T05:53:02.870773Z"}, {"name": "execute", "started_at": "2024-04-05T05:53:02.872007Z", "completed_at": "2024-04-05T05:53:04.663005Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 2.8013572692871094, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b375a1-3201-0bdf-0008-40d200016272"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearnnew.dim_hosts", "compiled": true, "compiled_code": "with  __dbt__cte__scr_hosts as (\nWITH raw_hosts AS (\n        SELECT\n            *\n        FROM\n          AIRBNB.raw.raw_hosts\n)\nSELECT\nid AS host_id,\nNAME AS host_name,\nis_superhost,\ncreated_at,\nupdated_at\nFROM\nraw_hosts\n), src_host as (\n\n    select * from __dbt__cte__scr_hosts\n)\nselect \nhost_id,\nnvl(host_name , 'Anonymous') as host_name,\nis_superhost,\ncreated_at,\nupdated_at\nfrom src_host", "relation_name": "AIRBNB.DEV.dim_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-05T05:53:05.668323Z", "completed_at": "2024-04-05T05:53:05.674931Z"}, {"name": "execute", "started_at": "2024-04-05T05:53:05.675873Z", "completed_at": "2024-04-05T05:53:07.102712Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.637815237045288, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b375a1-3201-0bdf-0008-40d200016276"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearnnew.dim_listing", "compiled": true, "compiled_code": "with  __dbt__cte__src_listing as (\nWITH raw_listings AS (\nSELECT\n*\nFROM\nAIRBNB.raw.raw_listings\n)\nSELECT\n    id AS listing_id,\n    name AS listing_name,\n    listing_url,\n    room_type,\n    minimum_nights,\n    host_id,\n    price AS price_str,\n    created_at,\n    updated_at\nFROM\n    raw_listings\n), src_listings as (\n\n    select * from __dbt__cte__src_listing\n)\n\nSELECT\n listing_id,\n listing_name,\n room_type,\n CASE\n    WHEN minimum_nights = 0 THEN 1\n    ELSE minimum_nights\n END AS minimum_nights,\n host_id,\n REPLACE(price_str,'$') :: NUMBER(10,2) AS price,\n created_at,\n updated_at\nFROM\n src_listings", "relation_name": "AIRBNB.DEV.dim_listing"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-05T05:53:07.316108Z", "completed_at": "2024-04-05T05:53:07.343147Z"}, {"name": "execute", "started_at": "2024-04-05T05:53:07.344554Z", "completed_at": "2024-04-05T05:53:10.241148Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.293133020401001, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b375a1-3201-0bca-0008-40d20001539a"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearnnew.fct_reviews", "compiled": true, "compiled_code": "\n\nwith  __dbt__cte__src_reviews as (\nWITH raw_reviews AS (\nSELECT\n*\nFROM\nAIRBNB.raw.raw_reviews\n)\nSELECT\nlisting_id,date AS review_date,\nreviewer_name,\ncomments AS review_text,\nsentiment AS review_sentiment\nFROM\nraw_reviews\n), src_review as (\n\n    select * from __dbt__cte__src_reviews\n)\n\nselect * , md5(cast(coalesce(cast(listing_id as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_date as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(reviewer_name as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(review_text as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as review_id\n\nfrom src_review where review_text is not null\n\n  and review_date >= (select max(review_date) from AIRBNB.DEV.fct_reviews)\n", "relation_name": "AIRBNB.DEV.fct_reviews"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-05T05:53:11.616822Z", "completed_at": "2024-04-05T05:53:11.624728Z"}, {"name": "execute", "started_at": "2024-04-05T05:53:11.625915Z", "completed_at": "2024-04-05T05:53:13.355334Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 1.9528553485870361, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b375a1-3201-0bcb-0008-40d20001436e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearnnew.dim_listings_w_hosts", "compiled": true, "compiled_code": "WITH\nl AS (\nSELECT\n*\nFROM\nAIRBNB.DEV.dim_listing\n),\nh AS (\nSELECT *\nFROM AIRBNB.DEV.dim_hosts\n)\nSELECT\n    l.listing_id,\n    l.listing_name,\n    l.room_type,\n    l.minimum_nights,\n    l.price,\n    l.host_id,\n    h.host_name,\n    h.is_superhost as host_is_superhost,\n    l.created_at,\n    GREATEST(l.updated_at, h.updated_at) as updated_at\nFROM l\nLEFT JOIN h ON (h.host_id = l.host_id)", "relation_name": "AIRBNB.DEV.dim_listings_w_hosts"}, {"status": "success", "timing": [{"name": "compile", "started_at": "2024-04-05T05:53:13.577871Z", "completed_at": "2024-04-05T05:53:13.587681Z"}, {"name": "execute", "started_at": "2024-04-05T05:53:13.588756Z", "completed_at": "2024-04-05T05:53:17.645106Z"}], "thread_id": "Thread-1 (worker)", "execution_time": 4.269211292266846, "adapter_response": {"_message": "SUCCESS 1", "code": "SUCCESS", "rows_affected": 1, "query_id": "01b375a1-3201-0bca-0008-40d20001539e"}, "message": "SUCCESS 1", "failures": null, "unique_id": "model.dbtlearnnew.mart_full_moon", "compiled": true, "compiled_code": "\nWITH fct_reviews AS (\n    SELECT * FROM AIRBNB.DEV.fct_reviews\n),\nfull_moon_dates AS (\n    SELECT * FROM AIRBNB.DEV.seed_full_moon_dates\n)\nSELECT\n    r.*,CASE\n        WHEN fm.full_moon_date IS NULL THEN 'not full moon'\n        ELSE 'full moon'\n    END AS is_full_moon\nFROM\n    fct_reviews\nr\nLEFT JOIN full_moon_dates\nfm\nON (TO_DATE(r.review_date) = DATEADD(DAY, 1, fm.full_moon_date))", "relation_name": "AIRBNB.DEV.mart_full_moon"}], "elapsed_time": 20.581174612045288, "args": {"populate_cache": true, "printer_width": 80, "log_level": "info", "use_colors_file": true, "warn_error_options": {"include": [], "exclude": []}, "log_path": "/home/kishanmahajan/Desktop/course/dbtlearnnew/logs", "use_colors": true, "defer": false, "log_file_max_bytes": 10485760, "project_dir": "/home/kishanmahajan/Desktop/course/dbtlearnnew", "vars": {}, "strict_mode": false, "static_parser": true, "exclude": [], "log_level_file": "debug", "quiet": false, "log_format": "default", "show_resource_report": false, "partial_parse": true, "introspect": true, "version_check": true, "macro_debugging": false, "profiles_dir": "/home/kishanmahajan/.dbt", "select": [], "log_format_file": "debug", "indirect_selection": "eager", "cache_selected_only": false, "send_anonymous_usage_stats": true, "print": true, "partial_parse_file_diff": true, "which": "run", "enable_legacy_logger": false, "favor_state": false, "invocation_command": "dbt run", "write_json": true}}